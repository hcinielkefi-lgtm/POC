<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Apache Camel 4.15 ‚Äî Performance & Op√©rations | BNP Paribas</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Styles existants optimis√©s */
    :root {
      --bnp-dark: #1e3a28;
      --bnp-primary: #2e7d32;
      --bnp-secondary: #4caf50;
      --bnp-accent: #8bc34a;
      --bnp-light: #e8f5e8;
      --bnp-gold: #d4af37;
      --bnp-silver: #c0c0c0;
      
      --bg: var(--bnp-dark);
      --bg2: #2d4a38;
      --panel: #2a3e2f;
      --panel2: #223528;
      --ink: #e8f5e8;
      --muted: #a5d6a7;
      --accent: var(--bnp-secondary);
      --accent2: var(--bnp-primary);
      --good: #4caf50;
      --warn: #ff9800;
      --bad: #f44336;
      --shadow: 0 10px 30px rgba(30, 58, 40, 0.4);
      --code: #1a2a1f;
      --border: #3d5a42;
      --transition: all 0.3s ease;
    }
    
    .light-mode {
      --bg: var(--bnp-light);
      --bg2: #f1f8e9;
      --panel: #ffffff;
      --panel2: #f1f8e9;
      --ink: #1e3a28;
      --muted: #2e7d32;
      --accent: var(--bnp-primary);
      --accent2: #1b5e20;
      --good: #2e7d32;
      --warn: #ef6c00;
      --bad: #c62828;
      --shadow: 0 10px 30px rgba(46, 125, 50, 0.1);
      --code: #f1f8e9;
      --border: #c8e6c9;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      scroll-behavior: smooth;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--bg), var(--bg2));
      color: var(--ink);
      font-size: 16px;
      line-height: 1.7;
      transition: var(--transition);
      overflow-x: hidden;
    }
    
    /* Layout Principal */
    .layout {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 24px;
      max-width: 1600px;
      margin: 0 auto;
      padding: 24px;
      min-height: 100vh;
    }
    
    /* Header */
    header {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, var(--bnp-primary), var(--bnp-dark));
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 24px 32px;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: var(--transition);
      border-left: 6px solid var(--bnp-gold);
      margin-bottom: 20px;
    }
    
    .light-mode header {
      background: linear-gradient(135deg, var(--bnp-light), #e8f5e8);
    }
    
    header h1 {
      margin: 0;
      font-size: clamp(24px, 4vw, 36px);
      font-weight: 700;
      color: var(--ink);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .header-meta {
      display: flex;
      align-items: center;
      gap: 20px;
      font-size: 14px;
      color: var(--muted);
    }
    
    .bnp-logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      color: var(--bnp-gold);
      font-size: 15px;
    }
    
    .version-badge {
      background: var(--bnp-gold);
      color: var(--bnp-dark);
      padding: 6px 14px;
      border-radius: 15px;
      font-size: 13px;
      font-weight: 700;
      margin-left: 12px;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }
    
    /* Sidebar Navigation */
    .sidebar {
      position: sticky;
      top: 20px;
      align-self: start;
      border: 1px solid var(--border);
      border-radius: 20px;
      background: var(--panel2);
      padding: 20px;
      box-shadow: var(--shadow);
      transition: var(--transition);
      max-height: calc(100vh - 40px);
      overflow-y: auto;
    }
    
    .sidebar::-webkit-scrollbar {
      width: 8px;
    }
    
    .sidebar::-webkit-scrollbar-track {
      background: var(--panel);
      border-radius: 4px;
    }
    
    .sidebar::-webkit-scrollbar-thumb {
      background: var(--bnp-secondary);
      border-radius: 4px;
    }
    
    .sidebar h3 {
      margin: 0 0 20px 0;
      font-size: 15px;
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--border);
    }
    
    .sidebar nav {
      position: relative;
    }
    
    .nav-progress {
      position: absolute;
      left: 0;
      top: 0;
      width: 4px;
      background: linear-gradient(to bottom, var(--bnp-secondary), var(--bnp-accent));
      border-radius: 3px;
      transition: all 0.4s ease;
      z-index: 2;
    }
    
    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      color: var(--ink);
      text-decoration: none;
      border: 1px solid transparent;
      transition: var(--transition);
      margin-bottom: 6px;
      font-size: 15px;
      position: relative;
      z-index: 1;
    }
    
    .sidebar nav a:hover {
      background: var(--panel);
      border-color: var(--border);
      transform: translateX(6px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .sidebar nav a.active {
      background: var(--accent);
      color: white;
      font-weight: 600;
      border-color: var(--accent2);
      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
      transform: translateX(8px);
    }
    
    .sidebar nav a.active::before {
      content: "";
      position: absolute;
      left: -3px;
      top: 50%;
      transform: translateY(-50%);
      width: 5px;
      height: 80%;
      background: var(--bnp-gold);
      border-radius: 3px;
    }
    
    .section-indicator {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      background: var(--panel);
      border-radius: 50%;
      font-size: 11px;
      font-weight: 700;
      transition: var(--transition);
      flex-shrink: 0;
      border: 1px solid var(--border);
    }
    
    .sidebar nav a.active .section-indicator {
      background: white;
      color: var(--accent);
      transform: scale(1.1);
    }
    
    /* Search & Controls */
    .search-box {
      position: relative;
      margin-bottom: 20px;
    }
    
    .search-box input {
      width: 100%;
      padding: 14px 20px 14px 45px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--panel);
      color: var(--ink);
      font-size: 15px;
      transition: var(--transition);
    }
    
    .search-box input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.15);
    }
    
    .search-box i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
    }
    
    .nav-stats {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
      font-size: 13px;
      color: var(--muted);
    }
    
    .nav-progress-text {
      font-weight: 700;
      color: var(--accent);
      font-size: 14px;
    }
    
    /* Content Sections */
    .content section {
      margin: 24px 0;
      padding: 32px;
      border: 1px solid var(--border);
      border-radius: 20px;
      background: var(--panel2);
      box-shadow: var(--shadow);
      transition: var(--transition);
      scroll-margin-top: 20px;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 20px;
      border-bottom: 2px solid var(--border);
      padding-bottom: 20px;
    }
    
    .content h2 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      color: var(--ink);
      display: flex;
      align-items: center;
      gap: 12px;
      line-height: 1.3;
    }
    
    .section-tools {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
    }
    
    .section-badge {
      background: var(--bnp-gold);
      color: var(--bnp-dark);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }
    
    .quick-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    .quick-action-btn {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 18px;
      color: var(--ink);
      text-decoration: none;
      font-size: 14px;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    .quick-action-btn:hover {
      background: var(--accent);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
    }
    
    /* KPI Cards */
    .kpi {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 24px 0;
    }
    
    .kpi .card {
      background: linear-gradient(135deg, var(--panel), var(--panel2));
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 20px;
      transition: var(--transition);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .kpi .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--bnp-secondary), var(--bnp-accent));
    }
    
    .kpi .card:hover {
      transform: translateY(-4px);
      border-color: var(--bnp-secondary);
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    
    .kpi .label {
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 8px;
    }
    
    .kpi .val {
      font-size: 28px;
      font-weight: 800;
      color: var(--accent);
      margin-top: 4px;
    }
    
    .bad { color: var(--bad); }
    .warn { color: var(--warn); }
    .good { color: var(--good); }
    
    /* Feature Grid */
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 24px;
      margin: 28px 0;
    }
    
    .feature-card {
      background: linear-gradient(135deg, var(--panel), var(--panel2));
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 24px;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }
    
    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--bnp-secondary), var(--bnp-accent));
    }
    
    .feature-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow);
      border-color: var(--bnp-secondary);
    }
    
    .feature-icon {
      font-size: 32px;
      margin-bottom: 16px;
      color: var(--bnp-secondary);
    }
    
    .feature-card h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 12px;
      color: var(--ink);
    }
    
    .feature-card p {
      color: var(--muted);
      line-height: 1.6;
      margin-bottom: 16px;
    }
    
    /* Code Blocks */
    pre {
      background: var(--code);
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 20px;
      overflow: auto;
      position: relative;
      transition: var(--transition);
      margin: 16px 0;
    }
    
    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      color: var(--muted);
      font-size: 15px;
      font-weight: 600;
    }
    
    .copy-btn {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      font-size: 13px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }
    
    .copy-btn:hover {
      background: var(--accent2);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
    }
    
    code {
      font-family: 'Cascadia Code', 'Fira Code', 'Monaco', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
    }
    
    /* Tables */
    .strategy-table {
      width: 100%;
      border-collapse: collapse;
      margin: 24px 0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .strategy-table th {
      background: var(--panel);
      text-align: left;
      padding: 18px;
      border-bottom: 3px solid var(--border);
      font-weight: 700;
      color: var(--accent);
      font-size: 15px;
    }
    
    .strategy-table td {
      padding: 16px 18px;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }
    
    .strategy-table tr:hover {
      background: var(--panel);
    }
    
    /* Grid Layouts */
    .grid {
      display: grid;
      gap: 24px;
      margin: 24px 0;
    }
    
    .two { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
    .three { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
    
    /* Technical Details */
    .tech-detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin: 24px 0;
    }
    
    .tech-specs {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 24px;
    }
    
    .tech-specs h4 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--accent);
    }
    
    .spec-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .spec-list li {
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      transition: var(--transition);
    }
    
    .spec-list li:hover {
      background: rgba(139, 195, 74, 0.05);
      padding-left: 8px;
    }
    
    .spec-list li:last-child {
      border-bottom: none;
    }
    
    .spec-label {
      font-weight: 700;
      color: var(--accent);
      display: inline-block;
      width: 160px;
      flex-shrink: 0;
    }
    
    /* Progress & Controls */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--bnp-secondary), var(--bnp-accent));
      width: 0%;
      transition: width 0.3s ease;
      box-shadow: 0 2px 8px rgba(46, 125, 50, 0.3);
    }
    
    .controls {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    
    .theme-toggle {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 50%;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .theme-toggle:hover {
      background: var(--accent);
      color: white;
      transform: rotate(15deg) scale(1.1);
      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
    }
    
    /* Special Elements */
    .tip-box {
      background: linear-gradient(135deg, var(--panel), var(--bnp-dark));
      border-left: 6px solid var(--bnp-gold);
      padding: 24px;
      margin: 24px 0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .light-mode .tip-box {
      background: linear-gradient(135deg, var(--bnp-light), #e8f5e8);
    }
    
    .tip-box::before {
      content: 'üí°';
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 24px;
      opacity: 0.1;
    }
    
    .cos-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: 10px;
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 10px;
      font-weight: 700;
    }
    
    .cos-a { background: rgba(244, 67, 54, 0.15); color: var(--bad); border: 1px solid rgba(244, 67, 54, 0.3); }
    .cos-b { background: rgba(255, 152, 0, 0.15); color: var(--warn); border: 1px solid rgba(255, 152, 0, 0.3); }
    .cos-c { background: rgba(76, 175, 80, 0.15); color: var(--good); border: 1px solid rgba(76, 175, 80, 0.3); }
    
    /* Architecture Diagrams */
    .architecture-diagram {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 24px;
      margin: 24px 0;
      text-align: center;
    }
    
    .diagram-placeholder {
      background: var(--code);
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      color: var(--muted);
      font-style: italic;
      margin: 16px 0;
      border: 2px dashed var(--border);
    }
    
    /* Export Controls */
    .export-controls {
      display: flex;
      gap: 12px;
      margin: 24px 0;
      flex-wrap: wrap;
    }
    
    .export-btn {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 18px;
      color: var(--ink);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
    }
    
    .export-btn:hover {
      background: var(--accent);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
    }
    
    /* Footer */
    footer {
      grid-column: 1 / -1;
      color: var(--muted);
      font-size: 14px;
      margin-top: 40px;
      text-align: center;
      padding: 30px;
      border-top: 1px solid var(--border);
      background: var(--panel);
      border-radius: 15px;
    }
    
    /* Watermark */
    .bnp-watermark {
      position: fixed;
      bottom: 30px;
      right: 30px;
      opacity: 0.03;
      font-size: 180px;
      color: var(--bnp-gold);
      pointer-events: none;
      z-index: -1;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { 
        opacity: 0; 
        transform: translateY(30px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }
    
    @keyframes highlight-pulse {
      0% { background: transparent; box-shadow: none; }
      50% { background: rgba(139, 195, 74, 0.1); box-shadow: 0 0 0 4px rgba(139, 195, 74, 0.2); }
      100% { background: transparent; box-shadow: none; }
    }
    
    .content section {
      animation: fadeIn 0.8s ease-out;
    }
    
    .section-highlight {
      animation: highlight-pulse 2s ease-in-out;
    }
    
    /* Responsive Design */
    @media (max-width: 1200px) {
      .layout {
        grid-template-columns: 280px 1fr;
        gap: 20px;
        padding: 20px;
      }
      
      .tech-detail-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .layout {
        grid-template-columns: 1fr;
        padding: 16px;
        gap: 16px;
      }
      
      .sidebar {
        position: static;
        margin-bottom: 20px;
        max-height: none;
      }
      
      header {
        flex-direction: column;
        gap: 16px;
        text-align: center;
        padding: 20px;
      }
      
      .header-meta {
        flex-direction: column;
        gap: 10px;
      }
      
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
      }
      
      .feature-grid {
        grid-template-columns: 1fr;
      }
      
      .kpi {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .content section {
        padding: 24px;
      }
    }
    
    @media (max-width: 480px) {
      .kpi {
        grid-template-columns: 1fr;
      }
      
      .quick-actions {
        justify-content: center;
        width: 100%;
      }
      
      .quick-action-btn {
        flex: 1;
        justify-content: center;
        min-width: 120px;
      }
      
      .export-controls {
        justify-content: center;
      }
      
      .export-btn {
        flex: 1;
        justify-content: center;
        min-width: 140px;
      }
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  
  <div class="bnp-watermark">
    <i class="fas fa-university"></i>
  </div>
  
  <div class="layout">
    <header class="bnp-header">
      <div>
        <h1>
          <i class="fas fa-rocket"></i>
          Apache Camel 4.15 
          <span class="version-badge">BNP Production</span>
        </h1>
        <div class="header-meta">
          <div class="bnp-logo">
            <i class="fas fa-university"></i>
            BNP Paribas - Digital Factory
          </div>
          <div><i class="fas fa-calendar-alt"></i> Derni√®re mise √† jour : <span id="last-updated"></span></div>
          <div><i class="fas fa-shield-alt"></i> Document Confidentiel</div>
        </div>
      </div>
      <div class="controls">
        <div class="theme-toggle" id="themeToggle" title="Basculer le mode sombre/clair">
          <i class="fas fa-moon"></i>
        </div>
      </div>
    </header>

    <aside class="sidebar">
      <h3><i class="fas fa-list-alt"></i> Navigation du Document</h3>
      
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="navSearch" placeholder="Rechercher dans le document...">
      </div>
      
      <nav aria-label="Sommaire" id="sidebarNav">
        <div class="nav-progress" id="navProgress"></div>
        
        <a href="#intro">
          <span class="section-indicator">1</span>
          <i class="fas fa-bullseye"></i>Objectifs & Contexte
        </a>
        <a href="#new-features">
          <span class="section-indicator">2</span>
          <i class="fas fa-rocket"></i>Nouveaut√©s Camel 4.15
        </a>
        <a href="#technical-features">
          <span class="section-indicator">3</span>
          <i class="fas fa-microchip"></i>Fonctionnalit√©s Techniques
        </a>
        <a href="#cloud-native">
          <span class="section-indicator">4</span>
          <i class="fas fa-cloud"></i>Cloud Native BNP
        </a>
        <a href="#cos">
          <span class="section-indicator">5</span>
          <i class="fas fa-cogs"></i>Architecture & Classes de Service
        </a>
        <a href="#capacity">
          <span class="section-indicator">6</span>
          <i class="fas fa-cube"></i>Dimensionnement & Capacit√©s
        </a>
        <a href="#engine">
          <span class="section-indicator">7</span>
          <i class="fas fa-sync-alt"></i>Moteur d'ex√©cution & Async
        </a>
        <a href="#design">
          <span class="section-indicator">8</span>
          <i class="fas fa-project-diagram"></i>Design & Patterns
        </a>
        <a href="#retry-strategies">
          <span class="section-indicator">9</span>
          <i class="fas fa-redo-alt"></i>Strat√©gies Retry & Rejeux
        </a>
        <a href="#components">
          <span class="section-indicator">10</span>
          <i class="fas fa-plug"></i>Composants & Protocoles
        </a>
        <a href="#optimizations">
          <span class="section-indicator">11</span>
          <i class="fas fa-bolt"></i>Optimisations Avanc√©es
        </a>
        <a href="#performance-tuning">
          <span class="section-indicator">12</span>
          <i class="fas fa-tachometer-alt"></i>Performance Tuning
        </a>
        <a href="#resilience-patterns">
          <span class="section-indicator">13</span>
          <i class="fas fa-shield-alt"></i>R√©silience Avanc√©e
        </a>
        <a href="#observability">
          <span class="section-indicator">14</span>
          <i class="fas fa-chart-bar"></i>Observabilit√©
        </a>
        <a href="#security">
          <span class="section-indicator">15</span>
          <i class="fas fa-lock"></i>S√©curit√© BNP
        </a>
        <a href="#jvm">
          <span class="section-indicator">16</span>
          <i class="fas fa-microchip"></i>JVM & GC
        </a>
        <a href="#testing">
          <span class="section-indicator">17</span>
          <i class="fas fa-vial"></i>Tests & Validation
        </a>
        <a href="#checklist">
          <span class="section-indicator">18</span>
          <i class="fas fa-check-circle"></i>Checklist Production
        </a>
        <a href="#examples">
          <span class="section-indicator">19</span>
          <i class="fas fa-code"></i>Exemples BNP
        </a>
        <a href="#jdbc-performance">
          <span class="section-indicator">20</span>
          <i class="fas fa-database"></i>Performance JDBC
        </a>
        <a href="#jms-performance">
          <span class="section-indicator">21</span>
          <i class="fas fa-envelope"></i>Performance JMS
        </a>
        <a href="#caching-performance">
          <span class="section-indicator">22</span>
          <i class="fas fa-bolt"></i>Caching & Performance
        </a>
        <a href="#connection-pooling">
          <span class="section-indicator">23</span>
          <i class="fas fa-plug"></i>Connection Pooling
        </a>
        <a href="#advanced-monitoring">
          <span class="section-indicator">24</span>
          <i class="fas fa-chart-line"></i>Monitoring Avanc√©
        </a>
        <a href="#annex">
          <span class="section-indicator">A</span>
          <i class="fas fa-book"></i>Annex A (EN)
        </a>
      </nav>
      
      <div class="nav-stats">
        <span><i class="fas fa-tasks"></i> Progression:</span>
        <span class="nav-progress-text" id="navProgressText">0%</span>
      </div>
    </aside>

    <main class="content">
      <!-- Section 1: Introduction -->
      <section id="intro">
        <div class="section-header">
          <h2><i class="fas fa-bullseye"></i>1) üéØ Objectifs & Contexte BNP</h2>
          <div class="section-tools">
            <span class="section-badge">Critique</span>
            <div class="quick-actions">
              <a href="#new-features" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Section Suivante
              </a>
              <a href="#checklist" class="quick-action-btn">
                <i class="fas fa-list-check"></i> Checklist
              </a>
            </div>
          </div>
        </div>
        
        <p>R√©f√©rence de tuning pour <strong>Apache Camel 4.15</strong> en environnement <strong>critique BNP Paribas</strong> (‚â• 5 000 000 transactions/jour), mixant <strong>flux urgents</strong> (SWIFT, SEPA, MQ temps r√©el) et <strong>batch CFT</strong> volumineux (&gt; 1M lignes/fichier), sous <strong>Spring Boot 3.3</strong> et d√©ploiement cloud BNP.</p>
        
        <div class="kpi">
          <div class="card bnp-card">
            <div class="label">Latence p95 SWIFT</div>
            <div class="val">&lt; 15 ms</div>
          </div>
          <div class="card bnp-card">
            <div class="label">Capacit√© SEPA</div>
            <div class="val">‚â• 2 000 tx/s</div>
          </div>
          <div class="card bnp-card">
            <div class="label">Taux d'erreur</div>
            <div class="val">&lt; 0,01 %</div>
          </div>
          <div class="card bnp-card">
            <div class="label">Disponibilit√©</div>
            <div class="val">‚â• 99.99 %</div>
          </div>
        </div>
        
        <div class="tip-box">
          <strong>üè¶ Contexte BNP:</strong> Int√©gration avec les syst√®mes core banking, conformit√© r√©glementaire, et haute disponibilit√© requise (99.99%). Environnement de production multi-r√©gions avec reprise automatique.
        </div>

        <h3>Architecture de R√©f√©rence BNP</h3>
        <div class="grid two">
          <div>
            <h4>Composants Principaux</h4>
            <ul>
              <li><strong>Spring Boot 3.3</strong> avec support natif des virtual threads</li>
              <li><strong>Apache Camel 4.15</strong> avec optimisations BNP</li>
              <li><strong>Oracle Database 19c</strong> avec RAC</li>
              <li><strong>IBM MQ 9.3</strong> pour la messagerie critique</li>
              <li><strong>Redis Cluster</strong> pour le caching distribu√©</li>
            </ul>
          </div>
          <div>
            <h4>Int√©grations M√©tier</h4>
            <ul>
              <li><strong>SWIFTNet</strong> pour les messages financiers</li>
              <li><strong>SEPA Clearing</strong> pour les paiements europ√©ens</li>
              <li><strong>Core Banking System</strong> int√©gration temps r√©el</li>
              <li><strong>Compliance & AML</strong> v√©rifications r√©glementaires</li>
            </ul>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('intro')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
          <button class="export-btn" onclick="shareSection('intro')">
            <i class="fas fa-share"></i> Partager
          </button>
          <button class="export-btn" onclick="printSection('intro')">
            <i class="fas fa-print"></i> Imprimer
          </button>
        </div>
      </section>

      <!-- Section 2: Nouvelles fonctionnalit√©s -->
      <section id="new-features">
        <div class="section-header">
          <h2><i class="fas fa-rocket"></i>2) üöÄ Nouveaut√©s Camel 4.15 BNP</h2>
          <div class="section-tools">
            <span class="section-badge">Nouveau</span>
            <div class="quick-actions">
              <a href="#intro" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#technical-features" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>
        
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-brain"></i></div>
            <h3>AI-Powered Routing</h3>
            <p>Optimisations intelligentes pour le routing des transactions financi√®res avec pr√©diction des patterns de charge et adaptation automatique.</p>
            <div class="code-header">
              <span>Configuration IA BNP</span>
              <button class="copy-btn" data-clipboard-target="#config-ai"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="config-ai"><code class="language-properties"># AI Routing pour transactions financi√®res
camel.optimization.ai-routing-enabled=true
camel.optimization.predictive-load-balancing=true
camel.optimization.adaptive-threading=true
camel.optimization.auto-tune-interval=5m

# Machine Learning Models
camel.ai.model.swift-routing.path=/models/swift_v1.2
camel.ai.model.sepa-prediction.path=/models/sepa_v1.1

# Conformit√© BNP
camel.compliance.regulation=basel-iii
camel.compliance.audit-trail-enabled=true
camel.compliance.explainable-ai=true</code></pre>
          </div>

          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-bolt"></i></div>
            <h3>Virtual Threads Enhanced</h3>
            <p>Virtual threads optimis√©s pour la haute performance des transactions financi√®res avec r√©duction drastique de la consommation m√©moire.</p>
            <div class="code-header">
              <span>Spring Boot 3.3+ BNP</span>
              <button class="copy-btn" data-clipboard-target="#config-vthreads"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="config-vthreads"><code class="language-properties"># Virtual Threads Configuration
spring.threads.virtual.enabled=true
spring.threads.virtual.max-per-mount=10000
camel.threading.virtual-threads=true
camel.threading.virtual-thread-pool-size=5000
camel.threading.platform-threads=false

# Performance Monitoring
camel.threading.monitoring.enabled=true
camel.threading.metrics.virtual-threads=true

# BNP Optimizations
camel.threading.bnp.optimized-scheduler=true
camel.threading.bnp.memory-efficient=true</code></pre>
          </div>

          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
            <h3>S√©curit√© Renforc√©e</h3>
            <p>Int√©gration native avec les syst√®mes de s√©curit√© BNP et chiffrement avanc√© avec support HSM et conformit√© PSD2.</p>
            <div class="code-header">
              <span>Security BNP</span>
              <button class="copy-btn" data-clipboard-target="#config-security"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="config-security"><code class="language-properties"># Security Configuration BNP
camel.security.encryption.enabled=true
camel.security.encryption.algorithm=AES-256-GCM
camel.security.hsm.integration=true
camel.compliance.psd2-enabled=true

# Advanced Security Features
camel.security.quantum-resistant.enabled=true
camel.security.zero-trust.architecture=true
camel.security.mTLS.strict-mode=true

# BNP Security Standards
camel.security.bnp.certificate-rotation=auto
camel.security.bnp.audit-comprehensive=true</code></pre>
          </div>
        </div>

        <h3>Am√©liorations des Performances</h3>
        <div class="grid two">
          <div>
            <h4>Gains de Performance</h4>
            <ul>
              <li><strong>Virtual Threads</strong> : 3-5x am√©lioration du d√©bit</li>
              <li><strong>Zero-Copy Streaming</strong> : 60% r√©duction m√©moire</li>
              <li><strong>AI Routing</strong> : 40% r√©duction latence p95</li>
              <li><strong>Batch Processing</strong> : 2x acc√©l√©ration traitements</li>
            </ul>
          </div>
          <div>
            <h4>Nouvelles APIs</h4>
            <ul>
              <li><strong>Camel AI DSL</strong> : APIs pour l'intelligence artificielle</li>
              <li><strong>Virtual Threads DSL</strong> : Support natif des virtual threads</li>
              <li><strong>Cloud Native APIs</strong> : Int√©gration Kubernetes avanc√©e</li>
              <li><strong>Security DSL</strong> : APIs de s√©curit√© unifi√©es</li>
            </ul>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('new-features')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 3: Fonctionnalit√©s Techniques D√©taill√©es -->
      <section id="technical-features">
        <div class="section-header">
          <h2><i class="fas fa-microchip"></i>3) üîß Fonctionnalit√©s Techniques D√©taill√©es</h2>
          <div class="section-tools">
            <span class="section-badge">Technique</span>
            <div class="quick-actions">
              <a href="#new-features" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#cloud-native" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>üß† AI-Powered Routing Engine - D√©tails Techniques</h3>
        <div class="tech-detail-grid">
          <div class="tech-specs">
            <h4>Architecture Technique IA</h4>
            <ul class="spec-list">
              <li><span class="spec-label">Mod√®le:</span> LSTM avec attention mechanism</li>
              <li><span class="spec-label">Features:</span> 50+ features temps r√©el</li>
              <li><span class="spec-label">Pr√©cision:</span> > 92% sur donn√©es de production</li>
              <li><span class="spec-label">Latence inference:</span> < 1ms</li>
              <li><span class="spec-label">Training Data:</span> 10M+ √©chantillons</li>
              <li><span class="spec-label">Update Frequency:</span> Heurelle</li>
            </ul>
          </div>
          <div class="tech-specs">
            <h4>Performance Optimizations</h4>
            <ul class="spec-list">
              <li><span class="spec-label">Model Size:</span> 45MB compressed</li>
              <li><span class="spec-label">Hardware Accel:</span> GPU/TPU support</li>
              <li><span class="spec-label">Memory Usage:</span> < 256MB RAM</li>
              <li><span class="spec-label">Throughput:</span> 50K inferences/s</li>
              <li><span class="spec-label">Accuracy:</span> 92.3% validation</li>
              <li><span class="spec-label">Fallback:</span> Rule-based backup</li>
            </ul>
          </div>
        </div>

        <h3>‚ö° Virtual Threads Enhanced - Deep Dive</h3>
        <div class="tech-detail-grid">
          <div class="tech-specs">
            <h4>Architecture d'Ex√©cution</h4>
            <ul class="spec-list">
              <li><span class="spec-label">Scheduler:</span> Work-stealing ForkJoinPool</li>
              <li><span class="spec-label">Stack Size:</span> 1MB segments r√©utilisables</li>
              <li><span class="spec-label">Context Switch:</span> ~200ns</li>
              <li><span class="spec-label">Memory Footprint:</span> 2-4KB par thread</li>
              <li><span class="spec-label">Max Concurrent:</span> 1M+ threads</li>
              <li><span class="spec-label">GC Impact:</span> R√©duction 80%</li>
            </ul>
          </div>
          <div class="tech-specs">
            <h4>Performance Metrics</h4>
            <ul class="spec-list">
              <li><span class="spec-label">Throughput Gain:</span> 3-5x vs platform threads</li>
              <li><span class="spec-label">Memory Reduction:</span> 60-80%</li>
              <li><span class="spec-label">Latency Improvement:</span> 40-60%</li>
              <li><span class="spec-label">CPU Utilization:</span> 15-20% meilleure</li>
              <li><span class="spec-label">Response Time:</span> p99 < 10ms</li>
              <li><span class="spec-label">Error Rate:</span> < 0.001%</li>
            </ul>
          </div>
        </div>

        <h3>üîó Zero-Copy Streaming Avanc√©</h3>
        <div class="grid two">
          <div>
            <h4>Architecture M√©moire</h4>
            <ul>
              <li><strong>Direct Buffers</strong> : Allocation hors heap natif</li>
              <li><strong>Memory Mapping</strong> : MappedByteBuffer pour fichiers</li>
              <li><strong>Buffer Pool</strong> : Recyclage avec buddy allocation</li>
              <li><strong>Stream Splitting</strong> : R√©f√©rences partag√©es sans copie</li>
              <li><strong>Compression</strong> : LZ4 en temps r√©el</li>
              <li><strong>Encryption</strong> : Chiffrement transparent</li>
            </ul>
          </div>
          <div>
            <h4>Configuration M√©moire</h4>
            <div class="code-header">
              <span>JVM Options Zero-Copy</span>
              <button class="copy-btn" data-clipboard-target="#config-zero-copy"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="config-zero-copy"><code class="language-bash"># Optimisations Zero-Copy BNP
-XX:MaxDirectMemorySize=4g
-XX:+UseLargePages
-XX:+UseTransparentHugePages
-XX:LargePageSizeInBytes=2m
-XX:+UseCompressedOops
-XX:+UseCompressedClassPointers

# Configuration Camel Zero-Copy
-Dcamel.stream-caching.zero-copy.enabled=true
-Dcamel.stream-caching.buffer-size=131072
-Dcamel.stream-caching.pool-size=1000
-Dcamel.stream-caching.spool-threshold=1048576
-Dcamel.stream-caching.spool-directory=/tmp/camel-spool

# Monitoring Memory
-XX:NativeMemoryTracking=detail
-XX:+PrintNMTStatistics</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('technical-features')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

<!-- Section 4: Cloud Native BNP - Version Corrig√©e -->
<section id="cloud-native">
  <div class="section-header">
    <h2><i class="fas fa-cloud"></i>4) ‚òÅÔ∏è Cloud Native BNP</h2>
    <div class="section-tools">
      <span class="section-badge">Cloud</span>
      <div class="quick-actions">
        <a href="#technical-features" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#cos" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üèóÔ∏è Architecture Kubernetes BNP</h3>
  
  <!-- DIAGRAMME Architecture Kubernetes -->
  <div class="diagram-container">
    <div class="diagram-title" style="color: var(--accent2); font-weight: 700;">Architecture Cloud Native BNP Paribas - Multi-Region</div>
    <div class="diagram-content">
      <div style="width: 100%;">
        <!-- Niveau 1: Global Load Balancer -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #e3f2fd, #bbdefb);">
          <div class="node-title" style="color: #1565c0; font-weight: 700;">üåê Global Load Balancer</div>
          <div class="node-content" style="color: #0d47a1;">
            <div>Route le traffic vers les r√©gions les plus proches - Latence &lt; 20ms</div>
            <div style="margin-top: 10px; font-size: 14px;">
              <strong>Health Checks:</strong> TCP/HTTP - <strong>SSL Offloading:</strong> Enabled - <strong>WAF:</strong> BNP Rules
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 2: R√©gions -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <!-- Region Paris -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #e8f5e8, #c8e6c9);">
            <div class="node-title" style="color: #1b5e20; font-weight: 700;">üá´üá∑ Region EU-West (Paris)</div>
            <div class="node-content" style="color: #2e7d32;">
              <div><strong>Primary Production</strong></div>
              <div>‚Ä¢ 3 Availability Zones</div>
              <div>‚Ä¢ Kubernetes Cluster: 50 nodes</div>
              <div>‚Ä¢ Istio Service Mesh</div>
              <div>‚Ä¢ RTO: 15min - RPO: 0</div>
              <div>‚Ä¢ Capacity: 70% load</div>
            </div>
          </div>

          <!-- Region Frankfurt -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #fff3e0, #ffe0b2);">
            <div class="node-title" style="color: #e65100; font-weight: 700;">üá©üá™ Region EU-Central (Frankfurt)</div>
            <div class="node-content" style="color: #ef6c00;">
              <div><strong>Disaster Recovery</strong></div>
              <div>‚Ä¢ 3 Availability Zones</div>
              <div>‚Ä¢ Kubernetes Cluster: 30 nodes</div>
              <div>‚Ä¢ Warm Standby</div>
              <div>‚Ä¢ RTO: 2h - RPO: 15min</div>
              <div>‚Ä¢ Capacity: 30% load</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 3: Service Mesh -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #f3e5f5, #e1bee7);">
          <div class="node-title" style="color: #4a148c; font-weight: 700;">üõ°Ô∏è Service Mesh (Istio 1.20)</div>
          <div class="node-content" style="color: #7b1fa2;">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
              <div>
                <strong style="color: #4a148c;">Security</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ mTLS entre services</div>
                  <div>‚Ä¢ RBAC policies</div>
                  <div>‚Ä¢ JWT validation</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">Traffic Management</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Circuit Breaking</div>
                  <div>‚Ä¢ Retry Policies</div>
                  <div>‚Ä¢ Load Balancing</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">Observability</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Distributed Tracing</div>
                  <div>‚Ä¢ Metrics Collection</div>
                  <div>‚Ä¢ Access Logs</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 4: Camel Microservices -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <div class="architecture-node">
            <div class="node-title" style="color: #01579b; font-weight: 700;">üê´ Camel Microservices</div>
            <div class="node-content" style="color: #0277bd;">
              <div><strong>Payment Processing</strong></div>
              <div>‚Ä¢ SWIFT Processor (6 replicas)</div>
              <div>‚Ä¢ SEPA Processor (4 replicas)</div>
              <div>‚Ä¢ Core Banking (4 replicas)</div>
              <div>‚Ä¢ HPA auto-scaling: 3-20</div>
              <div>‚Ä¢ Resources: 4CPU/8GB</div>
            </div>
          </div>

          <div class="architecture-node">
            <div class="node-title" style="color: #880e4f; font-weight: 700;">‚ö° Auto-scaling</div>
            <div class="node-content" style="color: #ad1457;">
              <div><strong>Horizontal Pod Autoscaler</strong></div>
              <div>‚Ä¢ CPU: 70% threshold</div>
              <div>‚Ä¢ Memory: 80% threshold</div>
              <div>‚Ä¢ Custom metrics: queue_backlog</div>
              <div>‚Ä¢ Cooldown: 300s</div>
              <div>‚Ä¢ Max replicas: 20</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 5: Data Layer -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; background: linear-gradient(135deg, #fce4ec, #f8bbd9);">
          <div class="node-title" style="color: #880e4f; font-weight: 700;">üíæ Data Layer - Multi-Region</div>
          <div class="node-content" style="color: #ad1457;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <strong style="color: #880e4f;">Oracle RAC Cluster</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Active-Active setup</div>
                  <div>‚Ä¢ Data Guard replication</div>
                  <div>‚Ä¢ 4 Nodes per region</div>
                  <div>‚Ä¢ Connection Pool: 100</div>
                  <div>‚Ä¢ RTO: 15min</div>
                </div>
              </div>
              <div>
                <strong style="color: #880e4f;">Redis Cluster</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ 6 Nodes cluster</div>
                  <div>‚Ä¢ Cross-region replication</div>
                  <div>‚Ä¢ Cache distribu√©</div>
                  <div>‚Ä¢ 32GB memory</div>
                  <div>‚Ä¢ HA with sentinel</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Configuration K8s BNP</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Deployment BNP</span>
        <button class="copy-btn" data-clipboard-target="#config-k8s"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-k8s"><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: camel-bnp-swift
  namespace: bnp-production
  labels:
    app: swift-processor
    version: "4.15.0"
    bnp-division: global-markets
spec:
  replicas: 6
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 2
      maxUnavailable: 1
  selector:
    matchLabels:
      app: swift-processor
  template:
    metadata:
      labels:
        app: swift-processor
        version: "4.15.0"
      annotations:
        prometheus.io/scrape: "true"
        prometheus.io/port: "8080"
        prometheus.io/path: "/actuator/prometheus"
    spec:
      serviceAccountName: camel-service-account
      containers:
      - name: swift-processor
        image: bnp-registry.fr/camel-swift:4.15.0
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8080
          name: http
        - containerPort: 9779
          name: jmx
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
            ephemeral-storage: "1Gi"
          limits:
            memory: "4Gi"
            cpu: "2000m"
            ephemeral-storage: "2Gi"
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "cloud,production,bnp"
        - name: JAVA_OPTS
          value: "-XX:+UseZGC -Xmx3g -Xms3g -Dspring.profiles.active=cloud,production"
        - name: KUBERNETES_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 60
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        startupProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 5
          failureThreshold: 30
        securityContext:
          runAsNonRoot: true
          runAsUser: 1000
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
      imagePullSecrets:
      - name: bnp-registry-credentials
      restartPolicy: Always
      terminationGracePeriodSeconds: 60</code></pre>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Service Mesh Configuration</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Istio 1.20</strong> pour le service mesh avec mTLS obligatoire</li>
        <li><strong style="color: var(--accent);">Circuit Breaking</strong> configur√© pour 5% d'erreur</li>
        <li><strong style="color: var(--accent);">Retry Policies</strong> avec backoff exponentiel (max 3 retries)</li>
        <li><strong style="color: var(--accent);">mTLS</strong> entre tous les services avec rotation automatique</li>
        <li><strong style="color: var(--accent);">Distributed Tracing</strong> avec Jaeger et OpenTelemetry</li>
        <li><strong style="color: var(--accent);">Metrics Collection</strong> avec Prometheus et Grafana</li>
      </ul>

      <h4 style="color: var(--accent2);">Auto-scaling Configuration</h4>
      <div class="code-header">
        <span style="color: var(--muted);">HPA Configuration BNP</span>
        <button class="copy-btn" data-clipboard-target="#config-hpa"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-hpa"><code class="language-yaml">apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: camel-bnp-hpa
  namespace: bnp-production
  labels:
    app: swift-processor
    bnp-monitoring: "true"
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: camel-bnp-swift
  minReplicas: 3
  maxReplicas: 20
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
      - type: Percent
        value: 100
        periodSeconds: 30
      - type: Pods
        value: 4
        periodSeconds: 30
      selectPolicy: Max
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  - type: Pods
    pods:
      metric:
        name: camel_processing_queue_backlog
      target:
        type: AverageValue
        averageValue: "1000"
  - type: Object
    object:
      metric:
        name: requests_per_second
      describedObject:
        apiVersion: networking.istio.io/v1beta1
        kind: ServiceEntry
        name: swift-external-service
      target:
        type: Value
        value: "10000"</code></pre>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üîß Configuration Cloud Native Camel</h3>
  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Kubernetes Component</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Camel K8s Config</span>
        <button class="copy-btn" data-clipboard-target="#config-camel-k8s"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-camel-k8s"><code class="language-properties"># üîπ Kubernetes Configuration BNP
camel.cloud.kubernetes.service-discovery.enabled=true
camel.cloud.kubernetes.service-discovery.namespace=bnp-production
camel.cloud.kubernetes.service-discovery.port-name=http
camel.cloud.kubernetes.service-discovery.lookup=environment

# üîπ Service Registry
camel.cloud.kubernetes.service-registry.enabled=true
camel.cloud.kubernetes.service-registry.namespace=bnp-production

# üîπ Load Balancer
camel.cloud.kubernetes.load-balancer.enabled=true
camel.cloud.kubernetes.load-balancer.rule=round-robin

# üîπ Health Checks
camel.health.registry.enabled=true
camel.health.registry.bind-to-registry=true
camel.health.consumers.enabled=true
camel.health.routes.enabled=true
camel.health.config-check.enabled=true

# üîπ Kubernetes Client Configuration
camel.kubernetes-client.connection-timeout=10000
camel.kubernetes-client.request-timeout=15000
camel.kubernetes-client.trust-certs=true

# üîπ BNP Specific Configuration
camel.kubernetes.bnp.cluster-name=bnp-prod-eu-west
camel.kubernetes.bnp.monitoring-enabled=true
camel.kubernetes.bnp.auto-config=true</code></pre>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Cloud Native Features</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">ConfigMaps & Secrets</strong> pour la configuration externalis√©e</li>
        <li><strong style="color: var(--accent);">Liveness/Readiness</strong> probes avanc√©es avec d√©lais optimis√©s</li>
        <li><strong style="color: var(--accent);">Resource Limits</strong> optimis√©s pour JVM et charge pr√©vue</li>
        <li><strong style="color: var(--accent);">Node Affinity</strong> pour la localit√© des donn√©es critiques</li>
        <li><strong style="color: var(--accent);">Pod Disruption Budget</strong> pour haute disponibilit√© lors des mises √† jour</li>
        <li><strong style="color: var(--accent);">Network Policies</strong> pour la s√©curit√© inter-services</li>
      </ul>

      <h4 style="color: var(--accent2);">Monitoring & Observability</h4>
      <div class="kpi">
        <div class="card">
          <div class="label" style="color: var(--muted);">Pod Uptime</div>
          <div class="val" style="color: var(--good);">99.95%</div>
        </div>
        <div class="card">
          <div class="label" style="color: var(--muted);">Auto-scaling Events</div>
          <div class="val" style="color: var(--accent);">12/day</div>
        </div>
        <div class="card">
          <div class="label" style="color: var(--muted);">Resource Usage</div>
          <div class="val" style="color: var(--good);">65%</div>
        </div>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üöÄ D√©ploiement Continuous Delivery</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-ship"></i></div>
      <h3 style="color: var(--accent2);">GitOps avec ArgoCD</h3>
      <p style="color: var(--ink);">D√©ploiement automatique avec synchronisation continue et rollback automatique.</p>
      <div class="code-header">
        <span style="color: var(--muted);">ArgoCD Application</span>
        <button class="copy-btn" data-clipboard-target="#config-argocd"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-argocd"><code class="language-yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: camel-bnp-swift
  namespace: argocd
  finalizers:
  - resources-finalizer.argocd.argoproj.io
spec:
  project: bnp-production
  source:
    repoURL: 'https://git.bnpparibas.com/bnp/camel-deployments.git'
    path: manifests/swift-processor
    targetRevision: main
    helm:
      valueFiles:
      - values-production.yaml
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: bnp-production
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
      allowEmpty: false
    syncOptions:
    - CreateNamespace=true
    - ApplyOutOfSyncOnly=true
    retry:
      limit: 3
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-shield-alt"></i></div>
      <h3 style="color: var(--accent2);">Security Policies</h3>
      <p style="color: var(--ink);">Politiques de s√©curit√© renforc√©es pour les d√©ploiements cloud BNP.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Pod Security Standards</span>
        <button class="copy-btn" data-clipboard-target="#config-security-policies"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-security-policies"><code class="language-yaml">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: bnp-restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
  - ALL
  volumes:
  - 'configMap'
  - 'emptyDir'
  - 'projected'
  - 'secret'
  - 'downwardAPI'
  - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'MustRunAs'
    ranges:
    - min: 1000
      max: 65535
  readOnlyRootFilesystem: true</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('cloud-native')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
    <button class="export-btn" onclick="shareSection('cloud-native')">
      <i class="fas fa-share"></i> Partager
    </button>
  </div>
</section>

<!-- Section 5: Architecture & Classes de Service - Version Corrig√©e -->
<section id="cos">
  <div class="section-header">
    <h2><i class="fas fa-cogs"></i>5) ‚öôÔ∏è Architecture & Classes de Service</h2>
    <div class="section-tools">
      <span class="section-badge">Architecture</span>
      <div class="quick-actions">
        <a href="#cloud-native" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#capacity" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üèóÔ∏è Architecture des Classes de Service BNP</h3>
  
  <!-- DIAGRAMME Classes de Service -->
  <div class="diagram-container">
    <div class="diagram-title" style="color: var(--accent2); font-weight: 700;">Architecture des Classes de Service BNP Paribas</div>
    <div class="diagram-content">
      <div style="width: 100%;">
        <!-- Niveau 1: Load Balancer & Routing -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #e3f2fd, #bbdefb);">
          <div class="node-title" style="color: #1565c0; font-weight: 700;">üåê API Gateway & Load Balancer</div>
          <div class="node-content" style="color: #0d47a1;">
            <div>Routing intelligent bas√© sur les Classes de Service</div>
            <div style="margin-top: 10px; font-size: 14px;">
              <strong>Traffic Shaping:</strong> COS-Based ‚Ä¢ <strong>Priority Queuing:</strong> Enabled ‚Ä¢ <strong>Circuit Breaker:</strong> Per-COS
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 2: Classes de Service -->
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <!-- COS A -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #ffebee, #ffcdd2); border-left: 6px solid #f44336;">
            <div class="node-title" style="color: #c62828; font-weight: 700;">üö® COS A - Critique</div>
            <div class="node-content" style="color: #d32f2f;">
              <div style="color: #c62828; font-weight: 600;">SWIFT Messages & Paiements Temps R√©el</div>
              <div>‚Ä¢ Latence: &lt; 50ms</div>
              <div>‚Ä¢ Disponibilit√©: 99.99%</div>
              <div>‚Ä¢ RTO: 15 min</div>
              <div>‚Ä¢ RPO: 0</div>
              <div>‚Ä¢ Threads d√©di√©s</div>
              <div>‚Ä¢ Circuit Breaker strict</div>
              <div>‚Ä¢ Replicas: 6 minimum</div>
            </div>
          </div>

          <!-- COS B -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #fff3e0, #ffe0b2); border-left: 6px solid #ff9800;">
            <div class="node-title" style="color: #ef6c00; font-weight: 700;">‚ö†Ô∏è COS B - Important</div>
            <div class="node-content" style="color: #f57c00;">
              <div style="color: #ef6c00; font-weight: 600;">SEPA Payments & Virements Batch</div>
              <div>‚Ä¢ Latence: &lt; 500ms</div>
              <div>‚Ä¢ Disponibilit√©: 99.95%</div>
              <div>‚Ä¢ RTO: 2h</div>
              <div>‚Ä¢ RPO: 15 min</div>
              <div>‚Ä¢ Pool partag√©</div>
              <div>‚Ä¢ Retry limit√©</div>
              <div>‚Ä¢ Replicas: 4 minimum</div>
            </div>
          </div>

          <!-- COS C -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #e8f5e8, #c8e6c9); border-left: 6px solid #4caf50;">
            <div class="node-title" style="color: #2e7d32; font-weight: 700;">‚úÖ COS C - Standard</div>
            <div class="node-content" style="color: #388e3c;">
              <div style="color: #2e7d32; font-weight: 600;">Reporting & Analytics</div>
              <div>‚Ä¢ Latence: &lt; 2s</div>
              <div>‚Ä¢ Disponibilit√©: 99.9%</div>
              <div>‚Ä¢ RTO: 4h</div>
              <div>‚Ä¢ RPO: 1h</div>
              <div>‚Ä¢ Pool g√©n√©ral</div>
              <div>‚Ä¢ Best effort</div>
              <div>‚Ä¢ Replicas: 2 minimum</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 3: Resource Allocation -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #f3e5f5, #e1bee7);">
          <div class="node-title" style="color: #4a148c; font-weight: 700;">üìä Allocation des Ressources par COS</div>
          <div class="node-content" style="color: #7b1fa2;">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
              <div>
                <strong style="color: #4a148c;">CPU Allocation</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ <span style="color: #f44336;">COS A</span>: 60% (12 cores)</div>
                  <div>‚Ä¢ <span style="color: #ff9800;">COS B</span>: 30% (6 cores)</div>
                  <div>‚Ä¢ <span style="color: #4caf50;">COS C</span>: 10% (2 cores)</div>
                  <div>‚Ä¢ Total: 20 cores d√©di√©s</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">M√©moire</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ <span style="color: #f44336;">COS A</span>: 50% (16GB)</div>
                  <div>‚Ä¢ <span style="color: #ff9800;">COS B</span>: 35% (11GB)</div>
                  <div>‚Ä¢ <span style="color: #4caf50;">COS C</span>: 15% (5GB)</div>
                  <div>‚Ä¢ Total: 32GB allou√©s</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">Threads</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ <span style="color: #f44336;">COS A</span>: 70% (140 threads)</div>
                  <div>‚Ä¢ <span style="color: #ff9800;">COS B</span>: 20% (40 threads)</div>
                  <div>‚Ä¢ <span style="color: #4caf50;">COS C</span>: 10% (20 threads)</div>
                  <div>‚Ä¢ Total: 200 threads max</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 4: Data Layer -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div class="architecture-node">
            <div class="node-title" style="color: #01579b; font-weight: 700;">üíæ Data Layer</div>
            <div class="node-content" style="color: #0277bd;">
              <div><strong>Base de Donn√©es Oracle RAC</strong></div>
              <div>‚Ä¢ Connection Pool d√©di√© par COS</div>
              <div>‚Ä¢ QoS bas√© sur la priorit√©</div>
              <div>‚Ä¢ Backup strat√©gie diff√©renci√©e</div>
              <div>‚Ä¢ Performance tiers (Gold/Silver/Bronze)</div>
            </div>
          </div>

          <div class="architecture-node">
            <div class="node-title" style="color: #880e4f; font-weight: 700;">üõ°Ô∏è Monitoring & Alerting</div>
            <div class="node-content" style="color: #ad1457;">
              <div><strong>SLA Monitoring par COS</strong></div>
              <div>‚Ä¢ Alerting diff√©renci√©</div>
              <div>‚Ä¢ Escalation policies</div>
              <div>‚Ä¢ Dashboard d√©di√©s</div>
              <div>‚Ä¢ M√©triques business</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìã Tableau des Classes de Service</h3>
  <table class="strategy-table">
    <thead>
      <tr>
        <th style="color: var(--accent2);">Classe</th>
        <th style="color: var(--accent2);">Latence Max</th>
        <th style="color: var(--accent2);">Disponibilit√©</th>
        <th style="color: var(--accent2);">RTO</th>
        <th style="color: var(--accent2);">RPO</th>
        <th style="color: var(--accent2);">Exemples M√©tier</th>
        <th style="color: var(--accent2);">Priorit√©</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>COS A</strong> <span class="cos-indicator cos-a">Critique</span></td>
        <td style="color: var(--good);">&lt; 50ms</td>
        <td style="color: var(--good);">99.99%</td>
        <td>15 min</td>
        <td>0</td>
        <td style="color: var(--ink);">SWIFT, Paiements temps r√©el, Trading</td>
        <td style="color: #f44336; font-weight: 700;">HIGHEST</td>
      </tr>
      <tr>
        <td><strong>COS B</strong> <span class="cos-indicator cos-b">Important</span></td>
        <td style="color: var(--warn);">&lt; 500ms</td>
        <td style="color: var(--good);">99.95%</td>
        <td>2h</td>
        <td>15 min</td>
        <td style="color: var(--ink);">SEPA, Virements batch, Compliance</td>
        <td style="color: #ff9800; font-weight: 700;">HIGH</td>
      </tr>
      <tr>
        <td><strong>COS C</strong> <span class="cos-indicator cos-c">Standard</span></td>
        <td style="color: var(--muted);">&lt; 2s</td>
        <td style="color: var(--muted);">99.9%</td>
        <td>4h</td>
        <td>1h</td>
        <td style="color: var(--ink);">Reporting, Analytics, Archivage</td>
        <td style="color: #4caf50; font-weight: 700;">MEDIUM</td>
      </tr>
    </tbody>
  </table>

  <h3 style="color: var(--accent2);">üîß Configuration des Classes de Service</h3>
  <div class="code-header">
    <span style="color: var(--muted);">Configuration COS Camel BNP</span>
    <button class="copy-btn" data-clipboard-target="#config-cos"><i class="fas fa-copy"></i> Copier</button>
  </div>
  <pre id="config-cos"><code class="language-java">@Configuration
@EnableConfigurationProperties(BNPCOSProperties.class)
public class BNPClassOfServiceConfig {

    private final BNPCOSProperties cosProperties;

    public BNPClassOfServiceConfig(BNPCOSProperties cosProperties) {
        this.cosProperties = cosProperties;
    }

    // üîπ COS A - Thread Pool pour transactions critiques
    @Bean("cosAThreadPool")
    @Qualifier("highPriority")
    public ThreadPoolProfile cosAThreadPool() {
        ThreadPoolProfile profile = new ThreadPoolProfile();
        profile.setId("cosAThreadPool");
        profile.setPoolSize(cosProperties.getCosA().getPoolSize());
        profile.setMaxPoolSize(cosProperties.getCosA().getMaxPoolSize());
        profile.setMaxQueueSize(cosProperties.getCosA().getMaxQueueSize());
        profile.setRejectedPolicy(ThreadPoolRejectedPolicy.Abort);
        profile.setKeepAliveTime(60L);
        return profile;
    }

    // üîπ COS B - Thread Pool pour transactions importantes
    @Bean("cosBThreadPool")
    @Qualifier("mediumPriority")
    public ThreadPoolProfile cosBThreadPool() {
        ThreadPoolProfile profile = new ThreadPoolProfile();
        profile.setId("cosBThreadPool");
        profile.setPoolSize(cosProperties.getCosB().getPoolSize());
        profile.setMaxPoolSize(cosProperties.getCosB().getMaxPoolSize());
        profile.setMaxQueueSize(cosProperties.getCosB().getMaxQueueSize());
        profile.setRejectedPolicy(ThreadPoolRejectedPolicy.CallerRuns);
        profile.setKeepAliveTime(120L);
        return profile;
    }

    // üîπ COS C - Thread Pool pour transactions standard
    @Bean("cosCThreadPool")
    @Qualifier("lowPriority")
    public ThreadPoolProfile cosCThreadPool() {
        ThreadPoolProfile profile = new ThreadPoolProfile();
        profile.setId("cosCThreadPool");
        profile.setPoolSize(cosProperties.getCosC().getPoolSize());
        profile.setMaxPoolSize(cosProperties.getCosC().getMaxPoolSize());
        profile.setMaxQueueSize(cosProperties.getCosC().getMaxQueueSize());
        profile.setRejectedPolicy(ThreadPoolRejectedPolicy.CallerRuns);
        profile.setKeepAliveTime(300L);
        return profile;
    }

    // üîπ Configuration Properties pour COS
    @ConfigurationProperties(prefix = "bnp.cos")
    @Data
    public static class BNPCOSProperties {
        private COSConfig cosA = new COSConfig(50, 200, 1000);
        private COSConfig cosB = new COSConfig(20, 100, 5000);
        private COSConfig cosC = new COSConfig(10, 50, 10000);

        @Data
        @AllArgsConstructor
        public static class COSConfig {
            private int poolSize;
            private int maxPoolSize;
            private int maxQueueSize;
        }
    }

    // üîπ Route Builder avec gestion COS
    @Component
    public class BNPCOSRouteBuilder extends RouteBuilder {

        @Override
        public void configure() throws Exception {
            // üîπ COS A - Route SWIFT critique
            from("ibm-mq:queue:BNP.SWIFT.IN?concurrentConsumers=10")
                .routeId("swift-cos-a-processor")
                .threads()
                    .executorServiceRef("cosAThreadPool")
                .end()
                .process(new SwiftMessageProcessor())
                .to("direct:cosA-processing");

            // üîπ COS B - Route SEPA importante
            from("ibm-mq:queue:BNP.SEPA.IN?concurrentConsumers=5")
                .routeId("sepa-cos-b-processor")
                .threads()
                    .executorServiceRef("cosBThreadPool")
                .end()
                .process(new SEPAMessageProcessor())
                .to("direct:cosB-processing");

            // üîπ COS C - Route Reporting standard
            from("file:/inbound/reports?delay=5000")
                .routeId("reporting-cos-c-processor")
                .threads()
                    .executorServiceRef("cosCThreadPool")
                .end()
                .process(new ReportProcessor())
                .to("direct:cosC-processing");
        }
    }
}</code></pre>

  <h3 style="color: var(--accent2);">üèóÔ∏è Architecture de R√©f√©rence BNP</h3>
  <div class="architecture-diagram">
    <div class="diagram-placeholder">
      [Diagramme Architecture Camel BNP - Multi-r√©gions avec Load Balancer Global et Classes de Service]
    </div>
  </div>

  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Composants Architecturels</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">API Gateway</strong> : Kong avec plugins s√©curit√© BNP et routing COS</li>
        <li><strong style="color: var(--accent);">Service Mesh</strong> : Istio pour le traffic management par priorit√©</li>
        <li><strong style="color: var(--accent);">Message Broker</strong> : IBM MQ clusteris√© avec queues prioritaires</li>
        <li><strong style="color: var(--accent);">Database</strong> : Oracle RAC avec Data Guard et QoS</li>
        <li><strong style="color: var(--accent);">Cache</strong> : Redis Cluster avec r√©plication et priorit√©s</li>
        <li><strong style="color: var(--accent);">Monitoring</strong> : Prometheus + Grafana BNP avec dashboards COS</li>
      </ul>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Patterns d'Int√©gration par COS</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Circuit Breaker</strong> : Resilience4j avec config diff√©renci√©e par COS</li>
        <li><strong style="color: var(--accent);">Retry Pattern</strong> : Backoff exponentiel avec jitter adaptatif</li>
        <li><strong style="color: var(--accent);">Bulkhead</strong> : Isolation des composants critiques</li>
        <li><strong style="color: var(--accent);">SAGA Pattern</strong> : Pour transactions longues avec compensation</li>
        <li><strong style="color: var(--accent);">CQRS</strong> : S√©paration lecture/√©criture optimis√©e</li>
        <li><strong style="color: var(--accent);">Event Sourcing</strong> : Audit trail complet avec priorit√©s</li>
      </ul>
    </div>
  </div>

  <h3 style="color: var(--accent2);">‚ö° Performance Metrics par COS</h3>
  <div class="kpi">
    <div class="card">
      <div class="label" style="color: var(--muted);">COS A - Throughput</div>
      <div class="val" style="color: var(--good);">1,200 tx/s</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">COS A - Latence P95</div>
      <div class="val" style="color: var(--good);">42ms</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">COS B - Throughput</div>
      <div class="val" style="color: var(--accent);">800 tx/s</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">COS B - Latence P95</div>
      <div class="val" style="color: var(--warn);">380ms</div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üîí Gestion d'Erreurs par COS</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon" style="color: #f44336;"><i class="fas fa-exclamation-triangle"></i></div>
      <h3 style="color: var(--accent2);">COS A - Erreurs Critiques</h3>
      <p style="color: var(--ink);">Gestion d'erreurs imm√©diate avec escalation automatique pour les transactions critiques.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Error Handling COS A</span>
        <button class="copy-btn" data-clipboard-target="#error-cos-a"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="error-cos-a"><code class="language-java">// üîπ Gestion d'erreurs COS A - Critique
from("direct:cosA-processing")
  .onException(Exception.class)
    .maximumRedeliveries(2)
    .redeliveryDelay(1000)
    .useExponentialBackOff()
    .retryAttemptedLogLevel(LoggingLevel.ERROR)
    .handled(true)
    .process(new COSAAlerter()) // Alerting imm√©diat
    .to("activemq:queue:BNP.COSA.DLQ")
    .log(LoggingLevel.ERROR, "COS A Error: ${exception.message}")
  .end()
  .process(new CriticalBusinessProcessor());</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon" style="color: #ff9800;"><i class="fas fa-clock"></i></div>
      <h3 style="color: var(--accent2);">COS B - Erreurs Importantes</h3>
      <p style="color: var(--ink);">Retry strat√©gique avec backoff pour les transactions importantes mais non critiques.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Error Handling COS B</span>
        <button class="copy-btn" data-clipboard-target="#error-cos-b"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="error-cos-b"><code class="language-java">// üîπ Gestion d'erreurs COS B - Important
from("direct:cosB-processing")
  .onException(Exception.class)
    .maximumRedeliveries(5)
    .redeliveryDelay(5000)
    .backOffMultiplier(2)
    .useExponentialBackOff()
    .maximumRedeliveryDelay(60000)
    .retryAttemptedLogLevel(LoggingLevel.WARN)
    .handled(true)
    .to("activemq:queue:BNP.COSB.DLQ")
    .log(LoggingLevel.WARN, "COS B Error: ${exception.message}")
  .end()
  .process(new ImportantBusinessProcessor());</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('cos')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
    <button class="export-btn" onclick="shareSection('cos')">
      <i class="fas fa-share"></i> Partager
    </button>
  </div>
</section>

<!-- Section 6: Dimensionnement & Capacit√©s -->
<section id="capacity">
  <div class="section-header">
    <h2><i class="fas fa-cube"></i>6) üìä Dimensionnement & Capacit√©s</h2>
    <div class="section-tools">
      <span class="section-badge">Capacity</span>
      <div class="quick-actions">
        <a href="#cos" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#engine" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3>Capacity Planning BNP</h3>
  <div class="kpi">
    <div class="card bnp-card">
      <div class="label">Transactions Max/Jour</div>
      <div class="val">5M</div>
    </div>
    <div class="card bnp-card">
      <div class="label">D√©bit Cr√™te</div>
      <div class="val">2,000 tx/s</div>
    </div>
    <div class="card bnp-card">
      <div class="label">Stockage Messages</div>
      <div class="val">2 TB</div>
    </div>
    <div class="card bnp-card">
      <div class="label">M√©moire Totale</div>
      <div class="val">48 GB</div>
    </div>
  </div>

  <h3>Dimensionnement par Composant</h3>
  <table class="strategy-table">
    <thead>
      <tr>
        <th>Composant</th>
        <th>CPU (cores)</th>
        <th>M√©moire (GB)</th>
        <th>Stockage (GB)</th>
        <th>R√©plicas</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Camel SWIFT</strong></td>
        <td>4</td>
        <td>8</td>
        <td>100</td>
        <td>3</td>
        <td>Haute disponibilit√© requise</td>
      </tr>
      <tr>
        <td><strong>Camel SEPA</strong></td>
        <td>4</td>
        <td>8</td>
        <td>200</td>
        <td>2</td>
        <td>Batch processing lourd</td>
      </tr>
      <tr>
        <td><strong>Camel Core Banking</strong></td>
        <td>8</td>
        <td>16</td>
        <td>500</td>
        <td>2</td>
        <td>Int√©gration syst√®mes legacy</td>
      </tr>
      <tr>
        <td><strong>Redis Cache</strong></td>
        <td>4</td>
        <td>16</td>
        <td>100</td>
        <td>3</td>
        <td>Cluster avec r√©plication</td>
      </tr>
      <tr>
        <td><strong>Oracle Database</strong></td>
        <td>16</td>
        <td>64</td>
        <td>2000</td>
        <td>2</td>
        <td>RAC avec Data Guard</td>
      </tr>
    </tbody>
  </table>

  <h3>Calcul de Capacit√©</h3>
  <div class="grid two">
    <div>
      <h4>Formules de Dimensionnement</h4>
      <div class="code-header">
        <span>Capacity Calculator</span>
        <button class="copy-btn" data-clipboard-target="#config-capacity"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-capacity"><code class="language-java">public class BNPCapacityCalculator {
    
    // üîπ Calcul m√©moire n√©cessaire
    public static long calculateMemoryRequirements(
        long expectedTps, 
        long avgMsgSize, 
        int concurrentRoutes) {
        
        long baseMemory = 2 * 1024 * 1024 * 1024L; // 2GB base
        long messageMemory = expectedTps * avgMsgSize * 60; // 60s buffer
        long routeMemory = concurrentRoutes * 50 * 1024 * 1024L; // 50MB per route
        
        return baseMemory + messageMemory + routeMemory;
    }
    
    // üîπ Calcul CPU n√©cessaire
    public static int calculateCPURequirements(
        long expectedTps, 
        double processingTimeMs) {
        
        double cpuCores = (expectedTps * processingTimeMs) / 1000.0;
        return (int) Math.ceil(cpuCores * 1.5); // 50% buffer
    }
    
    // üîπ Calcul stockage n√©cessaire
    public static long calculateStorageRequirements(
        long dailyMessages, 
        long avgMsgSize, 
        int retentionDays) {
        
        return dailyMessages * avgMsgSize * retentionDays * 2; // 100% buffer
    }
}</code></pre>
    </div>
    <div>
      <h4>Exemple de Calcul</h4>
      <ul>
        <li><strong>Transactions/jour</strong>: 5,000,000</li>
        <li><strong>Taille moyenne message</strong>: 10KB</li>
        <li><strong>Temps traitement</strong>: 5ms</li>
        <li><strong>R√©tention</strong>: 90 jours</li>
      </ul>
      
      <div class="tip-box">
        <strong>R√©sultats du calcul:</strong><br>
        ‚Ä¢ M√©moire: 12 GB<br>
        ‚Ä¢ CPU: 8 cores<br>
        ‚Ä¢ Stockage: 9 TB<br>
        ‚Ä¢ R√©plicas: 3 minimum
      </div>
    </div>
  </div>

  <h3>Scaling Strategy BNP</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-arrows-alt-h"></i></div>
      <h3>Horizontal Scaling</h3>
      <p>Augmentation du nombre de pods bas√©e sur la charge CPU, m√©moire et backlog des queues.</p>
      <pre><code># HPA Configuration
minReplicas: 3
maxReplicas: 20
targetCPU: 70%
targetMemory: 80%
queueBacklog: 1000</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-arrows-alt-v"></i></div>
      <h3>Vertical Scaling</h3>
      <p>Augmentation des ressources par pod lors de pics de charge pr√©visibles.</p>
      <pre><code># VPA Configuration
maxAllowed:
  cpu: 8
  memory: 16Gi
minAllowed:
  cpu: 2
  memory: 4Gi</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
      <h3>Predictive Scaling</h3>
      <p>Utilisation de ML pour anticiper les pics de charge bas√©s sur l'historique.</p>
      <pre><code># Predictive Scaling
patterns:
  - time: "09:00-11:00"
    factor: 2.5
  - day: "MONDAY"
    factor: 1.8
  - event: "MONTH_END"
    factor: 3.0</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('capacity')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
  </div>
</section>

<!-- Section 7: Moteur d'ex√©cution & Async -->
<section id="engine">
  <div class="section-header">
    <h2><i class="fas fa-sync-alt"></i>7) üîÑ Moteur d'ex√©cution & Async</h2>
    <div class="section-tools">
      <span class="section-badge">Core</span>
      <div class="quick-actions">
        <a href="#capacity" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#design" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3>Architecture du Route Engine</h3>
  
  <!-- DIAGRAMME Architecture Camel Engine -->
  <div class="diagram-container">
    <div class="diagram-title">Architecture du Moteur d'Ex√©cution Camel BNP</div>
    <div class="diagram-content">
      <div style="width: 100%;">
        <!-- Niveau 1: Input -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px;">
          <div class="node-title">üì• Input Adapters</div>
          <div class="node-content">
            <div class="component-diagram">
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-envelope"></i></div>
                <div class="component-title">IBM MQ</div>
                <div>Concurrent Consumers: 20</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-file"></i></div>
                <div class="component-title">File Endpoint</div>
                <div>Batch Size: 1000</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-globe"></i></div>
                <div class="component-title">REST API</div>
                <div>Max Threads: 50</div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <!-- Niveau 2: Route Engine -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px;">
          <div class="node-title">‚öôÔ∏è Camel Route Engine</div>
          <div class="node-content">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <strong>Thread Pools</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ <span style="color: #f44336;">COS A</span>: 200 threads</div>
                  <div>‚Ä¢ <span style="color: #ff9800;">COS B</span>: 100 threads</div>
                  <div>‚Ä¢ <span style="color: #4caf50;">COS C</span>: 50 threads</div>
                  <div>‚Ä¢ Virtual Threads: 5000 max</div>
                </div>
              </div>
              <div>
                <strong>Processing</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Stream Caching: 1GB</div>
                  <div>‚Ä¢ Error Handlers: 3 retries</div>
                  <div>‚Ä¢ Circuit Breakers: 5 routes</div>
                  <div>‚Ä¢ Parallel Processing: Enabled</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <!-- Niveau 3: Processors -->
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <div class="architecture-node">
            <div class="node-title">üîß Processors</div>
            <div class="node-content">
              <div>‚Ä¢ Transformation</div>
              <div>‚Ä¢ Validation</div>
              <div>‚Ä¢ Enrichment</div>
              <div>‚Ä¢ Routing</div>
            </div>
          </div>
          <div class="architecture-node">
            <div class="node-title">üõ°Ô∏è Resilience</div>
            <div class="node-content">
              <div>‚Ä¢ Circuit Breaker</div>
              <div>‚Ä¢ Retry Policies</div>
              <div>‚Ä¢ Bulkhead</div>
              <div>‚Ä¢ Timeout</div>
            </div>
          </div>
          <div class="architecture-node">
            <div class="node-title">üìä Monitoring</div>
            <div class="node-content">
              <div>‚Ä¢ Metrics Collection</div>
              <div>‚Ä¢ Distributed Tracing</div>
              <div>‚Ä¢ Performance Logging</div>
              <div>‚Ä¢ Health Checks</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <!-- Niveau 4: Output -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center;">
          <div class="node-title">üì§ Output Adapters</div>
          <div class="node-content">
            <div class="component-diagram">
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-database"></i></div>
                <div class="component-title">Oracle DB</div>
                <div>Connection Pool: 20</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-exchange-alt"></i></div>
                <div class="component-title">Core Banking</div>
                <div>mTLS Secured</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-chart-bar"></i></div>
                <div class="component-title">Analytics</div>
                <div>Async Processing</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="grid two">
    <div>
      <h4>Configuration Producer/Consumer</h4>
      <div class="code-header">
        <span>Async Configuration BNP</span>
        <button class="copy-btn" data-clipboard-target="#config-async"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-async"><code class="language-properties"># Async Configuration BNP
camel.threads.pool.size=200
camel.threads.pool.max-size=1000
camel.threads.pool.keep-alive=60s
camel.threads.pool.queue-size=10000

# SEDA for internal routing
camel.seda.queue-size=50000
camel.seda.concurrent-consumers=50
camel.seda.default-block-when-full=true
camel.seda.default-discard-when-full=false

# Virtual Threads Optimization
camel.threading.virtual.enabled=true
camel.threading.virtual.max-pool-size=10000
camel.threading.virtual.keep-alive=300s

# BNP Specific Tuning
camel.threads.bnp.optimized-scheduler=true
camel.threads.bnp.monitoring-enabled=true
camel.threads.bnp.metrics-collection=true</code></pre>
    </div>
    <div>
      <h4>Performance Metrics</h4>
      <ul>
        <li><strong>Throughput max</strong>: 50,000 msg/s</li>
        <li><strong>Memory per route</strong>: ~5MB</li>
        <li><strong>Startup time</strong>: &lt; 30s</li>
        <li><strong>Graceful shutdown</strong>: 60s timeout</li>
        <li><strong>Context switching</strong>: &lt; 1% overhead</li>
        <li><strong>Error recovery</strong>: &lt; 100ms</li>
      </ul>

      <h4>Thread Pool Strategy</h4>
      <ul>
        <li><strong>Dedicated Pools</strong> par classe de service</li>
        <li><strong>Work Stealing</strong> pour l'√©quilibrage de charge</li>
        <li><strong>Bounded Queues</strong> pour √©viter l'out-of-memory</li>
        <li><strong>Monitoring</strong> en temps r√©el des pools</li>
      </ul>
    </div>
  </div>

  <h3>Configuration Avanc√©e des Thread Pools</h3>
  <div class="code-header">
    <span>Thread Pool Configuration Java</span>
    <button class="copy-btn" data-clipboard-target="#config-thread-pools"><i class="fas fa-copy"></i> Copier</button>
  </div>
  <pre id="config-thread-pools"><code class="language-java">@Configuration
public class BNPThreadPoolConfig {

    // üîπ Pool pour transactions critiques (COS A)
    @Bean("criticalTransactionPool")
    public ThreadPoolExecutor criticalTransactionPool() {
        return new ThreadPoolExecutor(
            50,     // core pool size
            200,    // maximum pool size  
            60L,    // keep alive time
            TimeUnit.SECONDS,
            new LinkedBlockingQueue<>(1000), // bounded queue
            new BNPThreadFactory("cos-a-critical"),
            new BNPRejectedExecutionHandler()
        );
    }

    // üîπ Pool pour batch processing (COS B)
    @Bean("batchProcessingPool")
    public ThreadPoolExecutor batchProcessingPool() {
        return new ThreadPoolExecutor(
            20,     // core pool size
            100,    // maximum pool size
            300L,   // keep alive time
            TimeUnit.SECONDS,
            new LinkedBlockingQueue<>(5000), // larger queue for batch
            new BNPThreadFactory("cos-b-batch"),
            new BNPRejectedExecutionHandler()
        );
    }

    // üîπ Custom Thread Factory BNP
    static class BNPThreadFactory implements ThreadFactory {
        private final String namePrefix;
        private final AtomicInteger threadNumber = new AtomicInteger(1);

        BNPThreadFactory(String poolName) {
            this.namePrefix = "bnp-camel-" + poolName + "-";
        }

        public Thread newThread(Runnable r) {
            Thread t = new Thread(r, namePrefix + threadNumber.getAndIncrement());
            t.setPriority(Thread.NORM_PRIORITY);
            t.setDaemon(false);
            return t;
        }
    }
}</code></pre>

  <h3>Patterns d'Ex√©cution Asynchrone</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-bolt"></i></div>
      <h3>Async Processor</h3>
      <p>Ex√©cution non-bloquante des processeurs avec completion callbacks.</p>
      <pre><code>from("direct:async")
  .threads(10)
  .process(new AsyncProcessor())
  .to("mock:result");</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-exchange-alt"></i></div>
      <h3>Parallel Processing</h3>
      <p>Traitement parall√®le avec aggregation des r√©sultats.</p>
      <pre><code>from("direct:parallel")
  .multicast()
  .parallelProcessing()
  .to("direct:a", "direct:b")
  .end();</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-stream"></i></div>
      <h3>Pipeline Async</h3>
      <p>Chaine de traitement asynchrone avec backpressure.</p>
      <pre><code>from("seda:input?size=1000")
  .pipeline()
  .process("validator")
  .process("transformer")
  .process("enricher")
  .to("seda:output");</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('engine')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
  </div>
</section>

<!-- Section 8: Design & Patterns -->
<section id="design">
  <div class="section-header">
    <h2><i class="fas fa-project-diagram"></i>8) üèóÔ∏è Design & Patterns</h2>
    <div class="section-tools">
      <span class="section-badge">Design</span>
      <div class="quick-actions">
        <a href="#engine" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#retry-strategies" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3>Patterns d'Int√©gration Enterprise</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-route"></i></div>
      <h3>Message Router</h3>
      <p>Routing intelligent bas√© sur le contenu, headers et r√®gles m√©tier.</p>
      <div class="code-header">
        <span>Content-Based Routing</span>
        <button class="copy-btn" data-clipboard-target="#pattern-router"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="pattern-router"><code class="language-java">from("direct:financialMessages")
  .choice()
    .when(header("messageType").isEqualTo("SWIFT"))
      .to("direct:swiftProcessing")
    .when(header("messageType").isEqualTo("SEPA"))
      .to("direct:sepaProcessing")
    .when(header("priority").isEqualTo("HIGH"))
      .to("direct:priorityQueue")
    .otherwise()
      .to("direct:standardProcessing")
  .end();</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-compress-arrows-alt"></i></div>
      <h3>Message Filter</h3>
      <p>Filtrage des messages bas√© sur des crit√®res m√©tier et techniques.</p>
      <div class="code-header">
        <span>Smart Filtering</span>
        <button class="copy-btn" data-clipboard-target="#pattern-filter"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="pattern-filter"><code class="language-java">from("direct:incomingPayments")
  .filter(header("amount").isGreaterThan(10000))
    .to("direct:largePayments")
  .end()
  .filter(header("currency").isEqualTo("EUR"))
    .to("direct:euroProcessing")
  .end();</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-sync"></i></div>
      <h3>Message Translator</h3>
      <p>Transformation de formats de messages avec validation et enrichissement.</p>
      <div class="code-header">
        <span>Data Transformation</span>
        <button class="copy-btn" data-clipboard-target="#pattern-translator"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="pattern-translator"><code class="language-java">from("direct:swiftIn")
  .unmarshal().swift()
  .process(new SwiftToInternalTransformer())
  .validate(new PaymentValidator())
  .enrich("direct:customerLookup", new CustomerEnricher())
  .marshal().json(JsonLibrary.Jackson)
  .to("direct:coreBanking");</code></pre>
    </div>
  </div>

  <h3>Patterns Avanc√©s BNP</h3>
  <div class="grid two">
    <div>
      <h4>Scatter-Gather</h4>
      <div class="code-header">
        <span>Parallel Processing</span>
        <button class="copy-btn" data-clipboard-target="#pattern-scatter-gather"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="pattern-scatter-gather"><code class="language-java">from("direct:paymentValidation")
  .setHeader("paymentId", simple("${body.paymentId}"))
  .multicast(new PaymentAggregationStrategy())
    .parallelProcessing()
    .timeout(5000)
    .to("direct:amlCheck", 
        "direct:fraudDetection", 
        "direct:accountValidation",
        "direct:complianceCheck")
  .end()
  .process(new ValidationResultProcessor())
  .choice()
    .when(header("validationStatus").isEqualTo("APPROVED"))
      .to("direct:executePayment")
    .otherwise()
      .to("direct:rejectedPayments");</code></pre>
    </div>
    <div>
      <h4>Circuit Breaker</h4>
      <div class="code-header">
        <span>Resilience Pattern</span>
        <button class="copy-btn" data-clipboard-target="#pattern-circuit-breaker"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="pattern-circuit-breaker"><code class="language-java">from("direct:coreBankingIntegration")
  .circuitBreaker()
    .resilience4jConfiguration()
      .failureRateThreshold(50)
      .waitDurationInOpenState(5000)
      .permittedNumberOfCallsInHalfOpenState(3)
      .automaticTransitionFromOpenToHalfOpenEnabled(true)
    .end()
    .to("direct:coreBankingService")
  .onFallback()
    .to("direct:fallbackProcessing")
  .end();</code></pre>
    </div>
  </div>

  <h3>Best Practices de Design BNP</h3>
  <div class="grid two">
    <div>
      <h4>Principles de Conception</h4>
      <ul>
        <li><strong>Single Responsibility</strong> : Une route = une responsabilit√©</li>
        <li><strong>Loose Coupling</strong> : Utilisation des EIPs pour le d√©couplage</li>
        <li><strong>Error Handling</strong> : Gestion centralis√©e des erreurs</li>
        <li><strong>Monitoring</strong> : Instrumentation compl√®te des routes</li>
        <li><strong>Configuration</strong> : Externalisation de la configuration</li>
        <li><strong>Testing</strong> : Tests unitaires et d'int√©gration</li>
      </ul>
    </div>
    <div>
      <h4>Anti-Patterns √† √âviter</h4>
      <ul>
        <li><strong>God Routes</strong> : Routes trop complexes</li>
        <li><strong>Hard Coding</strong> : Valeurs en dur dans le code</li>
        <li><strong>Ignoring Errors</strong> : Absence de gestion d'erreurs</li>
        <li><strong>Over-Threading</strong> : Trop de threads concurrents</li>
        <li><strong>Memory Leaks</strong> : Mauvaise gestion des ressources</li>
        <li><strong>Blocking Calls</strong> : Appels bloquants dans les routes</li>
      </ul>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('design')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
  </div>
</section>

<!-- Section 9: Strat√©gies Retry & Rejeux -->
<section id="retry-strategies">
  <div class="section-header">
    <h2><i class="fas fa-redo-alt"></i>9) üîÅ Strat√©gies Retry & Rejeux</h2>
    <div class="section-tools">
      <span class="section-badge">Resilience</span>
      <div class="quick-actions">
        <a href="#design" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#components" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3>Strat√©gies de Retry Avanc√©es</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-wave-square"></i></div>
      <h3>Exponential Backoff</h3>
      <p>Backoff exponentiel avec jitter pour √©viter les collisions.</p>
      <div class="code-header">
        <span>Configuration Backoff</span>
        <button class="copy-btn" data-clipboard-target="#retry-exponential"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="retry-exponential"><code class="language-java">// üîπ Exponential Backoff avec Jitter
from("direct:retryExample")
  .errorHandler(deadLetterChannel("direct:dlq")
    .maximumRedeliveries(5)
    .redeliveryDelay(1000)
    .backOffMultiplier(2)
    .useExponentialBackOff()
    .maximumRedeliveryDelay(60000)
    .retryAttemptedLogLevel(LoggingLevel.WARN)
    .asyncDelayedRedelivery()
  )
  .to("direct:externalService");</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-random"></i></div>
      <h3>Retry Conditionnel</h3>
      <p>Retry uniquement sur certains types d'erreurs.</p>
      <div class="code-header">
        <span>Conditional Retry</span>
        <button class="copy-btn" data-clipboard-target="#retry-conditional"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="retry-conditional"><code class="language-java">// üîπ Retry conditionnel bas√© sur l'exception
from("direct:conditionalRetry")
  .onException(NetworkException.class, TimeoutException.class)
    .maximumRedeliveries(3)
    .redeliveryDelay(2000)
    .useExponentialBackOff()
    .retriesExhaustedLogLevel(LoggingLevel.ERROR)
  .end()
  .onException(BusinessException.class, ValidationException.class)
    .maximumRedeliveries(0) // Pas de retry pour les erreurs m√©tier
    .handled(true)
    .to("direct:businessErrors")
  .end()
  .to("direct:criticalService");</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-cog"></i></div>
      <h3>Custom Retry Policy</h3>
      <p>Politique de retry personnalis√©e avec logique m√©tier.</p>
      <div class="code-header">
        <span>Custom Retry Strategy</span>
        <button class="copy-btn" data-clipboard-target="#retry-custom"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="retry-custom"><code class="language-java">// üîπ Custom Retry Policy BNP
@Component
public class BNPRetryPolicy implements RedeliveryPolicy {
    
    @Override
    public boolean shouldRetry(Exchange exchange, int retryCount) {
        // Logique m√©tier BNP pour d√©cider du retry
        Exception cause = exchange.getProperty(Exchange.EXCEPTION_CAUGHT, Exception.class);
        
        if (cause instanceof NetworkException) {
            return retryCount < 5; // 5 retries max pour r√©seau
        } else if (cause instanceof DatabaseException) {
            return retryCount < 3; // 3 retries max pour base de donn√©es
        } else if (cause instanceof BusinessException) {
            return false; // Pas de retry pour erreurs m√©tier
        }
        
        return retryCount < 2; // Default: 2 retries
    }
    
    @Override
    public long getRedeliveryDelay(Exchange exchange, int retryCount) {
        // Backoff personnalis√© bas√© sur le type d'erreur
        return Math.min(1000 * (long) Math.pow(2, retryCount), 30000);
    }
}</code></pre>
    </div>
  </div>

  <h3>Configuration des Dead Letter Queues</h3>
  <div class="grid two">
    <div>
      <h4>DLQ Configuration</h4>
      <div class="code-header">
        <span>Dead Letter Channel</span>
        <button class="copy-btn" data-clipboard-target="#config-dlq"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="config-dlq"><code class="language-java">// üîπ Configuration DLQ avanc√©e
from("direct:mainRoute")
  .errorHandler(deadLetterChannel("activemq:queue:BNP.DLQ")
    .maximumRedeliveries(5)
    .redeliveryDelay(5000)
    .backOffMultiplier(2)
    .useExponentialBackOff()
    .retryAttemptedLogLevel(LoggingLevel.WARN)
    .useOriginalMessage()
    .onPrepareFailure(new DLQPreProcessor())
    .deadLetterHandleNewException(false)
  )
  .process(new BusinessProcessor())
  .to("direct:nextStep");

// üîπ Route de traitement des DLQ
from("activemq:queue:BNP.DLQ")
  .routeId("bnp-dlq-processor")
  .process(new DLQAnalyzer())
  .choice()
    .when(header("DLQ_RETRY_ELIGIBLE").isEqualTo(true))
      .to("direct:retryHandler")
    .otherwise()
      .to("direct:permanentFailureHandler");</code></pre>
    </div>
    <div>
      <h4>DLQ Management</h4>
      <ul>
        <li><strong>Automatic Retry</strong> : Rejeux automatiques apr√®s correction</li>
        <li><strong>Manual Intervention</strong> : Interface pour gestion manuelle</li>
        <li><strong>Alerting</strong> : Notifications pour les DLQ critiques</li>
        <li><strong>Analytics</strong> : Analyse des causes racines</li>
        <li><strong>Retention Policy</strong> : Politique de r√©tention des DLQ</li>
        <li><strong>Archiving</strong> : Archivage des √©checs permanents</li>
      </ul>

      <h4>Metrics DLQ</h4>
      <div class="kpi">
        <div class="card">
          <div class="label">DLQ Rate</div>
          <div class="val">&lt; 0.1%</div>
        </div>
        <div class="card">
          <div class="label">Avg Retry Success</div>
          <div class="val">85%</div>
        </div>
        <div class="card">
          <div class="label">Resolution Time</div>
          <div class="val">&lt; 1h</div>
        </div>
      </div>
    </div>
  </div>

  <h3>Patterns de Rejeux BNP</h3>
  <table class="strategy-table">
    <thead>
      <tr>
        <th>Scenario</th>
        <th>Max Retries</th>
        <th>Backoff Strategy</th>
        <th>DLQ Action</th>
        <th>Monitoring</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>SWIFT Messages</strong></td>
        <td>3</td>
        <td>Exponential (2s, 4s, 8s)</td>
        <td>Manual Review</td>
        <td>CRITICAL</td>
      </tr>
      <tr>
        <td><strong>SEPA Payments</strong></td>
        <td>5</td>
        <td>Linear (5s intervals)</td>
        <td>Auto-Retry + Alert</td>
        <td>HIGH</td>
      </tr>
      <tr>
        <td><strong>Database Operations</strong></td>
        <td>2</td>
        <td>Fixed (10s)</td>
        <td>Auto-Retry</td>
        <td>MEDIUM</td>
      </tr>
      <tr>
        <td><strong>External APIs</strong></td>
        <td>4</td>
        <td>Exponential + Jitter</td>
        <td>Circuit Breaker</td>
        <td>HIGH</td>
      </tr>
    </tbody>
  </table>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('retry-strategies')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
  </div>
</section>

<!-- Section 10: Composants & Protocoles -->
<section id="components">
  <div class="section-header">
    <h2><i class="fas fa-plug"></i>10) üîå Composants & Protocoles</h2>
    <div class="section-tools">
      <span class="section-badge">Components</span>
      <div class="quick-actions">
        <a href="#retry-strategies" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#optimizations" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3>Composants Enterprise BNP</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-envelope"></i></div>
      <h3>IBM MQ Component</h3>
      <p>Int√©gration haute performance avec IBM MQ pour les messages financiers.</p>
      <div class="code-header">
        <span>IBM MQ Configuration</span>
        <button class="copy-btn" data-clipboard-target="#component-ibmmq"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-ibmmq"><code class="language-properties"># IBM MQ Configuration BNP
camel.component.ibm-mq.enabled=true
camel.component.ibm-mq.connection-factory=#mqConnectionFactory
camel.component.ibm-mq.username=${mq.username}
camel.component.ibm-mq.password=${mq.password}
camel.component.ibm-mq.channel=BNP.SVRCONN
camel.component.ibm-mq.queuemanager=BNP_QMGR
camel.component.ibm-mq.hostname=mq-bnp-prod.example.com
camel.component.ibm-mq.port=1414
camel.component.ibm-mq.consumer-exclusive=false
camel.component.ibm-mq.transacted=true
camel.component.ibm-mq.preserve-message-queuing=true</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-database"></i></div>
      <h3>JDBC Component</h3>
      <p>Acc√®s optimis√© aux bases de donn√©es Oracle avec connection pooling.</p>
      <div class="code-header">
        <span>JDBC Configuration</span>
        <button class="copy-btn" data-clipboard-target="#component-jdbc"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-jdbc"><code class="language-properties"># JDBC Configuration BNP
camel.component.jdbc.enabled=true
camel.component.jdbc.data-source=#oracleDataSource
camel.component.jdbc.use-jdbc-4-api=true
camel.component.jdbc.read-only=false
camel.component.jdbc.reset-auto-commit=false

# Oracle DataSource Configuration
spring.datasource.url=jdbc:oracle:thin:@//oracle-bnp:1521/BNPPROD
spring.datasource.username=${db.username}
spring.datasource.password=${db.password}
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.max-lifetime=1200000</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-exchange-alt"></i></div>
      <h3>REST Component</h3>
      <p>API REST s√©curis√©es avec authentification et rate limiting.</p>
      <div class="code-header">
        <span>REST Configuration</span>
        <button class="copy-btn" data-clipboard-target="#component-rest"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-rest"><code class="language-properties"># REST Configuration BNP
camel.component.platform-http.enabled=true
camel.component.platform-http.binding-mode=json
camel.component.platform-http.port=8080
camel.rest.component=platform-http
camel.rest.context-path=/api/v1
camel.rest.api-context-path=/api-doc
camel.rest.data-format-property.pretty-print=true
camel.rest.client-request-validation=true

# Security Configuration
camel.rest.api-vertex.title=BNP Camel API
camel.rest.api-vertex.version=1.0.0
camel.rest.security-definitions.basic.type=basic
camel.rest.security-definitions.basic.description=Basic Authentication</code></pre>
    </div>
  </div>

  <h3>Protocoles Sp√©cialis√©s BNP</h3>
  <div class="grid two">
    <div>
      <h4>SWIFT Integration</h4>
      <div class="code-header">
        <span>SWIFT Component</span>
        <button class="copy-btn" data-clipboard-target="#component-swift"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-swift"><code class="language-java">// üîπ SWIFT Message Processing
from("swift://inbound?configuration=#swiftConfig")
  .routeId("swift-inbound")
  .unmarshal().swift()
  .process(new SwiftMessageValidator())
  .choice()
    .when(header("SWIFT_TYPE").isEqualTo("MT103"))
      .to("direct:paymentProcessing")
    .when(header("SWIFT_TYPE").isEqualTo("MT202"))
      .to("direct:bankTransfer")
    .when(header("SWIFT_TYPE").isEqualTo("MT900"))
      .to("direct:confirmation")
    .otherwise()
      .to("direct:unknownSwiftType")
  .end();

// üîπ SWIFT Configuration
@Bean("swiftConfig")
public SwiftConfiguration swiftConfig() {
    SwiftConfiguration config = new SwiftConfiguration();
    config.setBankId("BNPAFRPP");
    config.setValidateMessages(true);
    config.setLogMessages(true);
    config.setCharset("UTF-8");
    return config;
}</code></pre>
    </div>
    <div>
      <h4>SEPA Integration</h4>
      <div class="code-header">
        <span>SEPA Component</span>
        <button class="copy-btn" data-clipboard-target="#component-sepa"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-sepa"><code class="language-java">// üîπ SEPA Payment Processing
from("file:/inbound/sepa?include=.*\\.xml")
  .routeId("sepa-inbound")
  .unmarshal().jaxb("org.bnpparibas.sepa")
  .process(new SEPAValidator())
  .split().body()
  .parallelProcessing()
  .to("direct:individualPayment")
  .end();

// üîπ SEPA Configuration
@Component
public class SEPARouteBuilder extends RouteBuilder {
    
    @Override
    public void configure() throws Exception {
        from("direct:individualPayment")
          .routeId("sepa-payment")
          .process(new PaymentEnricher())
          .choice()
            .when(header("amount").isGreaterThan(50000))
              .to("direct:largePaymentApproval")
            .otherwise()
              .to("direct:autoProcessPayment")
          .end()
          .marshal().jaxb("org.bnpparibas.sepa")
          .to("file:/outbound/sepa?fileExist=Append");
    }
}</code></pre>
    </div>
  </div>

  <h3>Composants Custom BNP</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
      <h3>BNP Security Component</h3>
      <p>Composant personnalis√© pour l'int√©gration avec les syst√®mes de s√©curit√© BNP.</p>
      <div class="code-header">
        <span>Security Component</span>
        <button class="copy-btn" data-clipboard-target="#component-security"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-security"><code class="language-java">// üîπ Custom Security Component
@Component("bnp-security")
public class BNPSecurityComponent extends DefaultComponent {
    
    @Override
    protected Endpoint createEndpoint(String uri, String remaining, Map<String, Object> parameters) {
        BNPSecurityEndpoint endpoint = new BNPSecurityEndpoint(uri, this);
        setProperties(endpoint, parameters);
        return endpoint;
    }
}

// üîπ Usage dans les routes
from("direct:secureProcessing")
  .to("bnp-security:encrypt?algorithm=AES-256&keyId=bnp-key-001")
  .to("bnp-security:sign?certificate=bnp-signing-cert")
  .to("direct:nextStep");</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
      <h3>BNP Analytics Component</h3>
      <p>Composant pour le tracking et l'analytics des transactions financi√®res.</p>
      <div class="code-header">
        <span>Analytics Component</span>
        <button class="copy-btn" data-clipboard-target="#component-analytics"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-analytics"><code class="language-java">// üîπ Custom Analytics Component
from("direct:financialTransaction")
  .to("bnp-analytics:track?category=PAYMENT&action=PROCESS")
  .process(new PaymentProcessor())
  .choice()
    .when(header("transactionStatus").isEqualTo("SUCCESS"))
      .to("bnp-analytics:track?category=PAYMENT&action=SUCCESS")
    .otherwise()
      .to("bnp-analytics:track?category=PAYMENT&action=FAILURE")
  .end();</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon"><i class="fas fa-cogs"></i></div>
      <h3>BNP Core Banking</h3>
      <p>Int√©gration avec les syst√®mes core banking legacy de BNP.</p>
      <div class="code-header">
        <span>Core Banking Integration</span>
        <button class="copy-btn" data-clipboard-target="#component-corebanking"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="component-corebanking"><code class="language-java">// üîπ Core Banking Integration
@Component("bnp-corebanking")
public class BNPCoreBankingComponent extends DefaultComponent {
    // Implementation pour l'int√©gration core banking
}

// üîπ Usage dans les routes
from("direct:accountOperation")
  .to("bnp-corebanking:account?operation=DEBIT&system=SYSTEM_A")
  .process(new CoreBankingResponseHandler())
  .to("direct:nextStep");</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('components')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
  </div>
</section>

      <!-- Section 11: Optimisations Avanc√©es -->
      <section id="optimizations">
        <div class="section-header">
          <h2><i class="fas fa-bolt"></i>11) ‚ö° Optimisations Avanc√©es</h2>
          <div class="section-tools">
            <span class="section-badge">Performance</span>
            <div class="quick-actions">
              <a href="#components" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#performance-tuning" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Optimisations M√©moire Avanc√©es</h3>
        <div class="grid two">
          <div>
            <h4>Memory Management</h4>
            <div class="code-header">
              <span>JVM Memory Optimization</span>
              <button class="copy-btn" data-clipboard-target="#optimization-memory"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-memory"><code class="language-bash"># üîπ JVM Memory Configuration BNP
-Xmx8g -Xms8g
-XX:MaxMetaspaceSize=512m
-XX:MetaspaceSize=256m
-XX:MaxDirectMemorySize=2g
-XX:ReservedCodeCacheSize=512m
-XX:InitialCodeCacheSize=256m

# üîπ Garbage Collection Optimization
-XX:+UseZGC
-XX:+ZGenerational
-Xlog:gc*,gc+age=trace,safepoint:file=/logs/gc.log:utctime,level,tags:filecount=10,filesize=100m
-XX:ZCollectionInterval=300
-XX:ZAllocationSpikeTolerance=4

# üîπ Memory Pool Optimization
-XX:+UseCompressedOops
-XX:+UseCompressedClassPointers
-XX:ObjectAlignmentInBytes=16
-XX:+UseStringDeduplication
-XX:+UseContainerSupport</code></pre>
          </div>
          <div>
            <h4>Camel Stream Caching</h4>
            <div class="code-header">
              <span>Stream Caching Configuration</span>
              <button class="copy-btn" data-clipboard-target="#optimization-stream"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-stream"><code class="language-properties"># üîπ Stream Caching Optimization
camel.stream-caching.enabled=true
camel.stream-caching.spool-enabled=true
camel.stream-caching.spool-directory=/tmp/camel-spool
camel.stream-caching.spool-threshold=64k
camel.stream-caching.spool-used-up-memory-threshold=0.8
camel.stream-caching.buffer-size=128k
camel.stream-caching.capacity=1000
camel.stream-caching.statistics-enabled=true

# üîπ Zero-Copy Optimization
camel.stream-caching.zero-copy.enabled=true
camel.stream-caching.any-spool-rules=true
camel.stream-caching.remove-spool-directory-when-stopping=false

# üîπ Memory Monitoring
camel.stream-caching.monitoring.enabled=true
camel.stream-caching.metrics.enabled=true</code></pre>
          </div>
        </div>

        <h3>Optimisations Processeur</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-microchip"></i></div>
            <h3>CPU Affinity</h3>
            <p>Affinit√© processeur pour les threads critiques.</p>
            <div class="code-header">
              <span>CPU Affinity Configuration</span>
              <button class="copy-btn" data-clipboard-target="#optimization-cpu"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-cpu"><code class="language-java">// üîπ CPU Affinity pour threads critiques
@Bean
public ThreadPoolExecutor criticalThreadPool() {
    ThreadPoolExecutor executor = new ThreadPoolExecutor(
        10, 50, 60L, TimeUnit.SECONDS,
        new LinkedBlockingQueue<>(1000),
        new BNPCpuAffinityThreadFactory("critical", "0-3") // Cores 0-3
    );
    return executor;
}

// üîπ Custom Thread Factory avec CPU Affinity
public class BNPCpuAffinityThreadFactory implements ThreadFactory {
    private final String namePrefix;
    private final String cpuSet;
    
    public BNPCpuAffinityThreadFactory(String poolName, String cpuSet) {
        this.namePrefix = "bnp-" + poolName + "-";
        this.cpuSet = cpuSet;
    }
    
    @Override
    public Thread newThread(Runnable r) {
        Thread t = new Thread(() -> {
            // Set CPU affinity
            setCpuAffinity(cpuSet);
            r.run();
        }, namePrefix + threadNumber.getAndIncrement());
        return t;
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-network-wired"></i></div>
            <h3>NUMA Awareness</h3>
            <p>Optimisations pour les architectures NUMA.</p>
            <div class="code-header">
              <span>NUMA Configuration</span>
              <button class="copy-btn" data-clipboard-target="#optimization-numa"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-numa"><code class="language-bash"># üîπ NUMA Awareness Configuration
-XX:+UseNUMA
-XX:+UseAdaptiveSizePolicy
-XX:AllocatePrefetchStyle=2
-XX:AllocatePrefetchLines=12
-XX:AllocateInstancePrefetchLines=3
-XX:AllocatePrefetchStepSize=64
-XX:AllocatePrefetchDistance=256

# üîπ Memory Allocation Optimization
-XX:+UseLargePages
-XX:LargePageSizeInBytes=2m
-XX:+UseTransparentHugePages
-XX:+AlwaysPreTouch</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-memory"></i></div>
            <h3>Cache Optimization</h3>
            <p>Optimisations des caches processeur et m√©moire.</p>
            <div class="code-header">
              <span>Cache Configuration</span>
              <button class="copy-btn" data-clipboard-target="#optimization-cache"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-cache"><code class="language-bash"># üîπ CPU Cache Optimization
-XX:CompileThreshold=10000
-XX:+TieredCompilation
-XX:CICompilerCount=4
-XX:BackgroundCompilation=true
-XX:-UseBiasedLocking
-XX:+UseCondCardMark

# üîπ Code Cache Optimization
-XX:ReservedCodeCacheSize=512m
-XX:InitialCodeCacheSize=64m
-XX:+SegmentedCodeCache
-XX:NonNMethodCodeHeapSize=32m
-XX:NonProfiledCodeHeapSize=120m
-XX:ProfiledCodeHeapSize=120m</code></pre>
          </div>
        </div>

        <h3>Optimisations R√©seau</h3>
        <div class="grid two">
          <div>
            <h4>TCP/IP Tuning</h4>
            <div class="code-header">
              <span>Network Optimization</span>
              <button class="copy-btn" data-clipboard-target="#optimization-network"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-network"><code class="language-bash"># üîπ TCP/IP Kernel Parameters
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 16384 16777216
net.core.netdev_max_backlog = 30000
net.ipv4.tcp_max_syn_backlog = 262144
net.core.somaxconn = 65535
net.ipv4.tcp_no_metrics_save = 1
net.ipv4.tcp_slow_start_after_idle = 0

# üîπ Socket Buffer Optimization
-Djava.net.preferIPv4Stack=true
-Dorg.apache.camel.component.http.socketBufferSize=131072
-Dorg.apache.camel.component.http.socketTimeout=30000
-Dorg.apache.camel.component.http.connectionTimeout=10000</code></pre>
          </div>
          <div>
            <h4>I/O Optimization</h4>
            <div class="code-header">
              <span>I/O Configuration</span>
              <button class="copy-btn" data-clipboard-target="#optimization-io"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="optimization-io"><code class="language-properties"># üîπ NIO Optimization
camel.threads.nio.enabled=true
camel.threads.nio.pool-size=16
camel.threads.nio.max-pool-size=64
camel.threads.nio.keep-alive-time=60s

# üîπ Async I/O Configuration
camel.threads.async.enabled=true
camel.threads.async.core-pool-size=8
camel.threads.async.max-pool-size=32
camel.threads.async.queue-capacity=10000

# üîπ File I/O Optimization
camel.file.buffer-size=131072
camel.file.read-lock=changed
camel.file.read-lock-check-interval=1000
camel.file.read-lock-timeout=60000
camel.file.read-lock-log-level=WARN</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('optimizations')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 12: Performance Tuning -->
      <section id="performance-tuning">
        <div class="section-header">
          <h2><i class="fas fa-tachometer-alt"></i>12) üéõÔ∏è Performance Tuning</h2>
          <div class="section-tools">
            <span class="section-badge">Tuning</span>
            <div class="quick-actions">
              <a href="#optimizations" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#resilience-patterns" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Tuning des Routes Camel</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-route"></i></div>
            <h3>Route Optimization</h3>
            <p>Optimisation des performances des routes individuelles.</p>
            <div class="code-header">
              <span>Route Tuning Configuration</span>
              <button class="copy-btn" data-clipboard-target="#tuning-routes"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="tuning-routes"><code class="language-java">// üîπ Route Performance Tuning
from("direct:optimizedRoute")
  .routeId("high-performance-route")
  .routePolicy(new PerformanceRoutePolicy())
  .startupOrder(1) // D√©marrage prioritaire
  .streamCaching() // Activation du cache de stream
  .threads()
    .poolSize(10)
    .maxPoolSize(50)
    .maxQueueSize(1000)
    .rejectedPolicy(ThreadPoolRejectedPolicy.Abort)
  .end()
  .process(new OptimizedProcessor())
  .to("direct:nextStep")
  .routePolicy(new MetricsRoutePolicy()) // Collecte de m√©triques
  .log("Route processing completed: ${body}");</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-database"></i></div>
            <h3>Database Tuning</h3>
            <p>Optimisation des acc√®s base de donn√©es.</p>
            <div class="code-header">
              <span>Database Performance</span>
              <button class="copy-btn" data-clipboard-target="#tuning-database"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="tuning-database"><code class="language-java">// üîπ Database Access Optimization
from("direct:batchDatabaseOperations")
  .routeId("batch-db-ops")
  .split(body()).parallelProcessing() // Traitement parall√®le
    .to("jdbc:dataSource?useHeadersAsParameters=true")
  .end()
  .aggregate(constant(true), new ListAggregationStrategy())
    .completionSize(1000) // Agr√©gation par lots de 1000
    .completionTimeout(5000)
  .end()
  .process(new BatchResultProcessor());

// üîπ Optimized SQL Queries
from("direct:optimizedQuery")
  .setBody(constant("SELECT * FROM transactions WHERE status = ? AND created_date > ?"))
  .setHeader("CamelJdbcParameters", 
    simple("${header.status}, ${header.fromDate}"))
  .to("jdbc:dataSource?readSize=1000&outputType=StreamList")
  .split(body()).streaming() // Streaming pour gros r√©sultats
    .process(new RowProcessor());</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-exchange-alt"></i></div>
            <h3>Message Tuning</h3>
            <p>Optimisation du traitement des messages.</p>
            <div class="code-header">
              <span>Message Processing</span>
              <button class="copy-btn" data-clipboard-target="#tuning-messages"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="tuning-messages"><code class="language-java">// üîπ Message Processing Optimization
from("jms:queue:BNP.INPUT?concurrentConsumers=10&maxConcurrentConsumers=20")
  .routeId("jms-optimized-consumer")
  .transacted("PROPAGATION_REQUIRED") // Transactions
  .choice()
    .when(header("JMSRedelivered").isEqualTo("true"))
      .log("Redelivered message: ${header.JMSMessageID}")
      .to("direct:redeliveryHandler")
    .otherwise()
      .process(new MessageProcessor())
  .end()
  .log("Message processed successfully: ${header.JMSMessageID}");

// üîπ Batch Message Processing
from("file:/inbound/large?include=.*\\.csv")
  .routeId("batch-file-processor")
  .split().tokenize("\n", 1000).streaming() // Traitement par lots
    .parallelProcessing()
    .process(new CSVProcessor())
  .end()
  .log("Batch processing completed");</code></pre>
          </div>
        </div>

        <h3>Performance Monitoring & Tuning</h3>
        <div class="grid two">
          <div>
            <h4>Real-time Monitoring</h4>
            <div class="code-header">
              <span>Performance Metrics</span>
              <button class="copy-btn" data-clipboard-target="#tuning-monitoring"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="tuning-monitoring"><code class="language-java">// üîπ Performance Monitoring Configuration
@Component
public class PerformanceMonitor {
    
    private final MeterRegistry meterRegistry;
    private final Timer routeProcessingTimer;
    private final Counter errorCounter;
    
    public PerformanceMonitor(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        
        this.routeProcessingTimer = Timer.builder("camel.route.processing.time")
            .description("Temps de traitement des routes")
            .publishPercentiles(0.5, 0.95, 0.99)
            .register(meterRegistry);
            
        this.errorCounter = Counter.builder("camel.route.errors")
            .description("Nombre d'erreurs par route")
            .register(meterRegistry);
    }
    
    public void recordRouteProcessing(String routeId, long duration) {
        routeProcessingTimer.record(duration, TimeUnit.MILLISECONDS,
            Tags.of("routeId", routeId));
    }
    
    public void recordError(String routeId, String errorType) {
        errorCounter.increment(Tags.of(
            "routeId", routeId,
            "errorType", errorType
        ));
    }
}</code></pre>
          </div>
          <div>
            <h4>Performance KPIs</h4>
            <div class="kpi">
              <div class="card">
                <div class="label">Throughput Target</div>
                <div class="val">2,000 tx/s</div>
              </div>
              <div class="card">
                <div class="label">Latency p95</div>
                <div class="val">&lt; 50ms</div>
              </div>
              <div class="card">
                <div class="label">Error Rate</div>
                <div class="val">&lt; 0.01%</div>
              </div>
              <div class="card">
                <div class="label">CPU Usage</div>
                <div class="val">&lt; 70%</div>
              </div>
            </div>

            <h4>Tuning Checklist</h4>
            <ul>
              <li>‚úÖ Monitoring des m√©triques en temps r√©el</li>
              <li>‚úÖ Optimisation de la m√©moire JVM</li>
              <li>‚úÖ Configuration des thread pools</li>
              <li>‚úÖ Tuning des connexions base de donn√©es</li>
              <li>‚úÖ Optimisation du cache</li>
              <li>‚úÖ Configuration du garbage collection</li>
            </ul>
          </div>
        </div>

        <h3>Auto-tuning Avanc√©</h3>
        <div class="code-header">
          <span>Auto-tuning Configuration</span>
          <button class="copy-btn" data-clipboard-target="#tuning-automatic"><i class="fas fa-copy"></i> Copier</button>
        </div>
        <pre id="tuning-automatic"><code class="language-java">// üîπ Auto-tuning Service
@Component
public class BNPAutoTuningService {
    
    private final Map<String, TuningProfile> tuningProfiles;
    private final MeterRegistry meterRegistry;
    
    @Scheduled(fixedRate = 30000) // Toutes les 30 secondes
    public void autoTune() {
        // Analyse des m√©triques de performance
        analyzePerformanceMetrics();
        
        // Ajustement automatique des configurations
        adjustThreadPools();
        adjustMemorySettings();
        adjustCircuitBreakers();
    }
    
    private void adjustThreadPools() {
        // Logique d'ajustement automatique des thread pools
        double currentThroughput = getCurrentThroughput();
        double targetThroughput = getTargetThroughput();
        
        if (currentThroughput < targetThroughput * 0.8) {
            increaseThreadPoolSize();
        } else if (currentThroughput > targetThroughput * 1.2) {
            decreaseThreadPoolSize();
        }
    }
    
    private void analyzePerformanceMetrics() {
        // Analyse des m√©triques pour d√©tecter les bottlenecks
        detectBottlenecks();
        identifyResourceConstraints();
        predictFutureLoad();
    }
}</code></pre>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('performance-tuning')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 13: R√©silience Avanc√©e -->
      <section id="resilience-patterns">
        <div class="section-header">
          <h2><i class="fas fa-shield-alt"></i>13) üõ°Ô∏è R√©silience Avanc√©e</h2>
          <div class="section-tools">
            <span class="section-badge">Resilience</span>
            <div class="quick-actions">
              <a href="#performance-tuning" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#observability" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Circuit Breaker Avanc√©</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-traffic-light"></i></div>
            <h3>Resilience4j Integration</h3>
            <p>Int√©gration avanc√©e avec Resilience4j pour la r√©silience des services.</p>
            <div class="code-header">
              <span>Circuit Breaker Configuration</span>
              <button class="copy-btn" data-clipboard-target="#resilience-circuit"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="resilience-circuit"><code class="language-java">// üîπ Circuit Breaker Avanc√©
from("direct:resilientService")
  .circuitBreaker()
    .resilience4jConfiguration()
      .failureRateThreshold(50)
      .slowCallRateThreshold(50)
      .slowCallDurationThreshold(2000)
      .waitDurationInOpenState(10000)
      .permittedNumberOfCallsInHalfOpenState(5)
      .minimumNumberOfCalls(10)
      .slidingWindowType(SlidingWindowType.TIME_BASED)
      .slidingWindowSize(60)
      .automaticTransitionFromOpenToHalfOpenEnabled(true)
      .recordExceptions(IOException.class, TimeoutException.class)
      .ignoreExceptions(BusinessException.class)
    .end()
    .to("direct:externalService")
  .onFallback()
    .process(new FallbackProcessor())
    .log("Circuit breaker fallback activated")
  .end();</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-box"></i></div>
            <h3>Bulkhead Pattern</h3>
            <p>Isolation des ressources pour √©viter la propagation des d√©faillances.</p>
            <div class="code-header">
              <span>Bulkhead Configuration</span>
              <button class="copy-btn" data-clipboard-target="#resilience-bulkhead"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="resilience-bulkhead"><code class="language-java">// üîπ Bulkhead Pattern Implementation
from("direct:bulkheadProtected")
  .bulkhead()
    .resilience4jConfiguration()
      .maxConcurrentCalls(10)
      .maxWaitDuration(1000)
    .end()
    .to("direct:resourceIntensiveService")
  .onFallback()
    .to("direct:bulkheadFallback")
  .end();

// üîπ Bulkhead avec Thread Pool d√©di√©
@Bean("bulkheadThreadPool")
public ThreadPoolExecutor bulkheadThreadPool() {
    return new ThreadPoolExecutor(
        5, 10, 60L, TimeUnit.SECONDS,
        new ArrayBlockingQueue<>(20),
        new BNPThreadFactory("bulkhead"),
        new ThreadPoolExecutor.CallerRunsPolicy()
    );
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-clock"></i></div>
            <h3>Timeout Management</h3>
            <p>Gestion avanc√©e des timeouts avec fallback strat√©gique.</p>
            <div class="code-header">
              <span>Timeout Configuration</span>
              <button class="copy-btn" data-clipboard-target="#resilience-timeout"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="resilience-timeout"><code class="language-java">// üîπ Timeout Pattern Avanc√©
from("direct:timeoutProtected")
  .timeout()
    .resilience4jConfiguration()
      .timeoutDuration(Duration.ofSeconds(5))
      .cancelRunningFuture(true)
    .end()
    .to("direct:slowService")
  .onFallback()
    .process(new TimeoutFallbackProcessor())
    .log("Timeout occurred, executing fallback")
  .end();

// üîπ Timeout hi√©rarchique
from("direct:hierarchicalTimeout")
  .pipeline()
    .timeout(1000).to("direct:fastOperation").end()
    .timeout(5000).to("direct:mediumOperation").end()
    .timeout(30000).to("direct:slowOperation").end()
  .end()
  .process(new ResultAggregator());</code></pre>
          </div>
        </div>

        <h3>Patterns de R√©silience BNP</h3>
        <div class="grid two">
          <div>
            <h4>Retry with Exponential Backoff</h4>
            <div class="code-header">
              <span>Advanced Retry Strategy</span>
              <button class="copy-btn" data-clipboard-target="#resilience-retry"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="resilience-retry"><code class="language-java">// üîπ Retry Strategy Avanc√©e
from("direct:advancedRetry")
  .retryWhile(new BNPRetryPredicate())
  .resilience4jConfiguration()
    .maxAttempts(5)
    .waitDuration(Duration.ofSeconds(1))
    .enableExponentialBackoff(true)
    .exponentialBackoffMultiplier(2)
    .enableRandomWait(true)
    .randomWaitFactor(0.5)
  .end()
  .to("direct:unreliableService")
  .onFailure()
    .log("All retry attempts exhausted")
    .to("direct:finalFallback")
  .end();

// üîπ Custom Retry Predicate
@Component
public class BNPRetryPredicate implements Predicate<Exchange> {
    
    @Override
    public boolean test(Exchange exchange) {
        Exception cause = exchange.getProperty(Exchange.EXCEPTION_CAUGHT, Exception.class);
        
        // Retry uniquement sur les erreurs r√©seau et temporaires
        return cause instanceof IOException || 
               cause instanceof TimeoutException ||
               (cause instanceof SQLException && 
                ((SQLException) cause).getErrorCode() == 1205); // Deadlock
    }
}</code></pre>
          </div>
          <div>
            <h4>Fallback Strategies</h4>
            <div class="code-header">
              <span>Fallback Implementation</span>
              <button class="copy-btn" data-clipboard-target="#resilience-fallback"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="resilience-fallback"><code class="language-java">// üîπ Fallback Strategy Hi√©rarchique
@Component
public class BNPFallbackStrategy {
    
    public Exchange primaryFallback(Exchange exchange) {
        // Tentative de fallback primaire
        try {
            return attemptPrimaryFallback(exchange);
        } catch (Exception e) {
            // Si √©chec, passer au fallback secondaire
            return secondaryFallback(exchange);
        }
    }
    
    public Exchange secondaryFallback(Exchange exchange) {
        // Fallback secondaire plus robuste
        exchange.getIn().setBody("SERVICE_UNAVAILABLE");
        exchange.getIn().setHeader("X-Fallback-Reason", "Secondary fallback activated");
        return exchange;
    }
    
    public Exchange finalFallback(Exchange exchange) {
        // Fallback final avec notification
        notifyOperationsTeam(exchange);
        exchange.getIn().setBody("SYSTEM_DEGRADED");
        return exchange;
    }
}

// üîπ Usage dans les routes
from("direct:fallbackExample")
  .circuitBreaker()
    .to("direct:primaryService")
  .onFallback()
    .bean("bnpFallbackStrategy", "primaryFallback")
  .end();</code></pre>
          </div>
        </div>

        <h3>Monitoring de la R√©silience</h3>
        <table class="strategy-table">
          <thead>
            <tr>
              <th>M√©trique</th>
              <th>Seuil d'Alerte</th>
              <th>Action</th>
              <th>Dashboard</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Circuit Breaker Open</strong></td>
              <td>√âtat = OPEN</td>
              <td>Alert IMMEDIATE</td>
              <td>Resilience-Monitoring</td>
            </tr>
            <tr>
              <td><strong>Fallback Rate</strong></td>
              <td>> 5%</td>
              <td>Investigation</td>
              <td>Service-Health</td>
            </tr>
            <tr>
              <td><strong>Timeout Rate</strong></td>
              <td>> 2%</td>
              <td>Performance Review</td>
              <td>Performance-Metrics</td>
            </tr>
            <tr>
              <td><strong>Bulkhead Saturation</strong></td>
              <td>> 80%</td>
              <td>Capacity Planning</td>
              <td>Resource-Monitoring</td>
            </tr>
          </tbody>
        </table>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('resilience-patterns')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

<!-- Section 14: Observabilit√© - Version Corrig√©e avec Couleurs Am√©lior√©es -->
<section id="observability">
  <div class="section-header">
    <h2><i class="fas fa-chart-bar"></i>14) üìà Observabilit√© BNP</h2>
    <div class="section-tools">
      <span class="section-badge">Monitoring</span>
      <div class="quick-actions">
        <a href="#resilience-patterns" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#security" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üèóÔ∏è Architecture d'Observabilit√© BNP</h3>
  
  <!-- DIAGRAMME Architecture Observabilit√© -->
  <div class="diagram-container">
    <div class="diagram-title" style="color: var(--accent2); font-weight: 700;">Architecture d'Observabilit√© BNP Paribas - Three Pillars</div>
    <div class="diagram-content">
      <div style="width: 100%;">
        <!-- Niveau 1: Data Collection -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #e3f2fd, #bbdefb);">
          <div class="node-title" style="color: #1565c0; font-weight: 700;">üìä Data Collection Layer</div>
          <div class="node-content" style="color: #0d47a1;">
            <div class="component-diagram">
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-code"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">Application</div>
                <div style="color: #0d47a1;">Spring Boot 3.3 + Camel 4.15</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-cube"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">Infrastructure</div>
                <div style="color: #0d47a1;">Kubernetes + Docker</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-network-wired"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">R√©seau</div>
                <div style="color: #0d47a1;">Load Balancers + Service Mesh</div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 2: Three Pillars -->
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <!-- Logs -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #e8f5e8, #c8e6c9);">
            <div class="node-title" style="color: #1b5e20; font-weight: 700;">üìù Logs</div>
            <div class="node-content" style="color: #2e7d32;">
              <div style="color: #1b5e20; font-weight: 600;">ELK Stack BNP</div>
              <div>‚Ä¢ Logs structur√©s JSON</div>
              <div>‚Ä¢ Centralisation Elasticsearch</div>
              <div>‚Ä¢ Visualisation Kibana</div>
              <div>‚Ä¢ R√©tention: 2 ans</div>
              <div>‚Ä¢ Indexing temps r√©el</div>
            </div>
          </div>

          <!-- M√©triques -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #fff3e0, #ffe0b2);">
            <div class="node-title" style="color: #e65100; font-weight: 700;">üìà M√©triques</div>
            <div class="node-content" style="color: #ef6c00;">
              <div style="color: #e65100; font-weight: 600;">Prometheus + Grafana</div>
              <div>‚Ä¢ Collecte toutes les 15s</div>
              <div>‚Ä¢ Stockage: 13 mois</div>
              <div>‚Ä¢ 500+ dashboards</div>
              <div>‚Ä¢ Alerting intelligent</div>
              <div>‚Ä¢ Auto-discovery</div>
            </div>
          </div>

          <!-- Traces -->
          <div class="architecture-node" style="background: linear-gradient(135deg, #f3e5f5, #e1bee7);">
            <div class="node-title" style="color: #4a148c; font-weight: 700;">üîç Traces</div>
            <div class="node-content" style="color: #7b1fa2;">
              <div style="color: #4a148c; font-weight: 600;">Jaeger + OpenTelemetry</div>
              <div>‚Ä¢ Tracing distribu√©</div>
              <div>‚Ä¢ 100% des transactions</div>
              <div>‚Ä¢ Contexte m√©tier</div>
              <div>‚Ä¢ Performance analysis</div>
              <div>‚Ä¢ Dependency mapping</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 3: Processing & Storage -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #fce4ec, #f8bbd9);">
          <div class="node-title" style="color: #880e4f; font-weight: 700;">‚ö° Processing & Storage</div>
          <div class="node-content" style="color: #ad1457;">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
              <div>
                <strong style="color: #880e4f;">Data Processing</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Logstash pipelines</div>
                  <div>‚Ä¢ Prometheus rules</div>
                  <div>‚Ä¢ Alertmanager</div>
                  <div>‚Ä¢ Data enrichment</div>
                </div>
              </div>
              <div>
                <strong style="color: #880e4f;">Storage Cluster</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Elasticsearch: 50 nodes</div>
                  <div>‚Ä¢ Prometheus: 20 TB</div>
                  <div>‚Ä¢ Jaeger: 5 TB</div>
                  <div>‚Ä¢ S3 Archive: 200 TB</div>
                </div>
              </div>
              <div>
                <strong style="color: #880e4f;">Data Pipeline</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Kafka streams</div>
                  <div>‚Ä¢ Real-time processing</div>
                  <div>‚Ä¢ Batch aggregation</div>
                  <div>‚Ä¢ GDPR compliance</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 4: Visualization & Alerting -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div class="architecture-node">
            <div class="node-title" style="color: #01579b; font-weight: 700;">üé® Visualization</div>
            <div class="node-content" style="color: #0277bd;">
              <div style="color: #01579b; font-weight: 600;">Grafana BNP</div>
              <div>‚Ä¢ 200+ dashboards m√©tier</div>
              <div>‚Ä¢ Real-time streaming</div>
              <div>‚Ä¢ Custom widgets</div>
              <div>‚Ä¢ Multi-datacenter</div>
              <div>‚Ä¢ SLA monitoring</div>
            </div>
          </div>

          <div class="architecture-node">
            <div class="node-title" style="color: #b71c1c; font-weight: 700;">üö® Alerting</div>
            <div class="node-content" style="color: #c62828;">
              <div style="color: #b71c1c; font-weight: 600;">PagerDuty + OpsGenie</div>
              <div>‚Ä¢ Escalation policies</div>
              <div>‚Ä¢ On-call rotations</div>
              <div>‚Ä¢ Smart routing</div>
              <div>‚Ä¢ Post-mortem auto</div>
              <div>‚Ä¢ SLA breach detection</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Three Pillars of Observability</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">üìù Logs</strong> : Centralis√©s avec ELK Stack, logs structur√©s JSON</li>
        <li><strong style="color: var(--accent);">üìà M√©triques</strong> : Collecte temps r√©el avec Prometheus, 500+ dashboards Grafana</li>
        <li><strong style="color: var(--accent);">üîç Traces</strong> : Distributed tracing avec Jaeger et OpenTelemetry</li>
        <li><strong style="color: var(--accent);">üé® Dashboards</strong> : Visualisation temps r√©el avec Grafana BNP</li>
        <li><strong style="color: var(--accent);">üö® Alerting</strong> : Syst√®me d'alertes intelligent avec PagerDuty</li>
        <li><strong style="color: var(--accent);">üìä Profiling</strong> : Profilage des performances JVM et application</li>
      </ul>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Configuration Observabilit√©</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Observability Config</span>
        <button class="copy-btn" data-clipboard-target="#observability-config"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-config"><code class="language-properties"># üîπ Micrometer Metrics Configuration BNP
management.metrics.export.prometheus.enabled=true
management.metrics.export.prometheus.step=15s
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles=0.5,0.75,0.95,0.99,0.999
management.metrics.enable.jvm=true
management.metrics.enable.logback=true
management.metrics.enable.undertow=true

# üîπ Distributed Tracing BNP
management.tracing.sampling.probability=1.0
management.zipkin.base-url=http://zipkin-bnp:9411
management.jaeger.endpoint=http://jaeger-bnp:14268/api/traces
management.otlp.endpoint=http://otel-collector-bnp:4317

# üîπ Logging Configuration BNP
logging.level.org.apache.camel=INFO
logging.level.com.bnpparibas=DEBUG
logging.level.org.springframework=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %X{traceId} %X{spanId} %msg%n
logging.file.name=/logs/bnp-camel-app.log
logging.file.max-size=100MB
logging.file.max-history=30
logging.logstash.enabled=true
logging.logstash.host=logstash-bnp
logging.logstash.port=5000

# üîπ Custom Metrics BNP
bnp.metrics.enabled=true
bnp.metrics.business.enabled=true
bnp.metrics.performance.enabled=true
bnp.metrics.security.enabled=true</code></pre>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìä M√©triques Business Critiques BNP</h3>
  <div class="kpi">
    <div class="card">
      <div class="label" style="color: var(--muted);">Transactions SWIFT/jour</div>
      <div class="val" style="color: var(--accent);">2.1M</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">Latence P95</div>
      <div class="val" style="color: var(--good);">47ms</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">Taux de Succ√®s</div>
      <div class="val" style="color: var(--good);">99.98%</div>
    </div>
    <div class="card">
      <div class="label" style="color: var(--muted);">Alertes Actives</div>
      <div class="val" style="color: var(--warn);">12</div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üîç Distributed Tracing Avanc√©</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-project-diagram"></i></div>
      <h3 style="color: var(--accent2);">OpenTelemetry Integration</h3>
      <p style="color: var(--ink);">Int√©gration compl√®te avec OpenTelemetry pour le tracing distribu√© des transactions financi√®res.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Tracing Configuration BNP</span>
        <button class="copy-btn" data-clipboard-target="#observability-tracing"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-tracing"><code class="language-java">// üîπ OpenTelemetry Configuration BNP
@Configuration
@EnableOpenTelemetry
public class BNPOpenTelemetryConfig {
    
    @Bean
    public OpenTelemetry openTelemetry() {
        return OpenTelemetrySdk.builder()
            .setTracerProvider(
                SdkTracerProvider.builder()
                    .addSpanProcessor(
                        BatchSpanProcessor.builder(
                            OtlpGrpcSpanExporter.builder()
                                .setEndpoint("http://otel-collector-bnp:4317")
                                .addHeader("x-bnp-auth", "${otel.auth.token}")
                                .setTimeout(Duration.ofSeconds(10))
                                .build()
                        )
                        .setScheduleDelay(Duration.ofMillis(100))
                        .setMaxQueueSize(5000)
                        .setMaxExportBatchSize(1000)
                        .build()
                    )
                    .setResource(Resource.getDefault().merge(
                        Resource.builder()
                            .put("service.name", "camel-bnp-payments")
                            .put("service.version", "4.15.0")
                            .put("deployment.environment", "production")
                            .put("bnp.datacenter", "paris-1")
                            .put("bnp.division", "global-markets")
                            .build()
                    ))
                    .build()
            )
            .setPropagators(
                ContextPropagators.create(
                    TextMapPropagator.composite(
                        W3CTraceContextPropagator.getInstance(),
                        W3CBaggagePropagator.getInstance(),
                        BNPBusinessContextPropagator.getInstance()
                    )
                )
            )
            .buildAndRegisterGlobal();
    }
    
    // üîπ Custom Camel Interceptor pour le tracing BNP
    @Bean
    public BNPTracingInterceptor bnpTracingInterceptor() {
        return new BNPTracingInterceptor(openTelemetry());
    }
}</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-search"></i></div>
      <h3 style="color: var(--accent2);">Business Context Tracing</h3>
      <p style="color: var(--ink);">Tracing avec contexte m√©tier BNP pour le debugging transactionnel et la conformit√©.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Business Tracing BNP</span>
        <button class="copy-btn" data-clipboard-target="#observability-business"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-business"><code class="language-java">// üîπ Business Context Propagation BNP
@Component
public class BNPBusinessTracer {
    
    private final Tracer tracer;
    
    public void startBusinessTransaction(String transactionId, String businessType, 
                                       String customerId, BigDecimal amount) {
        Span span = tracer.spanBuilder("bnp.business.transaction")
            .setSpanKind(SpanKind.SERVER)
            .setAttribute("bnp.transaction.id", transactionId)
            .setAttribute("bnp.business.type", businessType)
            .setAttribute("bnp.customer.id", customerId)
            .setAttribute("bnp.amount", amount.doubleValue())
            .setAttribute("bnp.bank.code", "BNPAFRPP")
            .setAttribute("bnp.division", "capital-markets")
            .setAttribute("bnp.regulatory.scope", "mifid-ii")
            .startSpan();
        
        try (Scope scope = span.makeCurrent()) {
            // üîπ Contexte m√©tier suppl√©mentaire
            span.addEvent("transaction.started", Attributes.of(
                AttributeKey.stringKey("initiator"), "camel-route",
                AttributeKey.longKey("timestamp"), System.currentTimeMillis()
            ));
            
            // Logique m√©tier...
            processBusinessTransaction();
            
        } finally {
            span.end();
        }
    }
}</code></pre>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìù Logging Structur√© Avanc√© BNP</h3>
  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Structured Logging Configuration</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Logback JSON Configuration BNP</span>
        <button class="copy-btn" data-clipboard-target="#observability-logging"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-logging"><code class="language-xml">&lt;!-- Logback JSON Configuration BNP --&gt;
&lt;configuration&gt;
    &lt;appender name="JSON" class="ch.qos.logback.core.ConsoleAppender"&gt;
        &lt;encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder"&gt;
            &lt;providers&gt;
                &lt;timestamp/&gt;
                &lt;version/&gt;
                &lt;logLevel/&gt;
                &lt;loggerName/&gt;
                &lt;message/&gt;
                &lt;mdc/&gt;
                &lt;stackTrace/&gt;
                &lt;pattern&gt;
                    &lt;pattern&gt;
                        {
                        "service": "camel-bnp-payments",
                        "version": "4.15.0",
                        "environment": "production",
                        "datacenter": "paris-1",
                        "team": "global-markets",
                        "component": "payment-engine"
                        }
                    &lt;/pattern&gt;
                &lt;/pattern&gt;
                &lt;context/&gt;
            &lt;/providers&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    
    &lt;appender name="LOGSTASH" class="net.logstash.logback.appender.LogstashTcpSocketAppender"&gt;
        &lt;destination&gt;logstash-bnp:5000&lt;/destination&gt;
        &lt;encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder"&gt;
            &lt;providers&gt;
                &lt;timestamp/&gt;
                &lt;logLevel/&gt;
                &lt;loggerName/&gt;
                &lt;message/&gt;
                &lt;mdc/&gt;
                &lt;stackTrace/&gt;
                &lt;context/&gt;
            &lt;/providers&gt;
        &lt;/encoder&gt;
        &lt;ssl/&gt;
    &lt;/appender&gt;
    
    &lt;!-- Loggers sp√©cifiques BNP --&gt;
    &lt;logger name="com.bnpparibas" level="DEBUG" additivity="false"&gt;
        &lt;appender-ref ref="JSON"/&gt;
        &lt;appender-ref ref="LOGSTASH"/&gt;
    &lt;/logger&gt;
    
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="JSON"/&gt;
        &lt;appender-ref ref="LOGSTASH"/&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Business Event Logging</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Business Event Logger BNP</span>
        <button class="copy-btn" data-clipboard-target="#observability-business-log"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-business-log"><code class="language-java">// üîπ Business Event Logger BNP
@Component
public class BNPBusinessLogger {
    
    private static final Logger logger = LoggerFactory.getLogger("BNP_BUSINESS");
    private static final Logger securityLogger = LoggerFactory.getLogger("BNP_SECURITY");
    
    public void logPaymentEvent(String paymentId, String status, 
                               BigDecimal amount, String currency, String customerId) {
        Map&lt;String, Object&gt; businessEvent = Map.of(
            "eventType", "PAYMENT_PROCESSED",
            "paymentId", paymentId,
            "status", status,
            "amount", amount,
            "currency", currency,
            "customerId", customerId,
            "timestamp", Instant.now().toString(),
            "service", "camel-payment-engine",
            "version", "4.15.0",
            "environment", "production"
        );
        
        logger.info("Business event: {}", businessEvent);
        
        // üîπ M√©trique business pour monitoring
        Metrics.counter("bnp.payments.processed", 
            "status", status,
            "currency", currency
        ).increment();
    }
}</code></pre>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üö® Syst√®me d'Alerte Intelligent BNP</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-bell"></i></div>
      <h3 style="color: var(--accent2);">Alerting Configuration</h3>
      <p style="color: var(--ink);">Configuration des alertes critiques pour la surveillance des transactions financi√®res.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Prometheus Alert Rules BNP</span>
        <button class="copy-btn" data-clipboard-target="#observability-alerts"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="observability-alerts"><code class="language-yaml"># üîπ Alert Rules BNP - Prometheus
groups:
  - name: bnp-payment-alerts
    rules:
      # üîπ Alertes de performance
      - alert: HighPaymentLatency
        expr: histogram_quantile(0.95, rate(bnp_payment_duration_seconds_bucket[5m])) > 0.5
        for: 2m
        labels:
          severity: warning
          team: payments
          priority: P1
        annotations:
          summary: "High payment latency detected"
          description: "Payment p95 latency is {{ $value }}s, threshold is 0.5s"
          runbook: "https://bnp.runbook.com/high-latency"</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('observability')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
    <button class="export-btn" onclick="shareSection('observability')">
      <i class="fas fa-share"></i> Partager
    </button>
  </div>
</section>

      <!-- Section 15: S√©curit√© BNP -->
      <section id="security">
        <div class="section-header">
          <h2><i class="fas fa-lock"></i>15) üîê S√©curit√© BNP</h2>
          <div class="section-tools">
            <span class="section-badge">Security</span>
            <div class="quick-actions">
              <a href="#observability" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#jvm" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Architecture de S√©curit√© BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-key"></i></div>
            <h3>Chiffrement BNP</h3>
            <p>Chiffrement AES-256-GCM avec rotation automatique des cl√©s et support HSM.</p>
            <div class="code-header">
              <span>Encryption Configuration</span>
              <button class="copy-btn" data-clipboard-target="#security-encryption"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-encryption"><code class="language-properties"># üîπ Encryption Configuration
camel.security.encryption.enabled=true
camel.security.encryption.algorithm=AES-256-GCM
camel.security.encryption.key-rotation.days=30
camel.security.encryption.key-version=1
camel.security.hsm.integration=true
camel.security.hsm.provider=bnp-hsm-provider
camel.security.hsm.key-alias=bnp-encryption-key

# üîπ Key Management
camel.security.key-management.enabled=true
camel.security.key-management.provider=aws-kms
camel.security.key-management.region=eu-west-3
camel.security.key-management.key-id=alias/bnp-encryption-key

# üîπ Secure Properties
camel.security.properties.enabled=true
camel.security.properties.provider=aws-secrets-manager
camel.security.properties.refresh-interval=300000</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-user-shield"></i></div>
            <h3>Authentification</h3>
            <p>mTLS obligatoire avec certificats X.509 et int√©gration LDAP BNP.</p>
            <div class="code-header">
              <span>mTLS Configuration</span>
              <button class="copy-btn" data-clipboard-target="#security-mtls"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-mtls"><code class="language-properties"># üîπ mTLS Configuration
camel.security.mtls.enabled=true
camel.security.mtls.verify-hostname=true
camel.security.mtls.trust-store=/security/truststore.jks
camel.security.mtls.trust-store-password=${truststore.password}
camel.security.mtls.key-store=/security/keystore.jks
camel.security.mtls.key-store-password=${keystore.password}
camel.security.mtls.key-password=${key.password}
camel.security.mtls.client-auth=REQUIRE

# üîπ Certificate Management
camel.security.certificate.rotation.enabled=true
camel.security.certificate.rotation.days-before-expiry=30
camel.security.certificate.auto-renewal=true
camel.security.certificate.provider=bnp-pki</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-id-card"></i></div>
            <h3>Autorisation</h3>
            <p>RBAC avanc√© avec politiques m√©tier BNP et audit complet.</p>
            <div class="code-header">
              <span>Authorization Configuration</span>
              <button class="copy-btn" data-clipboard-target="#security-authorization"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-authorization"><code class="language-java">// üîπ Custom Authorization Policy
@Component
public class BNPAuthorizationPolicy implements Policy {
    
    private final AuthorizationService authService;
    
    @Override
    public void beforeProcess(Exchange exchange, Processor processor, 
                             AsyncCallback callback) throws Exception {
        
        // V√©rification des autorisations
        String userId = exchange.getIn().getHeader("X-User-Id", String.class);
        String action = exchange.getIn().getHeader("X-Action", String.class);
        String resource = exchange.getIn().getHeader("X-Resource", String.class);
        
        if (!authService.isAuthorized(userId, action, resource)) {
            throw new SecurityException("User not authorized for this action");
        }
        
        // Continuer le traitement
        processor.process(exchange);
        callback.done(false);
    }
}

// üîπ Usage dans les routes
from("direct:secureOperation")
  .policy(new BNPAuthorizationPolicy())
  .process(new SecureProcessor())
  .to("direct:nextStep");</code></pre>
          </div>
        </div>

        <h3>Conformit√© et Audit</h3>
        <div class="grid two">
          <div>
            <h4>R√©glementations</h4>
            <ul>
              <li><strong>PSD2</strong> : Strong Customer Authentication</li>
              <li><strong>GDPR</strong> : Protection des donn√©es personnelles</li>
              <li><strong>SWIFT CSP</strong> : S√©curit√© des messages financiers</li>
              <li><strong>Basel III</strong> : Gestion des risques</li>
              <li><strong>SOX</strong> : Contr√¥les internes</li>
              <li><strong>PCI DSS</strong> : S√©curit√© des paiements</li>
            </ul>
          </div>
          <div>
            <h4>Audit Trail</h4>
            <div class="code-header">
              <span>Audit Configuration</span>
              <button class="copy-btn" data-clipboard-target="#security-audit"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-audit"><code class="language-java">// üîπ Audit Trail Service
@Component
public class BNPAuditService {
    
    public void auditOperation(String operation, String userId, 
                              Map<String, Object> details) {
        AuditEvent event = AuditEvent.builder()
            .timestamp(Instant.now())
            .operation(operation)
            .userId(userId)
            .details(details)
            .serviceName("camel-bnp")
            .environment("production")
            .build();
            
        // Enregistrement dans la base d'audit
        auditRepository.save(event);
        
        // Log pour SIEM
        logger.info("Audit event: {}", event);
    }
}

// üîπ Interceptor d'audit
@Component
public class BNPAuditInterceptor implements Interceptor {
    
    private final BNPAuditService auditService;
    
    @Override
    public void beforeRoute(Route route, Exchange exchange) {
        Map<String, Object> auditDetails = Map.of(
            "routeId", route.getId(),
            "messageId", exchange.getIn().getMessageId(),
            "headers", exchange.getIn().getHeaders(),
            "bodySize", exchange.getIn().getBody() != null ? 
                        exchange.getIn().getBody().toString().length() : 0
        );
        
        auditService.auditOperation(
            "ROUTE_START", 
            getUserId(exchange), 
            auditDetails
        );
    }
}</code></pre>
          </div>
        </div>

        <h3>S√©curit√© des Donn√©es</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-mask"></i></div>
            <h3>Data Masking</h3>
            <p>Masquage des donn√©es sensibles dans les logs et m√©triques.</p>
            <div class="code-header">
              <span>Data Masking Configuration</span>
              <button class="copy-btn" data-clipboard-target="#security-masking"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-masking"><code class="language-java">// üîπ Data Masking Processor
@Component
public class BNPDataMaskingProcessor implements Processor {
    
    private final List<Pattern> sensitivePatterns = Arrays.asList(
        Pattern.compile("\\b[0-9]{16}\\b"), // Cartes de cr√©dit
        Pattern.compile("\\b[A-Z]{2}[0-9]{2}[A-Z0-9]{11,30}\\b"), // IBAN
        Pattern.compile("\\b[0-9]{3}-[0-9]{2}-[0-9]{4}\\b") // SSN
    );
    
    @Override
    public void process(Exchange exchange) throws Exception {
        String body = exchange.getIn().getBody(String.class);
        String maskedBody = maskSensitiveData(body);
        exchange.getIn().setBody(maskedBody);
    }
    
    private String maskSensitiveData(String input) {
        if (input == null) return null;
        
        String masked = input;
        for (Pattern pattern : sensitivePatterns) {
            masked = pattern.matcher(masked).replaceAll("***MASKED***");
        }
        return masked;
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
            <h3>Vulnerability Management</h3>
            <p>Gestion des vuln√©rabilit√©s et scanning de s√©curit√©.</p>
            <div class="code-header">
              <span>Security Scanning</span>
              <button class="copy-btn" data-clipboard-target="#security-scanning"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="security-scanning"><code class="language-yaml"># üîπ Security Scanning Configuration
security:
  scanning:
    enabled: true
    schedule: "0 2 * * *" # Daily at 2 AM
    tools:
      - name: "OWASP Dependency Check"
        enabled: true
        config:
          failOnCVSS: 7.0
          suppressionFile: "/security/suppressions.xml"
      
      - name: "SonarQube"
        enabled: true
        config:
          qualityGate: "BNP Security Gate"
          exclusions: "**/test/**,**/generated/**"
      
      - name: "Container Security"
        enabled: true
        config:
          scanner: "Trivy"
          severity: "HIGH,CRITICAL"</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('security')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Les sections 16-23 suivent le m√™me pattern -->
      <!-- Section 16: JVM & GC -->
      <section id="jvm">
        <div class="section-header">
          <h2><i class="fas fa-microchip"></i>16) üñ•Ô∏è JVM & GC</h2>
          <div class="section-tools">
            <span class="section-badge">JVM</span>
            <div class="quick-actions">
              <a href="#security" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#testing" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Configuration JVM BNP</h3>
        <div class="grid two">
          <div>
            <h4>JVM Options Optimis√©s</h4>
            <div class="code-header">
              <span>JVM Configuration</span>
              <button class="copy-btn" data-clipboard-target="#jvm-config"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jvm-config"><code class="language-bash"># üîπ Memory Configuration
-Xmx8g -Xms8g
-XX:MaxMetaspaceSize=512m
-XX:MetaspaceSize=256m
-XX:MaxDirectMemorySize=2g
-XX:ReservedCodeCacheSize=512m
-XX:InitialCodeCacheSize=256m

# üîπ Garbage Collection - ZGC
-XX:+UseZGC
-XX:+ZGenerational
-XX:ZAllocationSpikeTolerance=4
-XX:ZCollectionInterval=300
-XX:ZProactive=true

# üîπ Performance Optimization
-XX:+UseCompressedOops
-XX:+UseCompressedClassPointers
-XX:+UseStringDeduplication
-XX:+UseContainerSupport
-XX:MaxGCPauseMillis=200
-XX:ParallelGCThreads=8
-XX:ConcGCThreads=8

# üîπ Monitoring & Debugging
-XX:+FlightRecorder
-XX:StartFlightRecording=disk=true,maxsize=1g
-XX:+UnlockDiagnosticVMOptions
-XX:+PrintGCDetails
-XX:+PrintGCDateStamps
-Xlog:gc*,gc+age=trace:file=/logs/gc.log</code></pre>
          </div>
          <div>
            <h4>JVM Performance Metrics</h4>
            <div class="kpi">
              <div class="card">
                <div class="label">GC Pause Time</div>
                <div class="val">&lt; 10ms</div>
              </div>
              <div class="card">
                <div class="label">Memory Usage</div>
                <div class="val">&lt; 80%</div>
              </div>
              <div class="card">
                <div class="label">CPU Usage</div>
                <div class="val">&lt; 70%</div>
              </div>
              <div class="card">
                <div class="label">Thread Count</div>
                <div class="val">&lt; 1000</div>
              </div>
            </div>

            <h4>Garbage Collection Strategy</h4>
            <ul>
              <li><strong>ZGC</strong> pour les pauses GC minimales</li>
              <li><strong>Generational</strong> pour une meilleure performance</li>
              <li><strong>Proactive GC</strong> pour √©viter les pics</li>
              <li><strong>Monitoring</strong> en temps r√©el</li>
              <li><strong>Auto-tuning</strong> bas√© sur la charge</li>
            </ul>
          </div>
        </div>

        <h3>Monitoring JVM Avanc√©</h3>
        <div class="code-header">
          <span>JVM Monitoring Configuration</span>
          <button class="copy-btn" data-clipboard-target="#jvm-monitoring"><i class="fas fa-copy"></i> Copier</button>
        </div>
        <pre id="jvm-monitoring"><code class="language-java">// üîπ JVM Metrics Collector
@Component
public class BNPJVMMonitor {
    
    private final MeterRegistry meterRegistry;
    
    @Scheduled(fixedRate = 10000) // Toutes les 10 secondes
    public void collectJVMMetrics() {
        // Memory Usage
        MemoryMXBean memoryBean = ManagementFactory.getMemoryMXBean();
        MemoryUsage heapUsage = memoryBean.getHeapMemoryUsage();
        MemoryUsage nonHeapUsage = memoryBean.getNonHeapMemoryUsage();
        
        Gauge.builder("jvm.memory.heap.used")
            .description("Heap memory used")
            .register(meterRegistry, heapUsage.getUsed());
            
        Gauge.builder("jvm.memory.heap.max")
            .description("Heap memory max")
            .register(meterRegistry, heapUsage.getMax());
        
        // GC Statistics
        List<GarbageCollectorMXBean> gcBeans = ManagementFactory.getGarbageCollectorMXBeans();
        for (GarbageCollectorMXBean gcBean : gcBeans) {
            Counter.builder("jvm.gc.collection.count")
                .tag("gc", gcBean.getName())
                .register(meterRegistry, gcBean.getCollectionCount());
                
            Counter.builder("jvm.gc.collection.time")
                .tag("gc", gcBean.getName())
                .register(meterRegistry, gcBean.getCollectionTime());
        }
        
        // Thread Statistics
        ThreadMXBean threadBean = ManagementFactory.getThreadMXBean();
        Gauge.builder("jvm.threads.live")
            .description("Live threads")
            .register(meterRegistry, threadBean.getThreadCount());
            
        Gauge.builder("jvm.threads.daemon")
            .description("Daemon threads")
            .register(meterRegistry, threadBean.getDaemonThreadCount());
    }
}</code></pre>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('jvm')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

       <!-- Section 17: Tests & Validation (suite) -->
      <section id="testing">
        <div class="section-header">
          <h2><i class="fas fa-vial"></i>17) üß™ Tests & Validation</h2>
          <div class="section-tools">
            <span class="section-badge">Testing</span>
            <div class="quick-actions">
              <a href="#jvm" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#checklist" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Strat√©gie de Testing BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-flask"></i></div>
            <h3>Tests Unitaires</h3>
            <p>Tests unitaires avec couverture de code et validation des composants m√©tier.</p>
            <div class="code-header">
              <span>Unit Test Example</span>
              <button class="copy-btn" data-clipboard-target="#test-unit"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="test-unit"><code class="language-java">// üîπ Test unitaire pour processeur m√©tier
@ExtendWith(MockitoExtension.class)
class PaymentProcessorTest {
    
    @Mock
    private AccountService accountService;
    
    @InjectMocks
    private PaymentProcessor paymentProcessor;
    
    @Test
    void shouldProcessValidPayment() {
        // Given
        Exchange exchange = createTestExchange();
        Payment payment = createValidPayment();
        exchange.getIn().setBody(payment);
        
        when(accountService.validateAccount(anyString())).thenReturn(true);
        when(accountService.hasSufficientFunds(any(), any())).thenReturn(true);
        
        // When
        paymentProcessor.process(exchange);
        
        // Then
        assertThat(exchange.getIn().getHeader("paymentStatus")).isEqualTo("APPROVED");
        verify(accountService).debitAccount(anyString(), any(BigDecimal.class));
    }
    
    @Test
    void shouldRejectInsufficientFunds() {
        // Given
        Exchange exchange = createTestExchange();
        Payment payment = createValidPayment();
        exchange.getIn().setBody(payment);
        
        when(accountService.validateAccount(anyString())).thenReturn(true);
        when(accountService.hasSufficientFunds(any(), any())).thenReturn(false);
        
        // When
        paymentProcessor.process(exchange);
        
        // Then
        assertThat(exchange.getIn().getHeader("paymentStatus")).isEqualTo("REJECTED");
        assertThat(exchange.getIn().getHeader("rejectionReason")).isEqualTo("INSUFFICIENT_FUNDS");
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-sync-alt"></i></div>
            <h3>Tests d'Int√©gration Camel</h3>
            <p>Tests complets des routes Camel avec contextes de test d√©di√©s.</p>
            <div class="code-header">
              <span>Integration Test Example</span>
              <button class="copy-btn" data-clipboard-target="#test-integration"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="test-integration"><code class="language-java">// üîπ Test d'int√©gration de route
@CamelSpringBootTest
@SpringBootTest
@MockEndpoints("direct:result")
class SwiftProcessingRouteTest {
    
    @Autowired
    private ProducerTemplate producerTemplate;
    
    @EndpointInject("mock:direct:result")
    private MockEndpoint mockResult;
    
    @Test
    void shouldProcessSwiftMessage() throws Exception {
        // Given
        String swiftMessage = createSwiftMT103();
        mockResult.expectedMessageCount(1);
        mockResult.expectedHeaderReceived("messageType", "SWIFT");
        
        // When
        producerTemplate.sendBody("direct:swiftIn", swiftMessage);
        
        // Then
        mockResult.assertIsSatisfied();
        
        Exchange receivedExchange = mockResult.getReceivedExchanges().get(0);
        assertThat(receivedExchange.getIn().getBody(Payment.class))
            .isNotNull()
            .hasFieldOrPropertyWithValue("amount", new BigDecimal("1000.00"));
    }
    
    @Test
    void shouldHandleInvalidSwiftFormat() throws Exception {
        // Given
        String invalidSwift = "INVALID_SWIFT_CONTENT";
        mockResult.expectedMessageCount(0);
        
        // When & Then
        assertThatThrownBy(() -> 
            producerTemplate.sendBody("direct:swiftIn", invalidSwift)
        ).isInstanceOf(CamelExecutionException.class);
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
            <h3>Tests de Performance</h3>
            <p>Tests de charge et performance avec m√©triques d√©taill√©es.</p>
            <div class="code-header">
              <span>Performance Test Example</span>
              <button class="copy-btn" data-clipboard-target="#test-performance"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="test-performance"><code class="language-java">// üîπ Test de performance avec JMeter
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {
    "spring.profiles.active=test",
    "camel.springboot.main-run-controller=false"
})
class PerformanceTest {
    
    @Autowired
    private TestRestTemplate restTemplate;
    
    @Test
    void shouldHandleHighLoad() {
        // Given
        int numberOfRequests = 10000;
        List<Payment> payments = generateTestPayments(numberOfRequests);
        
        // When
        List<CompletableFuture<ResponseEntity<String>>> futures = payments.stream()
            .map(payment -> CompletableFuture.supplyAsync(() ->
                restTemplate.postForEntity("/api/payments", payment, String.class)
            ))
            .collect(Collectors.toList());
        
        // Then
        List<ResponseEntity<String>> responses = futures.stream()
            .map(CompletableFuture::join)
            .collect(Collectors.toList());
        
        long successCount = responses.stream()
            .filter(response -> response.getStatusCode().is2xxSuccessful())
            .count();
            
        assertThat(successCount).isGreaterThan(9500); // 95% success rate
        
        // Performance assertions
        assertThat(getAverageResponseTime()).isLessThan(100); // < 100ms average
        assertThat(getP95ResponseTime()).isLessThan(200);     // < 200ms p95
    }
    
    @Test
    void shouldMaintainPerformanceUnderLoad() throws Exception {
        // Given
        GatlingEngine gatling = new GatlingEngine();
        
        // When
        SimulationResult result = gatling.runSimulation(
            "BNP Performance Test",
            scenario()
                .exec(http("Process Payment")
                    .post("/api/payments")
                    .body(StringBody("${payment}"))
                    .check(status().is(200)))
                .inject(
                    rampUsersPerSec(10).to(1000).during(300), // Ramp up to 1000 TPS
                    constantUsersPerSec(1000).during(600)     // Sustain 1000 TPS
                )
        );
        
        // Then
        assertThat(result.responseTime().percentile95()).isLessThan(150);
        assertThat(result.requestCount().failed()).isLessThan(100);
        assertThat(result.throughput()).isGreaterThan(950);
    }
}</code></pre>
          </div>
        </div>

        <h3>Validation des Donn√©es M√©tier</h3>
        <div class="grid two">
          <div>
            <h4>Schema Validation</h4>
            <div class="code-header">
              <span>Data Validation Configuration</span>
              <button class="copy-btn" data-clipboard-target="#test-validation"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="test-validation"><code class="language-java">// üîπ Validation avec JSON Schema
@Component
public class PaymentValidator implements Processor {
    
    private final JsonSchemaFactory schemaFactory = JsonSchemaFactory.getInstance(SpecVersion.VersionFlag.V7);
    private final JsonSchema paymentSchema;
    
    public PaymentValidator() throws Exception {
        URL schemaUrl = getClass().getResource("/schemas/payment-schema.json");
        this.paymentSchema = schemaFactory.getSchema(schemaUrl);
    }
    
    @Override
    public void process(Exchange exchange) throws Exception {
        String paymentJson = exchange.getIn().getBody(String.class);
        JsonNode paymentNode = JsonLoader.fromString(paymentJson);
        
        Set<ValidationMessage> validationMessages = paymentSchema.validate(paymentNode);
        
        if (!validationMessages.isEmpty()) {
            throw new ValidationException("Payment validation failed", validationMessages);
        }
    }
}

// üîπ Usage dans les routes
from("direct:validatePayment")
  .process(new PaymentValidator())
  .to("direct:processValidPayment")
  .onException(ValidationException.class)
    .handled(true)
    .setHeader(Exchange.HTTP_RESPONSE_CODE, constant(400))
    .setBody(simple("Validation failed: ${exception.message}"))
    .to("direct:validationErrors")
  .end();</code></pre>
          </div>
          <div>
            <h4>Business Rule Validation</h4>
            <div class="code-header">
              <span>Business Rules Engine</span>
              <button class="copy-btn" data-clipboard-target="#test-business-rules"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="test-business-rules"><code class="language-java">// üîπ Business Rules Engine Integration
@Component
public class BusinessRulesValidator {
    
    private final KieContainer kieContainer;
    
    public ValidationResult validatePayment(Payment payment) {
        KieSession kieSession = kieContainer.newKieSession();
        
        try {
            // Facts pour les r√®gles m√©tier
            kieSession.insert(payment);
            kieSession.insert(new ValidationContext());
            
            // Ex√©cution des r√®gles
            kieSession.fireAllRules();
            
            // Collecte des r√©sultats
            return collectValidationResults(kieSession);
        } finally {
            kieSession.dispose();
        }
    }
    
    // üîπ R√®gles m√©tier Drools
    rule "Large Payment Approval"
        when
            $p : Payment(amount > 50000)
            $context : ValidationContext()
        then
            $context.requireManualApproval(true);
            $context.addValidationMessage("Large payment requires manual approval");
    end
    
    rule "Suspicious Transaction"
        when
            $p : Payment(amount > 100000, country != "FR")
            $context : ValidationContext()
        then
            $context.setSuspicious(true);
            $context.addValidationMessage("Suspicious cross-border large payment");
    end</code></pre>
          </div>
        </div>

        <h3>Testing Strategy BNP</h3>
        <table class="strategy-table">
          <thead>
            <tr>
              <th>Type de Test</th>
              <th>Couverture</th>
              <th>Fr√©quence</th>
              <th>Environnement</th>
              <th>Outils</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Unit Tests</strong></td>
              <td>> 80%</td>
              <td>√Ä chaque commit</td>
              <td>Local/CI</td>
              <td>JUnit, Mockito</td>
            </tr>
            <tr>
              <td><strong>Integration Tests</strong></td>
              <td>100% routes</td>
              <td>Daily</td>
              <td>Test Environment</td>
              <td>SpringBootTest, CamelTest</td>
            </tr>
            <tr>
              <td><strong>Performance Tests</strong></td>
              <td>Scenarios critiques</td>
              <td>Weekly</td>
              <td>Performance Env</td>
              <td>Gatling, JMeter</td>
            </tr>
            <tr>
              <td><strong>Security Tests</strong></td>
              <td>100% endpoints</td>
              <td>Monthly</td>
              <td>Security Env</td>
              <td>OWASP, SonarQube</td>
            </tr>
            <tr>
              <td><strong>End-to-End Tests</strong></td>
              <td>Flux m√©tier</td>
              <td>Release</td>
              <td>Staging</td>
              <td>Cucumber, Selenium</td>
            </tr>
          </tbody>
        </table>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('testing')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 18: Checklist Production -->
      <section id="checklist">
        <div class="section-header">
          <h2><i class="fas fa-check-circle"></i>18) ‚úÖ Checklist Production</h2>
          <div class="section-tools">
            <span class="section-badge">Checklist</span>
            <div class="quick-actions">
              <a href="#testing" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#examples" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Checklist D√©ploiement Production</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-cogs"></i></div>
            <h3>Configuration</h3>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="config1">
                <label for="config1">Configuration Spring Boot valid√©e</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="config2">
                <label for="config2">Variables d'environnement configur√©es</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="config3">
                <label for="config3">Secrets manag√©s avec Vault/AWS Secrets</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="config4">
                <label for="config4">Logging configur√© (JSON format)</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="config5">
                <label for="config5">M√©triques Micrometer configur√©es</label>
              </div>
            </div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
            <h3>S√©curit√©</h3>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="sec1">
                <label for="sec1">mTLS configur√© pour toutes les communications</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="sec2">
                <label for="sec2">Certificats valides et √† jour</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="sec3">
                <label for="sec3">RBAC configur√© selon politique BNP</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="sec4">
                <label for="sec4">Audit trail activ√© et test√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="sec5">
                <label for="sec5">Scan de s√©curit√© pass√© (OWASP, Snyk)</label>
              </div>
            </div>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
            <h3>Performance</h3>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="perf1">
                <label for="perf1">Tests de charge valid√©s (‚â• 2000 TPS)</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="perf2">
                <label for="perf2">Latence p95 &lt; 50ms v√©rifi√©e</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="perf3">
                <label for="perf3">Memory leaks check (24h soak test)</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="perf4">
                <label for="perf4">GC tuning valid√© (ZGC configur√©)</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="perf5">
                <label for="perf5">Auto-scaling configur√© et test√©</label>
              </div>
            </div>
          </div>
        </div>

        <h3>Checklist Monitoring & Observability</h3>
        <div class="grid two">
          <div>
            <h4>Monitoring Configuration</h4>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="mon1">
                <label for="mon1">Prometheus metrics expos√©es</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="mon2">
                <label for="mon2">Grafana dashboards configur√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="mon3">
                <label for="mon3">Alerting rules d√©finies (PagerDuty)</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="mon4">
                <label for="mon4">Distributed tracing activ√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="mon5">
                <label for="mon5">Log aggregation configur√© (ELK)</label>
              </div>
            </div>
          </div>
          <div>
            <h4>Business Metrics</h4>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="biz1">
                <label for="biz1">KPI m√©tier d√©finis et mesur√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="biz2">
                <label for="biz2">SLAs/SLOs document√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="biz3">
                <label for="biz3">Circuit breakers monitor√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="biz4">
                <label for="biz4">Dead letter queues surveill√©es</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="biz5">
                <label for="biz5">Business continuity test√©</label>
              </div>
            </div>
          </div>
        </div>

        <h3>Checklist R√©silience & HA</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>High Availability</h4>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="ha1">
                <label for="ha1">Multi-AZ deployment configur√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="ha2">
                <label for="ha2">Load balancer configur√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="ha3">
                <label for="ha3">Health checks impl√©ment√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="ha4">
                <label for="ha4">Graceful shutdown test√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="ha5">
                <label for="ha5">Disaster recovery plan valid√©</label>
              </div>
            </div>
          </div>
          
          <div class="feature-card">
            <h4>Resilience Patterns</h4>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="res1">
                <label for="res1">Circuit breakers configur√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="res2">
                <label for="res2">Retry strategies impl√©ment√©es</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="res3">
                <label for="res3">Fallback mechanisms test√©s</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="res4">
                <label for="res4">Bulkhead isolation configur√©e</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="res5">
                <label for="res5">Timeout management valid√©</label>
              </div>
            </div>
          </div>
          
          <div class="feature-card">
            <h4>Data Management</h4>
            <div class="checklist-items">
              <div class="checklist-item">
                <input type="checkbox" id="data1">
                <label for="data1">Backup strategy d√©finie</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="data2">
                <label for="data2">Data encryption activ√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="data3">
                <label for="data3">PII masking impl√©ment√©</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="data4">
                <label for="data4">Data retention policy appliqu√©e</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="data5">
                <label for="data5">GDPR compliance v√©rifi√©e</label>
              </div>
            </div>
          </div>
        </div>

        <style>
          .checklist-items {
            margin-top: 15px;
          }
          
          .checklist-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 12px;
            background: var(--panel);
            border-radius: 8px;
            border: 1px solid var(--border);
            transition: var(--transition);
          }
          
          .checklist-item:hover {
            background: var(--panel2);
            transform: translateX(5px);
          }
          
          .checklist-item input[type="checkbox"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            accent-color: var(--bnp-secondary);
          }
          
          .checklist-item label {
            flex: 1;
            font-size: 14px;
            color: var(--ink);
            cursor: pointer;
          }
        </style>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('checklist')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
          <button class="export-btn" onclick="checkAllChecklists()">
            <i class="fas fa-check-double"></i> Tout cocher
          </button>
          <button class="export-btn" onclick="uncheckAllChecklists()">
            <i class="fas fa-undo"></i> Tout d√©cocher
          </button>
        </div>
      </section>

      <!-- Section 19: Exemples BNP -->
      <section id="examples">
        <div class="section-header">
          <h2><i class="fas fa-code"></i>19) üíª Exemples BNP</h2>
          <div class="section-tools">
            <span class="section-badge">Examples</span>
            <div class="quick-actions">
              <a href="#checklist" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#jdbc-performance" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Exemples de Routes M√©tier BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-exchange-alt"></i></div>
            <h3>SWIFT Message Processing</h3>
            <p>Route compl√®te pour le traitement des messages SWIFT avec validation et transformation.</p>
            <div class="code-header">
              <span>SWIFT Route Example</span>
              <button class="copy-btn" data-clipboard-target="#example-swift"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="example-swift"><code class="language-java">// üîπ Route de traitement SWIFT compl√®te
@Component
public class SwiftProcessingRoute extends RouteBuilder {
    
    @Override
    public void configure() throws Exception {
        // üîπ Route principale SWIFT
        from("ibm-mq:queue:BNP.SWIFT.IN?concurrentConsumers=5")
          .routeId("swift-inbound-processor")
          .routeDescription("Process incoming SWIFT messages")
          .streamCaching()
          
          // üîπ Validation et parsing
          .process(new SwiftMessageValidator())
          .doTry()
            .unmarshal().swift()
            .process(new SwiftToInternalTransformer())
          .doCatch(SwiftValidationException.class)
            .log(LoggingLevel.ERROR, "SWIFT validation failed: ${exception.message}")
            .to("ibm-mq:queue:BNP.SWIFT.ERROR")
            .handled(true)
          .end()
          
          // üîπ Routing bas√© sur le type de message
          .choice()
            .when(header("SWIFT_MT").isEqualTo("103"))
              .to("direct:payment-processing")
            .when(header("SWIFT_MT").isEqualTo("202"))
              .to("direct:bank-transfer")
            .when(header("SWIFT_MT").isEqualTo("900"))
              .to("direct:confirmation")
            .when(header("SWIFT_MT").isEqualTo("910"))
              .to("direct:advice")
            .otherwise()
              .log(LoggingLevel.WARN, "Unknown SWIFT type: ${header.SWIFT_MT}")
              .to("direct:unknown-swift-type")
          .end()
          
          // üîπ Gestion d'erreurs
          .onException(Exception.class)
            .maximumRedeliveries(3)
            .redeliveryDelay(5000)
            .useExponentialBackOff()
            .retryAttemptedLogLevel(LoggingLevel.WARN)
            .handled(true)
            .to("ibm-mq:queue:BNP.SWIFT.DLQ")
            .log(LoggingLevel.ERROR, "SWIFT processing failed: ${exception.message}")
          .end();
        
        // üîπ Sous-route pour paiements
        from("direct:payment-processing")
          .routeId("swift-payment-processor")
          .process(new PaymentEnricher())
          .to("bean:complianceService?method=validateAML")
          .choice()
            .when(header("AML_STATUS").isEqualTo("APPROVED"))
              .to("direct:execute-payment")
            .when(header("AML_STATUS").isEqualTo("REVIEW"))
              .to("direct:manual-review")
            .otherwise()
              .to("direct:reject-payment")
          .end()
          .log("SWIFT payment processed: ${header.SWIFT_UUID}");
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-euro-sign"></i></div>
            <h3>SEPA Payment Processing</h3>
            <p>Route pour le traitement des paiements SEPA avec gestion de batch et validation.</p>
            <div class="code-header">
              <span>SEPA Route Example</span>
              <button class="copy-btn" data-clipboard-target="#example-sepa"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="example-sepa"><code class="language-java">// üîπ Route de traitement SEPA
@Component  
public class SEPAPaymentRoute extends RouteBuilder {
    
    @Override
    public void configure() throws Exception {
        // üîπ R√©ception des fichiers SEPA
        from("file:/inbound/sepa?include=.*\\.xml&moveFailed=.error")
          .routeId("sepa-file-consumer")
          .routeDescription("Process SEPA payment files")
          .autoStartup(true)
          
          // üîπ Validation du fichier
          .process(new SEPAFileValidator())
          .log("Processing SEPA file: ${header.CamelFileName}")
          
          // üîπ D√©marshalling et split des paiements
          .unmarshal().jaxb("org.bnpparibas.sepa")
          .split().body()
            .parallelProcessing()
            .threads(10, 20)
            .stopOnException()
            
            // üîπ Traitement individuel des paiements
            .process(new SEPAPaymentValidator())
            .choice()
              .when(header("VALID").isEqualTo(true))
                .to("direct:process-sepa-payment")
              .otherwise()
                .log("Invalid SEPA payment: ${body.paymentId}")
                .to("direct:rejected-payments")
            .end()
          .end()
          
          // üîπ Agr√©gation des r√©sultats
          .process(new SEPAFileResultAggregator())
          .log("SEPA file processing completed: ${header.CamelFileName}")
          .to("file:/processed/sepa?fileExist=Append");
        
        // üîπ Traitement des paiements SEPA individuels
        from("direct:process-sepa-payment")
          .routeId("sepa-payment-executor")
          .circuitBreaker()
            .resilience4jConfiguration()
              .failureRateThreshold(50)
              .waitDurationInOpenState(10000)
            .end()
            .to("direct:core-banking-debit")
          .onFallback()
            .to("direct:sepa-fallback")
          .end()
          
          // üîπ Mise √† jour du statut
          .setHeader("PAYMENT_STATUS", constant("PROCESSED"))
          .to("sql:UPDATE payments SET status = :#PAYMENT_STATUS WHERE id = :#${body.paymentId}")
          .log("SEPA payment processed: ${body.paymentId}");
    }
}</code></pre>
          </div>
        </div>

        <h3>Exemples Avanc√©s BNP</h3>
        <div class="grid two">
          <div>
            <h4>Real-time Fraud Detection</h4>
            <div class="code-header">
              <span>Fraud Detection Route</span>
              <button class="copy-btn" data-clipboard-target="#example-fraud"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="example-fraud"><code class="language-java">// üîπ D√©tection de fraude en temps r√©el
@Component
public class FraudDetectionRoute extends RouteBuilder {
    
    @Override
    public void configure() throws Exception {
        from("direct:real-time-payments")
          .routeId("fraud-detection-engine")
          .routeDescription("Real-time fraud detection for payments")
          
          // üîπ Analyse comportementale
          .enrich("direct:customer-behavior", new CustomerBehaviorEnricher())
          .enrich("direct:transaction-patterns", new TransactionPatternEnricher())
          
          // üîπ Scoring de risque
          .process(new FraudRiskScorer())
          .choice()
            .when(header("FRAUD_RISK_SCORE").isGreaterThan(80))
              .log("HIGH fraud risk detected: ${body.paymentId}")
              .to("direct:block-payment")
              .to("direct:alert-security-team")
            .when(header("FRAUD_RISK_SCORE").isGreaterThan(60))
              .log("MEDIUM fraud risk detected: ${body.paymentId}")
              .to("direct:manual-review")
            .otherwise()
              .log("LOW fraud risk: ${body.paymentId}")
              .to("direct:approve-payment")
          .end()
          
          // üîπ Machine Learning Integration
          .process(new MLFraudPredictor())
          .filter(header("ML_FRAUD_FLAG").isEqualTo(true))
            .log("ML model flagged as fraud: ${body.paymentId}")
            .to("direct:ml-fraud-review")
          .end();
        
        // üîπ Customer Behavior Analysis
        from("direct:customer-behavior")
          .routeId("customer-behavior-analyzer")
          .process(exchange -> {
              Payment payment = exchange.getIn().getBody(Payment.class);
              CustomerBehavior behavior = behaviorService.analyzeBehavior(
                  payment.getCustomerId(), 
                  payment.getAmount(), 
                  payment.getBeneficiary()
              );
              exchange.getIn().setHeader("CUSTOMER_BEHAVIOR", behavior);
          });
    }
}</code></pre>
          </div>
          <div>
            <h4>Batch Reporting</h4>
            <div class="code-header">
              <span>Batch Reporting Route</span>
              <button class="copy-btn" data-clipboard-target="#example-batch"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="example-batch"><code class="language-java">// üîπ G√©n√©ration de rapports batch
@Component
public class BatchReportingRoute extends RouteBuilder {
    
    @Override
    public void configure() throws Exception {
        // üîπ Rapport quotidien des transactions
        from("quartz://reporting/daily?cron=0+0+22+*+*+?") // Daily at 10 PM
          .routeId("daily-reporting")
          .routeDescription("Generate daily transaction reports")
          .autoStartup(true)
          
          // üîπ Extraction des donn√©es
          .setBody(constant("SELECT * FROM transactions WHERE transaction_date = CURRENT_DATE"))
          .to("jdbc:dataSource")
          .split(body()).streaming()
            .parallelProcessing()
            .aggregate(constant(true), new ReportAggregationStrategy())
              .completionInterval(5000)
              .completionTimeout(30000)
            .end()
          
          // üîπ G√©n√©ration du rapport
          .process(new DailyReportGenerator())
          .marshal().csv()
          .setHeader(Exchange.FILE_NAME, constant("daily-report-${date:now:yyyyMMdd}.csv"))
          .to("file:/reports/daily")
          
          // üîπ Notification
          .process(new ReportNotifier())
          .log("Daily report generated successfully");
        
        // üîπ Rapport de conformit√© r√©glementaire
        from("quartz://reporting/compliance?cron=0+0+6+*+MON+?") // Every Monday at 6 AM
          .routeId("compliance-reporting")
          .routeDescription("Generate regulatory compliance reports")
          
          // üîπ Extraction des donn√©es de conformit√©
          .to("direct:extract-compliance-data")
          .process(new ComplianceReportGenerator())
          .choice()
            .when(header("REPORT_TYPE").isEqualTo("PSD2"))
              .to("direct:generate-psd2-report")
            .when(header("REPORT_TYPE").isEqualTo("AML"))
              .to("direct:generate-aml-report")
            .when(header("REPORT_TYPE").isEqualTo("BASEL"))
              .to("direct:generate-basel-report")
          .end()
          
          // üîπ Archivage et notification
          .to("direct:archive-report")
          .to("direct:notify-regulators")
          .log("Compliance report generated and submitted");
    }
}</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('examples')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 20: Performance JDBC -->
      <section id="jdbc-performance">
        <div class="section-header">
          <h2><i class="fas fa-database"></i>20) üóÑÔ∏è Performance JDBC</h2>
          <div class="section-tools">
            <span class="section-badge">Database</span>
            <div class="quick-actions">
              <a href="#examples" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#jms-performance" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Optimisation des Acc√®s Base de Donn√©es</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
            <h3>Connection Pooling</h3>
            <p>Configuration avanc√©e du pool de connexions HikariCP pour haute performance.</p>
            <div class="code-header">
              <span>HikariCP Configuration</span>
              <button class="copy-btn" data-clipboard-target="#jdbc-pool"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jdbc-pool"><code class="language-properties"># üîπ HikariCP Connection Pool Configuration
spring.datasource.hikari.pool-name=BNP-HikariPool
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.connection-test-query=SELECT 1 FROM DUAL
spring.datasource.hikari.validation-timeout=5000

# üîπ Performance Optimizations
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.read-only=false
spring.datasource.hikari.isolate-internal-queries=false
spring.datasource.hikari.allow-pool-suspension=false
spring.datasource.hikari.initialization-fail-timeout=1

# üîπ Monitoring
spring.datasource.hikari.register-mbeans=true
management.health.db.enabled=true
management.endpoint.hikaricp.enabled=true</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-bolt"></i></div>
            <h3>Batch Processing</h3>
            <p>Traitement par lots optimis√© pour les op√©rations massives.</p>
            <div class="code-header">
              <span>Batch JDBC Operations</span>
              <button class="copy-btn" data-clipboard-target="#jdbc-batch"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jdbc-batch"><code class="language-java">// üîπ Batch Processing avec Camel JDBC
from("direct:batch-payments")
  .routeId("jdbc-batch-processor")
  .split(body()) // Split des paiements individuels
    .aggregate(constant(true), new BatchAggregationStrategy())
      .completionSize(1000) // Lots de 1000 paiements
      .completionTimeout(5000)
    .end()
    .process(exchange -> {
        List<Payment> batch = exchange.getIn().getBody(List.class);
        
        // Pr√©paration du batch SQL
        String sql = "INSERT INTO payments (id, amount, currency, status) VALUES (?, ?, ?, ?)";
        BatchPreparedStatementSetter setter = new BatchPreparedStatementSetter() {
            public void setValues(PreparedStatement ps, int i) throws SQLException {
                Payment payment = batch.get(i);
                ps.setString(1, payment.getId());
                ps.setBigDecimal(2, payment.getAmount());
                ps.setString(3, payment.getCurrency());
                ps.setString(4, payment.getStatus());
            }
            public int getBatchSize() {
                return batch.size();
            }
        };
        
        exchange.getIn().setHeader("batchSql", sql);
        exchange.getIn().setHeader("batchSetter", setter);
    })
    .to("jdbc:dataSource?useHeadersAsParameters=true&batch=true")
    .log("Processed batch of ${body.size} payments");</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-search"></i></div>
            <h3>Query Optimization</h3>
            <p>Optimisation des requ√™tes SQL avec indexing et plan d'ex√©cution.</p>
            <div class="code-header">
              <span>Optimized Queries</span>
              <button class="copy-btn" data-clipboard-target="#jdbc-queries"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jdbc-queries"><code class="language-sql">-- üîπ Indexing Strategy pour les performances
CREATE INDEX idx_payments_status_date 
ON payments(status, transaction_date) 
PARALLEL 8;

CREATE INDEX idx_customers_activity 
ON customers(last_transaction_date, total_transactions) 
COMPRESS;

-- üîπ Optimized Query avec partition pruning
SELECT /*+ PARALLEL(8) */ 
    customer_id,
    COUNT(*) as transaction_count,
    SUM(amount) as total_amount
FROM payments 
WHERE transaction_date >= TRUNC(SYSDATE) - 30
  AND status = 'PROCESSED'
  AND amount > 1000
GROUP BY customer_id
HAVING COUNT(*) > 10;

-- üîπ Materialized View pour les rapports
CREATE MATERIALIZED VIEW mv_daily_summary
REFRESH COMPLETE ON DEMAND
AS
SELECT 
    TRUNC(transaction_date) as report_date,
    COUNT(*) as total_transactions,
    SUM(amount) as total_volume,
    COUNT(DISTINCT customer_id) as unique_customers
FROM payments 
WHERE transaction_date >= TRUNC(SYSDATE) - 365
GROUP BY TRUNC(transaction_date);</code></pre>
          </div>
        </div>

        <h3>Monitoring et Tuning JDBC</h3>
        <div class="grid two">
          <div>
            <h4>Performance Metrics</h4>
            <div class="code-header">
              <span>JDBC Monitoring</span>
              <button class="copy-btn" data-clipboard-target="#jdbc-monitoring"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jdbc-monitoring"><code class="language-java">// üîπ JDBC Performance Monitoring
@Component
public class JDBCPerformanceMonitor {
    
    private final MeterRegistry meterRegistry;
    private final Timer queryTimer;
    private final Counter slowQueryCounter;
    
    public JDBCPerformanceMonitor(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        
        this.queryTimer = Timer.builder("jdbc.query.execution.time")
            .description("Temps d'ex√©cution des requ√™tes JDBC")
            .publishPercentiles(0.5, 0.95, 0.99)
            .register(meterRegistry);
            
        this.slowQueryCounter = Counter.builder("jdbc.slow.queries")
            .description("Nombre de requ√™tes lentes")
            .register(meterRegistry);
    }
    
    public <T> T monitorQuery(String queryName, Supplier<T> query) {
        return queryTimer.record(() -> {
            long startTime = System.currentTimeMillis();
            try {
                return query.get();
            } finally {
                long duration = System.currentTimeMillis() - startTime;
                if (duration > 1000) { // Seuil √† 1 seconde
                    slowQueryCounter.increment();
                    log.warn("Slow query detected: {} took {}ms", queryName, duration);
                }
            }
        });
    }
}

// üîπ AOP pour le monitoring automatique
@Aspect
@Component
public class JDBCMonitoringAspect {
    
    private final JDBCPerformanceMonitor monitor;
    
    @Around("@annotation(MonitorQuery)")
    public Object monitorQueryExecution(ProceedingJoinPoint joinPoint) throws Throwable {
        String queryName = joinPoint.getSignature().getName();
        return monitor.monitorQuery(queryName, () -> {
            try {
                return joinPoint.proceed();
            } catch (Throwable e) {
                throw new RuntimeException(e);
            }
        });
    }
}</code></pre>
          </div>
          <div>
            <h4>Performance KPIs</h4>
            <div class="kpi">
              <div class="card">
                <div class="label">Query Response Time</div>
                <div class="val">&lt; 100ms</div>
              </div>
              <div class="card">
                <div class="label">Connection Wait Time</div>
                <div class="val">&lt; 10ms</div>
              </div>
              <div class="card">
                <div class="label">Batch Throughput</div>
                <div class="val">10K ops/s</div>
              </div>
              <div class="card">
                <div class="label">Error Rate</div>
                <div class="val">&lt; 0.1%</div>
              </div>
            </div>

            <h4>Tuning Recommendations</h4>
            <ul>
              <li>‚úÖ Utiliser les Prepared Statements</li>
              <li>‚úÖ Impl√©menter le batch processing</li>
              <li>‚úÖ Configurer les indexes appropri√©s</li>
              <li>‚úÖ Monitorer les slow queries</li>
              <li>‚úÖ Utiliser le connection pooling</li>
              <li>‚úÖ Optimiser les transactions</li>
            </ul>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('jdbc-performance')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Les sections 21-23 suivent le m√™me pattern -->
      <!-- Section 21: Performance JMS -->
      <section id="jms-performance">
        <div class="section-header">
          <h2><i class="fas fa-envelope"></i>21) üì® Performance JMS</h2>
          <div class="section-tools">
            <span class="section-badge">Messaging</span>
            <div class="quick-actions">
              <a href="#jdbc-performance" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#caching-performance" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Optimisation IBM MQ BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-cog"></i></div>
            <h3>IBM MQ Configuration</h3>
            <p>Configuration haute performance pour IBM MQ avec tuning avanc√©.</p>
            <div class="code-header">
              <span>IBM MQ Performance Config</span>
              <button class="copy-btn" data-clipboard-target="#jms-config"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jms-config"><code class="language-properties"># üîπ IBM MQ Connection Factory
camel.component.ibm-mq.connection-factory=#mqConnectionFactory
camel.component.ibm-mq.connection-factory-type=com.ibm.mq.jms.MQQueueConnectionFactory
camel.component.ibm-mq.queuemanager=BNP_QMGR
camel.component.ibm-mq.channel=BNP.SVRCONN
camel.component.ibm-mq.hostname=mq-bnp-prod.example.com
camel.component.ibm-mq.port=1414

# üîπ Performance Settings
camel.component.ibm-mq.consumer-exclusive=false
camel.component.ibm-mq.transacted=true
camel.component.ibm-mq.preserve-message-queuing=true
camel.component.ibm-mq.disable-reply-to=true
camel.component.ibm-mq.include-sent-timestamp=true

# üîπ Consumer Optimization
camel.component.ibm-mq.concurrent-consumers=10
camel.component.ibm-mq.max-concurrent-consumers=50
camel.component.ibm-mq.cache-level-name=CACHE_CONSUMER
camel.component.ibm-mq.acknowledgement-mode-name=CLIENT_ACKNOWLEDGE

# üîπ Message Processing
camel.component.ibm-mq.receive-timeout=5000
camel.component.ibm-mq.idle-task-execution-limit=1
camel.component.ibm-mq.idle-consumer-limit=5
camel.component.ibm-mq.max-messages-per-task=10</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
            <h3>Message Throughput</h3>
            <p>Optimisation du d√©bit des messages avec batching et parall√©lisation.</p>
            <div class="code-header">
              <span>High Throughput Configuration</span>
              <button class="copy-btn" data-clipboard-target="#jms-throughput"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="jms-throughput"><code class="language-java">// üîπ High Throughput JMS Consumer
from("ibm-mq:queue:BNP.HIGH.VOLUME?concurrentConsumers=20&maxConcurrentConsumers=50")
  .routeId("high-volume-consumer")
  .routeDescription("High volume message processing")
  
  // üîπ Batch processing pour meilleure performance
  .aggregate(header("JMSMessageID"), new BatchAggregationStrategy())
    .completionSize(100) // Traitement par lots de 100 messages
    .completionTimeout(1000)
  .end()
  
  // üîπ Traitement parall√®le
  .split(body()).parallelProcessing()
    .threads(10, 25)
    .process(new MessageProcessor())
  .end()
  
  // üîπ Acknowledgment batch
  .process(exchange -> {
      // Acknowledgment manuel pour meilleure performance
      List<Message> messages = exchange.getIn().getBody(List.class);
      for (Message message : messages) {
          message.acknowledge();
      }
  })
  
  // üîπ Monitoring de performance
  .process(new ThroughputMonitor())
  .log("Processed batch of ${body.size} messages");</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('jms-performance')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 22: Caching & Performance -->
      <section id="caching-performance">
        <div class="section-header">
          <h2><i class="fas fa-bolt"></i>22) ‚ö° Caching & Performance</h2>
          <div class="section-tools">
            <span class="section-badge">Cache</span>
            <div class="quick-actions">
              <a href="#jms-performance" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#connection-pooling" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Strat√©gie de Caching BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-database"></i></div>
            <h3>Redis Cluster Configuration</h3>
            <p>Configuration haute performance pour Redis Cluster avec r√©plication.</p>
            <div class="code-header">
              <span>Redis Configuration</span>
              <button class="copy-btn" data-clipboard-target="#cache-redis"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="cache-redis"><code class="language-properties"># üîπ Redis Cluster Configuration
spring.redis.cluster.nodes=redis-bnp-1:6379,redis-bnp-2:6379,redis-bnp-3:6379
spring.redis.cluster.max-redirects=3
spring.redis.timeout=10000
spring.redis.lettuce.pool.max-active=20
spring.redis.lettuce.pool.max-idle=10
spring.redis.lettuce.pool.min-idle=5
spring.redis.lettuce.pool.max-wait=5000

# üîπ Cache Configuration
spring.cache.type=redis
spring.cache.redis.time-to-live=300000
spring.cache.redis.cache-null-values=false
spring.cache.redis.key-prefix=bnp:
spring.cache.redis.use-key-prefix=true

# üîπ Performance Tuning
spring.redis.lettuce.shutdown-timeout=100
spring.redis.lettuce.cluster.refresh.adaptive=true
spring.redis.lettuce.cluster.refresh.period=30000</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-memory"></i></div>
            <h3>Caffeine Cache</h3>
            <p>Cache m√©moire local pour les donn√©es fr√©quemment acc√©d√©es.</p>
            <div class="code-header">
              <span>Caffeine Configuration</span>
              <button class="copy-btn" data-clipboard-target="#cache-caffeine"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="cache-caffeine"><code class="language-java">// üîπ Caffeine Cache Configuration
@Configuration
@EnableCaching
public class CacheConfig {
    
    @Bean
    public CaffeineCacheManager cacheManager() {
        CaffeineCacheManager cacheManager = new CaffeineCacheManager();
        cacheManager.setCaffeine(caffeineCacheBuilder());
        return cacheManager;
    }
    
    Caffeine<Object, Object> caffeineCacheBuilder() {
        return Caffeine.newBuilder()
            .initialCapacity(1000)
            .maximumSize(10000)
            .expireAfterWrite(10, TimeUnit.MINUTES)
            .recordStats()
            .softValues();
    }
    
    @Bean
    public CacheManager redisCacheManager(RedisConnectionFactory factory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(30))
            .disableCachingNullValues()
            .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer()));
        
        return RedisCacheManager.builder(factory)
            .cacheDefaults(config)
            .build();
    }
}</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('caching-performance')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

      <!-- Section 23: Connection Pooling -->
      <section id="connection-pooling">
        <div class="section-header">
          <h2><i class="fas fa-plug"></i>23) üîå Connection Pooling</h2>
          <div class="section-tools">
            <span class="section-badge">Connections</span>
            <div class="quick-actions">
              <a href="#caching-performance" class="quick-action-btn">
                <i class="fas fa-arrow-up"></i> Pr√©c√©dent
              </a>
              <a href="#advanced-monitoring" class="quick-action-btn">
                <i class="fas fa-arrow-down"></i> Suivant
              </a>
            </div>
          </div>
        </div>

        <h3>Gestion des Connexions BNP</h3>
        <div class="feature-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-network-wired"></i></div>
            <h3>HikariCP Advanced</h3>
            <p>Configuration avanc√©e de HikariCP pour les environnements critiques.</p>
            <div class="code-header">
              <span>HikariCP Advanced Config</span>
              <button class="copy-btn" data-clipboard-target="#pool-advanced"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="pool-advanced"><code class="language-java">// üîπ Configuration HikariCP Avanc√©e
@Configuration
public class HikariAdvancedConfig {
    
    @Bean
    @ConfigurationProperties("spring.datasource.hikari")
    public HikariDataSource dataSource() {
        HikariConfig config = new HikariConfig();
        
        // üîπ Performance Settings
        config.setMaximumPoolSize(50);
        config.setMinimumIdle(10);
        config.setIdleTimeout(300000);
        config.setConnectionTimeout(20000);
        config.setMaxLifetime(1200000);
        
        // üîπ Health Check & Monitoring
        config.setLeakDetectionThreshold(60000);
        config.setInitializationFailTimeout(1);
        config.setConnectionTestQuery("SELECT 1 FROM DUAL");
        
        // üîπ Optimizations
        config.setPoolName("BNP-HikariPool");
        config.setRegisterMbeans(true);
        config.setAllowPoolSuspension(false);
        config.setReadOnly(false);
        
        // üîπ Oracle Specific Optimizations
        config.addDataSourceProperty("oracle.jdbc.ReadTimeout", 30000);
        config.addDataSourceProperty("oracle.net.CONNECT_TIMEOUT", 10000);
        config.addDataSourceProperty("oracle.jdbc.FreeMemoryOnEnterImplicitCache", true);
        
        return new HikariDataSource(config);
    }
    
    // üîπ Custom Connection Validator
    @Bean
    public ConnectionValidator connectionValidator() {
        return new BNPConnectionValidator();
    }
}</code></pre>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
            <h3>Pool Monitoring</h3>
            <p>Monitoring avanc√© des pools de connexions avec m√©triques d√©taill√©es.</p>
            <div class="code-header">
              <span>Pool Monitoring</span>
              <button class="copy-btn" data-clipboard-target="#pool-monitoring"><i class="fas fa-copy"></i> Copier</button>
            </div>
            <pre id="pool-monitoring"><code class="language-java">// üîπ Connection Pool Monitoring
@Component
public class ConnectionPoolMonitor {
    
    private final MeterRegistry meterRegistry;
    private final HikariDataSource dataSource;
    
    @Scheduled(fixedRate = 30000) // Toutes les 30 secondes
    public void monitorConnectionPool() {
        HikariPoolMXBean pool = dataSource.getHikariPoolMXBean();
        
        // üîπ M√©triques de base
        Gauge.builder("hikari.connections.active")
            .description("Active connections")
            .register(meterRegistry, pool::getActiveConnections);
            
        Gauge.builder("hikari.connections.idle")
            .description("Idle connections")
            .register(meterRegistry, pool::getIdleConnections);
            
        Gauge.builder("hikari.connections.total")
            .description("Total connections")
            .register(meterRegistry, pool::getTotalConnections);
            
        Gauge.builder("hikari.connections.waiting")
            .description("Threads waiting for connection")
            .register(meterRegistry, pool::getThreadsAwaitingConnection);
        
        // üîπ Alerting sur les seuils critiques
        if (pool.getActiveConnections() > 40) {
            log.warn("High connection pool usage: {} active connections", 
                    pool.getActiveConnections());
        }
        
        if (pool.getThreadsAwaitingConnection() > 10) {
            log.error("Connection pool exhausted: {} threads waiting", 
                     pool.getThreadsAwaitingConnection());
        }
    }
    
    // üîπ Health Check
    @Scheduled(fixedRate = 60000) // Toutes les minutes
    public void healthCheck() {
        try (Connection connection = dataSource.getConnection()) {
            // Test de connexion simple
            try (Statement stmt = connection.createStatement()) {
                stmt.execute("SELECT 1 FROM DUAL");
            }
        } catch (SQLException e) {
            log.error("Database health check failed", e);
        }
    }
}</code></pre>
          </div>
        </div>

        <div class="export-controls">
          <button class="export-btn" onclick="exportSection('connection-pooling')">
            <i class="fas fa-download"></i> Exporter cette section
          </button>
        </div>
      </section>

<!-- Section 24: Monitoring Avanc√© -->
<section id="advanced-monitoring">
  <div class="section-header">
    <h2><i class="fas fa-chart-line"></i>24) üìä Monitoring Avanc√©</h2>
    <div class="section-tools">
      <span class="section-badge">Monitoring</span>
      <div class="quick-actions">
        <a href="#connection-pooling" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#annex" class="quick-action-btn">
          <i class="fas fa-arrow-down"></i> Suivant
        </a>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üîç Monitoring Temps R√©el BNP</h3>
  
  <!-- DIAGRAMME Monitoring Avanc√© -->
  <div class="diagram-container">
    <div class="diagram-title" style="color: var(--accent2); font-weight: 700;">Architecture de Monitoring Avanc√© BNP</div>
    <div class="diagram-content">
      <div style="width: 100%;">
        <!-- Niveau 1: Data Collection -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; margin-bottom: 20px; background: linear-gradient(135deg, #e3f2fd, #bbdefb);">
          <div class="node-title" style="color: #1565c0; font-weight: 700;">üì° Data Collection Layer</div>
          <div class="node-content" style="color: #0d47a1;">
            <div class="component-diagram">
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-microchip"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">Application Metrics</div>
                <div style="color: #0d47a1;">Micrometer, Custom Metrics</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-server"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">Infrastructure</div>
                <div style="color: #0d47a1;">Node Exporter, cAdvisor</div>
              </div>
              <div class="component-box">
                <div class="component-icon"><i class="fas fa-network-wired"></i></div>
                <div class="component-title" style="color: #1565c0; font-weight: 600;">Business Metrics</div>
                <div style="color: #0d47a1;">KPI M√©tier, Transactions</div>
              </div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 2: Processing -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
          <div class="architecture-node" style="background: linear-gradient(135deg, #e8f5e8, #c8e6c9);">
            <div class="node-title" style="color: #1b5e20; font-weight: 700;">‚ö° Stream Processing</div>
            <div class="node-content" style="color: #2e7d32;">
              <div><strong>Real-time Analytics</strong></div>
              <div>‚Ä¢ Kafka Streams</div>
              <div>‚Ä¢ Flink Processing</div>
              <div>‚Ä¢ Complex Event Processing</div>
              <div>‚Ä¢ Anomaly Detection</div>
              <div>‚Ä¢ Pattern Recognition</div>
            </div>
          </div>

          <div class="architecture-node" style="background: linear-gradient(135deg, #fff3e0, #ffe0b2);">
            <div class="node-title" style="color: #e65100; font-weight: 700;">üß† AI/ML Monitoring</div>
            <div class="node-content" style="color: #ef6c00;">
              <div><strong>Predictive Analytics</strong></div>
              <div>‚Ä¢ ML Anomaly Detection</div>
              <div>‚Ä¢ Predictive Scaling</div>
              <div>‚Ä¢ Pattern Forecasting</div>
              <div>‚Ä¢ Auto-remediation</div>
              <div>‚Ä¢ Smart Alerting</div>
            </div>
          </div>
        </div>

        <div class="flow-arrow" style="color: var(--accent);">‚Üì</div>

        <!-- Niveau 3: Visualization -->
        <div class="architecture-node" style="grid-column: 1 / -1; text-align: center; background: linear-gradient(135deg, #f3e5f5, #e1bee7);">
          <div class="node-title" style="color: #4a148c; font-weight: 700;">üé® Advanced Visualization</div>
          <div class="node-content" style="color: #7b1fa2;">
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
              <div>
                <strong style="color: #4a148c;">Real-time Dashboards</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Grafana Enterprise</div>
                  <div>‚Ä¢ Custom Widgets</div>
                  <div>‚Ä¢ SLA Monitoring</div>
                  <div>‚Ä¢ Business KPIs</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">Alerting & AIOps</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ PagerDuty Integration</div>
                  <div>‚Ä¢ ML-based Correlation</div>
                  <div>‚Ä¢ Auto-remediation</div>
                  <div>‚Ä¢ Incident Management</div>
                </div>
              </div>
              <div>
                <strong style="color: #4a148c;">Reporting</strong>
                <div style="text-align: left; margin-top: 10px;">
                  <div>‚Ä¢ Automated Reports</div>
                  <div>‚Ä¢ Compliance Reporting</div>
                  <div>‚Ä¢ Performance Trends</div>
                  <div>‚Ä¢ Capacity Planning</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìà M√©triques Avanc√©es Camel</h3>
  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Custom Metrics Configuration</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Advanced Metrics Config</span>
        <button class="copy-btn" data-clipboard-target="#monitoring-metrics"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="monitoring-metrics"><code class="language-java">// üîπ Custom Metrics Configuration BNP
@Component
public class BNPAdvancedMetrics {
    
    private final MeterRegistry meterRegistry;
    private final Counter businessTransactionCounter;
    private final Timer paymentProcessingTimer;
    private final Gauge queueBacklogGauge;
    private final DistributionSummary messageSizeSummary;
    
    public BNPAdvancedMetrics(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        
        // üîπ Business Transaction Counter
        this.businessTransactionCounter = Counter.builder("bnp.business.transactions")
            .description("Nombre de transactions m√©tier trait√©es")
            .tag("environment", "production")
            .tag("division", "global-markets")
            .register(meterRegistry);
            
        // üîπ Payment Processing Timer
        this.paymentProcessingTimer = Timer.builder("bnp.payment.processing.time")
            .description("Temps de traitement des paiements")
            .publishPercentiles(0.5, 0.75, 0.95, 0.99)
            .publishPercentileHistogram(true)
            .register(meterRegistry);
            
        // üîπ Queue Backlog Gauge
        this.queueBacklogGauge = Gauge.builder("bnp.queue.backlog")
            .description("Taille de la file d'attente des messages")
            .register(meterRegistry, this, BNPAdvancedMetrics::getQueueBacklog);
            
        // üîπ Message Size Distribution
        this.messageSizeSummary = DistributionSummary.builder("bnp.message.size")
            .description("Taille des messages trait√©s")
            .baseUnit("bytes")
            .publishPercentiles(0.5, 0.95)
            .register(meterRegistry);
    }
    
    public void recordBusinessTransaction(String transactionType, String status) {
        businessTransactionCounter.increment(Tags.of(
            "transaction_type", transactionType,
            "status", status
        ));
    }
    
    public Timer.Sample startPaymentProcessing() {
        return Timer.start(meterRegistry);
    }
    
    public void endPaymentProcessing(Timer.Sample sample, String paymentType) {
        sample.stop(paymentProcessingTimer.tags(
            "payment_type", paymentType
        ));
    }
    
    public void recordMessageSize(long size) {
        messageSizeSummary.record(size);
    }
    
    private double getQueueBacklog() {
        // Logique pour r√©cup√©rer la taille de la queue
        return getCurrentQueueSize();
    }
}

// üîπ Custom Route Policy pour m√©triques avanc√©es
@Component
public class BNPMonitoringRoutePolicy implements RoutePolicy {
    
    private final BNPAdvancedMetrics metrics;
    private final Map&lt;String, Timer.Sample&gt; routeTimers = new ConcurrentHashMap&lt;&gt;();
    
    @Override
    public void onStart(Route route) {
        Timer.Sample sample = Timer.start(metrics.getMeterRegistry());
        routeTimers.put(route.getRouteId(), sample);
        
        // M√©trique de d√©marrage de route
        metrics.recordBusinessTransaction("route_start", route.getRouteId());
    }
    
    @Override
    public void onStop(Route route) {
        Timer.Sample sample = routeTimers.remove(route.getRouteId());
        if (sample != null) {
            sample.stop(metrics.getMeterRegistry().timer("bnp.route.execution.time",
                "route_id", route.getRouteId()
            ));
        }
    }
    
    @Override
    public void onExchangeBegin(Route route, Exchange exchange) {
        // Monitoring des exchanges
        String messageId = exchange.getIn().getMessageId();
        metrics.recordBusinessTransaction("exchange_begin", messageId);
    }
    
    @Override
    public void onExchangeDone(Route route, Exchange exchange) {
        String messageId = exchange.getIn().getMessageId();
        String status = exchange.isFailed() ? "failed" : "success";
        metrics.recordBusinessTransaction("exchange_done", status);
    }
}</code></pre>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Business KPIs Monitoring</h4>
      <div class="kpi">
        <div class="card">
          <div class="label" style="color: var(--muted);">Transactions/Min</div>
          <div class="val" style="color: var(--good);">1,250</div>
        </div>
        <div class="card">
          <div class="label" style="color: var(--muted);">Error Rate</div>
          <div class="val" style="color: var(--good);">0.02%</div>
        </div>
        <div class="card">
          <div class="label" style="color: var(--muted);">Avg Response Time</div>
          <div class="val" style="color: var(--good);">45ms</div>
        </div>
        <div class="card">
          <div class="label" style="color: var(--muted);">System Health</div>
          <div class="val" style="color: var(--good);">99.98%</div>
        </div>
      </div>

      <h4 style="color: var(--accent2);">Alertes Intelligentes</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Anomaly Detection</strong> : D√©tection automatique des comportements anormaux</li>
        <li><strong style="color: var(--accent);">Predictive Alerting</strong> : Alertes bas√©es sur les tendances</li>
        <li><strong style="color: var(--accent);">Correlation Engine</strong> : Corr√©lation automatique des incidents</li>
        <li><strong style="color: var(--accent);">Auto-remediation</strong> : Actions correctives automatiques</li>
        <li><strong style="color: var(--accent);">SLA Monitoring</strong> : Surveillance des contrats de service</li>
      </ul>
    </div>
  </div>

  <h3 style="color: var(--accent2);">ü§ñ AIOps & Predictive Monitoring</h3>
  <div class="feature-grid">
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-brain"></i></div>
      <h3 style="color: var(--accent2);">Machine Learning Monitoring</h3>
      <p style="color: var(--ink);">Int√©gration de mod√®les ML pour la d√©tection d'anomalies et le monitoring pr√©dictif.</p>
      <div class="code-header">
        <span style="color: var(--muted);">ML Anomaly Detection</span>
        <button class="copy-btn" data-clipboard-target="#monitoring-ml"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="monitoring-ml"><code class="language-java">// üîπ ML Anomaly Detection Service
@Component
public class BNPMLAnomalyDetection {
    
    private final AnomalyDetector anomalyDetector;
    private final MetricCollector metricCollector;
    
    @Scheduled(fixedRate = 30000) // Toutes les 30 secondes
    public void analyzeMetrics() {
        // Collecte des m√©triques r√©centes
        List&lt;MetricData&gt; recentMetrics = metricCollector.getRecentMetrics(300); // 5 minutes
        
        // D√©tection d'anomalies
        AnomalyDetectionResult result = anomalyDetector.detectAnomalies(recentMetrics);
        
        if (result.hasAnomalies()) {
            handleAnomalies(result.getAnomalies());
        }
        
        // Pr√©diction des tendances
        PredictionResult prediction = anomalyDetector.predictTrends(recentMetrics);
        handlePredictions(prediction);
    }
    
    private void handleAnomalies(List&lt;Anomaly&gt; anomalies) {
        for (Anomaly anomaly : anomalies) {
            switch (anomaly.getSeverity()) {
                case CRITICAL:
                    triggerCriticalAlert(anomaly);
                    break;
                case HIGH:
                    triggerHighAlert(anomaly);
                    break;
                case MEDIUM:
                    triggerMediumAlert(anomaly);
                    break;
            }
        }
    }
    
    private void handlePredictions(PredictionResult prediction) {
        if (prediction.requiresScaling()) {
            triggerAutoScaling(prediction.getRecommendedAction());
        }
        
        if (prediction.indicatesPotentialIssue()) {
            triggerPreventiveAction(prediction);
        }
    }
}

// üîπ Custom Anomaly Detector
@Component
public class BNPAnomalyDetector implements AnomalyDetector {
    
    private final MLModel mlModel;
    private final HistoricalDataRepository historicalData;
    
    @Override
    public AnomalyDetectionResult detectAnomalies(List&lt;MetricData&gt; metrics) {
        // Pr√©paration des features pour le mod√®le ML
        double[] features = prepareFeatures(metrics);
        
        // Pr√©diction avec le mod√®le ML
        double anomalyScore = mlModel.predict(features);
        
        // D√©tection bas√©e sur le score
        if (anomalyScore > 0.9) {
            return new AnomalyDetectionResult(
                List.of(new CriticalAnomaly("High anomaly score: " + anomalyScore)),
                anomalyScore
            );
        } else if (anomalyScore > 0.7) {
            return new AnomalyDetectionResult(
                List.of(new HighAnomaly("Medium anomaly score: " + anomalyScore)),
                anomalyScore
            );
        }
        
        return new AnomalyDetectionResult(List.of(), anomalyScore);
    }
    
    @Override
    public PredictionResult predictTrends(List&lt;MetricData&gt; metrics) {
        // Analyse des tendances avec s√©ries temporelles
        TimeSeriesAnalysis analysis = analyzeTimeSeries(metrics);
        
        return new PredictionResult(
            analysis.getTrend(),
            analysis.getPredictedValues(),
            analysis.getConfidence()
        );
    }
}</code></pre>
    </div>
    
    <div class="feature-card">
      <div class="feature-icon" style="color: var(--accent);"><i class="fas fa-robot"></i></div>
      <h3 style="color: var(--accent2);">Auto-remediation System</h3>
      <p style="color: var(--ink);">Syst√®me de remediation automatique pour les incidents d√©tect√©s.</p>
      <div class="code-header">
        <span style="color: var(--muted);">Auto-Remediation Engine</span>
        <button class="copy-btn" data-clipboard-target="#monitoring-autoremediation"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="monitoring-autoremediation"><code class="language-java">// üîπ Auto-Remediation Engine BNP
@Component
public class BNPAutoRemediationEngine {
    
    private final Map&lt;String, RemediationStrategy&gt; remediationStrategies;
    private final IncidentRepository incidentRepository;
    
    @EventListener
    public void handleAnomaly(AnomalyDetectedEvent event) {
        Anomaly anomaly = event.getAnomaly();
        
        // S√©lection de la strat√©gie de remediation
        RemediationStrategy strategy = remediationStrategies.get(anomaly.getType());
        
        if (strategy != null && strategy.shouldAutoRemediate(anomaly)) {
            try {
                RemediationResult result = strategy.executeRemediation(anomaly);
                
                if (result.isSuccess()) {
                    log.info("Auto-remediation successful for anomaly: {}", anomaly.getId());
                    createRemediationRecord(anomaly, result);
                } else {
                    log.warn("Auto-remediation failed for anomaly: {}", anomaly.getId());
                    escalateToHuman(anomaly, result.getError());
                }
            } catch (Exception e) {
                log.error("Auto-remediation error for anomaly: {}", anomaly.getId(), e);
                escalateToHuman(anomaly, e.getMessage());
            }
        } else {
            // Escalation manuelle
            escalateToHuman(anomaly, "No auto-remediation strategy available");
        }
    }
    
    // üîπ Strat√©gies de remediation sp√©cifiques
    @Component
    public class HighCPURemediation implements RemediationStrategy {
        
        @Override
        public boolean shouldAutoRemediate(Anomaly anomaly) {
            return anomaly.getMetricType().equals("cpu_usage") 
                && anomaly.getSeverity() == Severity.HIGH
                && anomaly.getValue() > 90.0;
        }
        
        @Override
        public RemediationResult executeRemediation(Anomaly anomaly) {
            // Scale up des pods
            k8sClient.scaleDeployment(
                anomaly.getServiceName(),
                getRecommendedReplicaCount(anomaly)
            );
            
            return RemediationResult.success("Scaled up deployment");
        }
    }
    
    @Component
    public class MemoryLeakRemediation implements RemediationStrategy {
        
        @Override
        public boolean shouldAutoRemediate(Anomaly anomaly) {
            return anomaly.getMetricType().equals("memory_usage") 
                && anomaly.getTrend() == Trend.INCREASING
                && anomaly.getDuration() > 300; // 5 minutes
        }
        
        @Override
        public RemediationResult executeRemediation(Anomaly anomaly) {
            // Restart du pod probl√©matique
            k8sClient.restartPod(anomaly.getPodName());
            
            return RemediationResult.success("Restarted pod with memory leak");
        }
    }
}</code></pre>
    </div>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('advanced-monitoring')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
    <button class="export-btn" onclick="shareSection('advanced-monitoring')">
      <i class="fas fa-share"></i> Partager
    </button>
  </div>
</section>

<!-- Section Annexe -->
<section id="annex">
  <div class="section-header">
    <h2><i class="fas fa-book"></i>Annexe A) üìö R√©f√©rences Techniques (EN)</h2>
    <div class="section-tools">
      <span class="section-badge">Reference</span>
      <div class="quick-actions">
        <a href="#advanced-monitoring" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Pr√©c√©dent
        </a>
        <a href="#intro" class="quick-action-btn">
          <i class="fas fa-arrow-up"></i> Retour au d√©but
        </a>
      </div>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìñ Technical References & Best Practices</h3>

  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">Apache Camel References</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Camel 4.15 Documentation</strong>: https://camel.apache.org/releases/4.15.0/</li>
        <li><strong style="color: var(--accent);">Enterprise Integration Patterns</strong>: https://www.enterpriseintegrationpatterns.com/</li>
        <li><strong style="color: var(--accent);">Spring Boot Camel Starter</strong>: https://spring.io/projects/spring-boot</li>
        <li><strong style="color: var(--accent);">Camel Performance Tuning</strong>: https://camel.apache.org/manual/performance.html</li>
        <li><strong style="color: var(--accent);">Camel Security</strong>: https://camel.apache.org/manual/security.html</li>
      </ul>

      <h4 style="color: var(--accent2);">Spring Framework</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Spring Boot 3.3 Documentation</strong>: https://spring.io/projects/spring-boot</li>
        <li><strong style="color: var(--accent);">Spring Security</strong>: https://spring.io/projects/spring-security</li>
        <li><strong style="color: var(--accent);">Spring Data</strong>: https://spring.io/projects/spring-data</li>
        <li><strong style="color: var(--accent);">Spring Cloud</strong>: https://spring.io/projects/spring-cloud</li>
      </ul>
    </div>
    <div>
      <h4 style="color: var(--accent2);">Performance & Monitoring</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Micrometer Metrics</strong>: https://micrometer.io/</li>
        <li><strong style="color: var(--accent);">Prometheus</strong>: https://prometheus.io/</li>
        <li><strong style="color: var(--accent);">Grafana</strong>: https://grafana.com/</li>
        <li><strong style="color: var(--accent);">Jaeger Tracing</strong>: https://www.jaegertracing.io/</li>
        <li><strong style="color: var(--accent);">OpenTelemetry</strong>: https://opentelemetry.io/</li>
      </ul>

      <h4 style="color: var(--accent2);">Cloud Native</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Kubernetes</strong>: https://kubernetes.io/</li>
        <li><strong style="color: var(--accent);">Docker</strong>: https://www.docker.com/</li>
        <li><strong style="color: var(--accent);">Istio</strong>: https://istio.io/</li>
        <li><strong style="color: var(--accent);">Helm</strong>: https://helm.sh/</li>
      </ul>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üîß Configuration Templates</h3>

  <div class="feature-grid">
    <div class="feature-card">
      <h4 style="color: var(--accent2);">Maven Dependencies</h4>
      <div class="code-header">
        <span style="color: var(--muted);">pom.xml</span>
        <button class="copy-btn" data-clipboard-target="#maven-deps"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="maven-deps"><code class="language-xml">&lt;!-- Camel BNP Dependencies --&gt;
&lt;dependencies&gt;
    &lt;!-- Spring Boot Starter --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    
    &lt;!-- Apache Camel --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;
        &lt;artifactId&gt;camel-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;4.15.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- Camel Components --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;
        &lt;artifactId&gt;camel-ibmmq-starter&lt;/artifactId&gt;
        &lt;version&gt;4.15.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;
        &lt;artifactId&gt;camel-jdbc-starter&lt;/artifactId&gt;
        &lt;version&gt;4.15.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- Monitoring --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
        &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;
    &lt;/dependency&gt;
    
    &lt;dependency&gt;
        &lt;groupId&gt;io.opentelemetry&lt;/groupId&gt;
        &lt;artifactId&gt;opentelemetry-api&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
    </div>
    
    <div class="feature-card">
      <h4 style="color: var(--accent2);">Dockerfile Template</h4>
      <div class="code-header">
        <span style="color: var(--muted);">Dockerfile</span>
        <button class="copy-btn" data-clipboard-target="#dockerfile"><i class="fas fa-copy"></i> Copier</button>
      </div>
      <pre id="dockerfile"><code class="language-dockerfile"># BNP Camel Application Dockerfile
FROM eclipse-temurin:21-jre-jammy

# Security: Run as non-root user
RUN groupadd -r bnpuser && useradd -r -g bnpuser bnpuser

# Install required packages
RUN apt-get update && apt-get install -y \
    curl \
    tzdata \
    && rm -rf /var/lib/apt/lists/*

# Set timezone
ENV TZ=Europe/Paris

# Create application directory
RUN mkdir -p /app && chown bnpuser:bnpuser /app
WORKDIR /app

# Copy JAR file
COPY target/camel-bnp-application.jar app.jar

# Create logs directory
RUN mkdir -p /logs && chown bnpuser:bnpuser /logs

# Security: Switch to non-root user
USER bnpuser

# Expose ports
EXPOSE 8080 9779

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/actuator/health || exit 1

# JVM options for production
ENV JAVA_OPTS="-XX:+UseZGC -Xmx2g -Xms2g -Dspring.profiles.active=production"

# Run application
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]</code></pre>
    </div>
  </div>

  <h3 style="color: var(--accent2);">üìä Performance Benchmarks</h3>

  <table class="strategy-table">
    <thead>
      <tr>
        <th style="color: var(--accent2);">Scenario</th>
        <th style="color: var(--accent2);">Throughput</th>
        <th style="color: var(--accent2);">Latency (p95)</th>
        <th style="color: var(--accent2);">Memory Usage</th>
        <th style="color: var(--accent2);">CPU Usage</th>
        <th style="color: var(--accent2);">Environment</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>SWIFT Processing</strong></td>
        <td style="color: var(--good);">1,200 msg/s</td>
        <td style="color: var(--good);">45ms</td>
        <td style="color: var(--good);">4.2 GB</td>
        <td style="color: var(--good);">65%</td>
        <td style="color: var(--ink);">Production K8s</td>
      </tr>
      <tr>
        <td><strong>SEPA Batch</strong></td>
        <td style="color: var(--good);">800 tx/s</td>
        <td style="color: var(--good);">380ms</td>
        <td style="color: var(--good);">3.1 GB</td>
        <td style="color: var(--good);">45%</td>
        <td style="color: var(--ink);">Production K8s</td>
      </tr>
      <tr>
        <td><strong>Core Banking</strong></td>
        <td style="color: var(--good);">500 ops/s</td>
        <td style="color: var(--good);">120ms</td>
        <td style="color: var(--good);">5.8 GB</td>
        <td style="color: var(--good);">70%</td>
        <td style="color: var(--ink);">Production K8s</td>
      </tr>
    </tbody>
  </table>

  <h3 style="color: var(--accent2);">üîó Useful Links & Resources</h3>

  <div class="grid two">
    <div>
      <h4 style="color: var(--accent2);">BNP Paribas Internal</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Architecture Guidelines</strong>: https://architecture.bnpparibas.com</li>
        <li><strong style="color: var(--accent);">Security Policies</strong>: https://security.bnpparibas.com</li>
        <li><strong style="color: var(--accent);">CI/CD Pipeline</strong>: https://jenkins.bnpparibas.com</li>
        <li><strong style="color: var(--accent);">Container Registry</strong>: https://registry.bnpparibas.com</li>
        <li><strong style="color: var(--accent);">Monitoring Dashboard</strong>: https://grafana.bnpparibas.com</li>
      </ul>
    </div>
    <div>
      <h4 style="color: var(--accent2);">External Resources</h4>
      <ul style="color: var(--ink);">
        <li><strong style="color: var(--accent);">Oracle Database</strong>: https://www.oracle.com/database/</li>
        <li><strong style="color: var(--accent);">IBM MQ</strong>: https://www.ibm.com/products/mq</li>
        <li><strong style="color: var(--accent);">Redis</strong>: https://redis.io/</li>
        <li><strong style="color: var(--accent);">Kafka</strong>: https://kafka.apache.org/</li>
        <li><strong style="color: var(--accent);">GitHub BNP</strong>: https://github.com/bnpparibas</li>
      </ul>
    </div>
  </div>

  <div class="tip-box">
    <strong>üìù Note:</strong> This document is continuously updated. For the latest version, please check the internal BNP Paribas documentation repository. Last updated: <span id="annex-last-updated"></span>
  </div>

  <div class="export-controls">
    <button class="export-btn" onclick="exportSection('annex')">
      <i class="fas fa-download"></i> Exporter cette section
    </button>
    <button class="export-btn" onclick="printSection('annex')">
      <i class="fas fa-print"></i> Imprimer
    </button>
  </div>
</section>

<script>
    // Mettre √† jour la date dans l'annexe
    document.getElementById('annex-last-updated').textContent = new Date().toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
</script>
    </main>

    <footer>
      <div class="grid three">
        <div>
          <h4>BNP Paribas - Digital Factory</h4>
          <p>¬© 2024 - Document confidentiel</p>
        </div>
        <div>
          <h4>Technologies</h4>
          <p>Apache Camel 4.15 ‚Ä¢ Spring Boot 3.3 ‚Ä¢ Cloud BNP</p>
        </div>
        <div>
          <h4>Performance</h4>
          <p>High Performance Banking ‚Ä¢ 99.99% Availability</p>
        </div>
      </div>
      <p style="margin-top: 20px; font-size: 12px; opacity: 0.8;">
        <i class="fas fa-shield-alt"></i> Ce document contient des informations confidentielles de BNP Paribas
      </p>
    </footer>
  </div>

  <script>
    // Fonctions pour la gestion des checklists
    function checkAllChecklists() {
      document.querySelectorAll('.checklist-item input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = true;
      });
      showNotification('Toutes les checklists coch√©es', 'success');
    }
    
    function uncheckAllChecklists() {
      document.querySelectorAll('.checklist-item input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = false;
      });
      showNotification('Toutes les checklists d√©coch√©es', 'info');
    }

    // Initialisation du document
    document.addEventListener('DOMContentLoaded', function() {
      initializeDocument();
    });

    function initializeDocument() {
      // Date de mise √† jour
      document.getElementById('last-updated').textContent = new Date().toLocaleDateString('fr-FR', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
      
      // Initialisation du th√®me
      initializeTheme();
      
      // Initialisation de la navigation
      initializeNavigation();
      
      // Initialisation des fonctionnalit√©s de copie
      initializeCopyButtons();
      
      // Initialisation de la recherche
      initializeSearch();
      
      // Animation d'entr√©e
      animateEntrance();
    }

    // Gestion du th√®me dark/light
    function initializeTheme() {
      const themeToggle = document.getElementById('themeToggle');
      const icon = themeToggle.querySelector('i');
      
      // V√©rifier le th√®me sauvegard√© ou la pr√©f√©rence syst√®me
      const savedTheme = localStorage.getItem('bnp-theme');
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      if (savedTheme === 'light' || (!savedTheme && !systemPrefersDark)) {
        document.body.classList.add('light-mode');
        icon.className = 'fas fa-sun';
      } else {
        document.body.classList.remove('light-mode');
        icon.className = 'fas fa-moon';
      }
      
      // Gestion du clic sur le bouton
      themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('light-mode');
        
        if (document.body.classList.contains('light-mode')) {
          icon.className = 'fas fa-sun';
          localStorage.setItem('bnp-theme', 'light');
        } else {
          icon.className = 'fas fa-moon';
          localStorage.setItem('bnp-theme', 'dark');
        }
      });
    }

    // Navigation et progression
    function initializeNavigation() {
      const sections = document.querySelectorAll('.content section');
      const navLinks = document.querySelectorAll('.sidebar nav a');
      const navProgress = document.getElementById('navProgress');
      const progressBar = document.getElementById('progressBar');
      const navProgressText = document.getElementById('navProgressText');
      
      let currentSection = '';
      
      function updateNavigation() {
        let maxSection = '';
        let maxOffset = -Infinity;
        
        sections.forEach(section => {
          const rect = section.getBoundingClientRect();
          const offset = rect.top - window.innerHeight / 3;
          
          if (offset < 0 && offset > maxOffset) {
            maxOffset = offset;
            maxSection = section.id;
          }
        });
        
        if (maxSection && maxSection !== currentSection) {
          currentSection = maxSection;
          
          // Mise √† jour des liens de navigation
          navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${maxSection}`) {
              link.classList.add('active');
              
              // Animation de la barre de progression de la navigation
              const linkRect = link.getBoundingClientRect();
              const navRect = link.parentElement.getBoundingClientRect();
              const progress = ((linkRect.top - navRect.top) / navRect.height) * 100;
              navProgress.style.height = '4px';
              navProgress.style.top = `${progress}%`;
            }
          });
        }
        
        // Barre de progression globale
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrollProgress = (scrollTop / scrollHeight) * 100;
        
        progressBar.style.width = `${scrollProgress}%`;
        navProgressText.textContent = `${Math.round(scrollProgress)}%`;
      }
      
      // √âcouteurs d'√©v√©nements
      window.addEventListener('scroll', updateNavigation);
      window.addEventListener('resize', updateNavigation);
      
      // Initialisation
      updateNavigation();
    }

    // Fonctionnalit√© de copie
    function initializeCopyButtons() {
      const copyButtons = document.querySelectorAll('.copy-btn');
      
      copyButtons.forEach(button => {
        button.addEventListener('click', function() {
          const targetId = this.getAttribute('data-clipboard-target');
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            const textToCopy = targetElement.textContent || targetElement.innerText;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
              // Animation de feedback
              const originalText = this.innerHTML;
              this.innerHTML = '<i class="fas fa-check"></i> Copi√©!';
              this.style.background = 'var(--good)';
              
              setTimeout(() => {
                this.innerHTML = originalText;
                this.style.background = '';
              }, 2000);
              
              showNotification('Code copi√© dans le presse-papier', 'success');
            }).catch(err => {
              console.error('Erreur de copie:', err);
              showNotification('Erreur lors de la copie', 'error');
            });
          }
        });
      });
    }

    // Fonctionnalit√© de recherche
    function initializeSearch() {
      const searchInput = document.getElementById('navSearch');
      const navLinks = document.querySelectorAll('.sidebar nav a');
      
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        navLinks.forEach(link => {
          const text = link.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            link.style.display = 'flex';
          } else {
            link.style.display = 'none';
          }
        });
      });
    }

    // Animations d'entr√©e
    function animateEntrance() {
      const sections = document.querySelectorAll('.content section');
      
      sections.forEach((section, index) => {
        section.style.opacity = '0';
        section.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
          section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
          section.style.opacity = '1';
          section.style.transform = 'translateY(0)';
        }, index * 100);
      });
    }

    // Notifications
    function showNotification(message, type = 'info') {
      // Cr√©er l'√©l√©ment de notification
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.innerHTML = `
        <i class="fas fa-${getNotificationIcon(type)}"></i>
        <span>${message}</span>
        <button onclick="this.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
      `;
      
      // Styles pour les notifications
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${getNotificationColor(type)};
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        display: flex;
        align-items: center;
        gap: 10px;
        z-index: 10000;
        max-width: 400px;
        animation: slideInRight 0.3s ease;
      `;
      
      document.body.appendChild(notification);
      
      // Suppression automatique apr√®s 5 secondes
      setTimeout(() => {
        if (notification.parentElement) {
          notification.style.animation = 'slideOutRight 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }
      }, 5000);
    }
    
    function getNotificationIcon(type) {
      const icons = {
        'success': 'check-circle',
        'error': 'exclamation-circle',
        'warning': 'exclamation-triangle',
        'info': 'info-circle'
      };
      return icons[type] || 'info-circle';
    }
    
    function getNotificationColor(type) {
      const colors = {
        'success': 'var(--good)',
        'error': 'var(--bad)',
        'warning': 'var(--warn)',
        'info': 'var(--accent)'
      };
      return colors[type] || 'var(--accent)';
    }

    // Export de sections
    function exportSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        // Simuler l'export (dans une vraie impl√©mentation, on g√©n√©rerait un PDF)
        showNotification(`Section "${section.querySelector('h2').textContent}" export√©e`, 'success');
      }
    }
    
    function shareSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        // Simuler le partage
        showNotification(`Section "${section.querySelector('h2').textContent}" partag√©e`, 'info');
      }
    }
    
    function printSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        // Simuler l'impression
        showNotification(`Section "${section.querySelector('h2').textContent}" imprim√©e`, 'info');
      }
    }

    // Ajouter les animations CSS pour les notifications
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      @keyframes slideOutRight {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }
      
      .notification button {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        padding: 5px;
        border-radius: 3px;
        transition: background 0.2s ease;
      }
      
      .notification button:hover {
        background: rgba(255,255,255,0.2);
      }
    `;
    document.head.appendChild(style);
</script>
</body>
</html>